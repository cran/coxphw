<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Daniela Dunkler" />

<meta name="date" content="2017-01-02" />

<title>R code for Weighted Cox Regression using the R package coxphw</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">R code for ‘Weighted Cox Regression using the R package coxphw’</h1>
<h4 class="author"><em>Daniela Dunkler</em></h4>
<h4 class="date"><em>2017-01-02</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This is the R example code from ‘Weighted Cox Regression Using the R Package <strong>coxphw</strong>’ by Dunkler et. al (2015). It works with R &gt;=3.2.2 and <strong>coxphw</strong> package 4.0.0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##########################################################################################
### R code for 
### 'Weighted Cox Regression using the R package coxphw'
### written by Daniela Dunkler, Dec. 2015
##########################################################################################

### This R example code works with R &gt;=3.2.2 and coxphw-package 4.0.1.

### load R packages
<span class="kw">library</span>(<span class="st">&quot;coxphw&quot;</span>)</code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;survival&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;splines&quot;</span>)                              <span class="co"># for splines::ns used in plotzph</span>

pdfind &lt;-<span class="st"> </span><span class="ot">FALSE</span>                                 <span class="co"># indicator if plots should be saved as pdf</span>

##########################################################################################
### additional function for nice plots of scaled Schoenfeld residuals versus time
##########################################################################################

plotcoxzph &lt;-<span class="st"> </span>function(x, <span class="dt">resid =</span> <span class="ot">TRUE</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">df =</span> <span class="dv">4</span>, <span class="dt">nsmo =</span> <span class="dv">40</span>, var, <span class="dt">wd =</span> <span class="dv">1</span>, 
                       <span class="dt">limits =</span> <span class="ot">NULL</span>, ...) 
{
  <span class="co"># plot.cox.zph function from survival package 2.37-4 slightly adapted</span>
  
  xx &lt;-<span class="st"> </span>x$x
  yy &lt;-<span class="st"> </span>x$y
  d &lt;-<span class="st"> </span><span class="kw">nrow</span>(yy)
  df &lt;-<span class="st"> </span><span class="kw">max</span>(df)     
  nvar &lt;-<span class="st"> </span><span class="kw">ncol</span>(yy)
  pred.x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(xx), <span class="dt">to =</span> <span class="kw">max</span>(xx), <span class="dt">length =</span> nsmo)
  temp &lt;-<span class="st"> </span><span class="kw">c</span>(pred.x, xx)
  lmat &lt;-<span class="st"> </span><span class="kw">ns</span>(temp, <span class="dt">df =</span> df, <span class="dt">intercept =</span> <span class="ot">TRUE</span>)
  pmat &lt;-<span class="st"> </span>lmat[<span class="dv">1</span>:nsmo, ]  
  xmat &lt;-<span class="st"> </span>lmat[-(<span class="dv">1</span>:nsmo), ]
  qmat &lt;-<span class="st"> </span><span class="kw">qr</span>(xmat)
  if (qmat$rank &lt;<span class="st"> </span>df) 
    <span class="kw">stop</span>(<span class="st">&quot;Spline fit is singular, try a smaller degrees of freedom&quot;</span>)
  
  if (se) {
    bk &lt;-<span class="st"> </span><span class="kw">backsolve</span>(qmat$qr[<span class="dv">1</span>:df, <span class="dv">1</span>:df], <span class="kw">diag</span>(df))
    xtx &lt;-<span class="st"> </span>bk %*%<span class="st"> </span><span class="kw">t</span>(bk)
    seval &lt;-<span class="st"> </span>d*((pmat%*%<span class="st"> </span>xtx) *pmat) %*%<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, df)
  }
  
  ylab &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Beta(t) for&quot;</span>, <span class="kw">dimnames</span>(yy)[[<span class="dv">2</span>]])
  if (<span class="kw">missing</span>(var)) var &lt;-<span class="st"> </span><span class="dv">1</span>:nvar
  else {
    if (<span class="kw">is.character</span>(var)) var &lt;-<span class="st"> </span><span class="kw">match</span>(var, <span class="kw">dimnames</span>(yy)[[<span class="dv">2</span>]])
    if  (<span class="kw">any</span>(<span class="kw">is.na</span>(var)) ||<span class="st"> </span><span class="kw">max</span>(var)&gt;nvar ||<span class="st"> </span><span class="kw">min</span>(var) &lt;<span class="dv">1</span>)
      <span class="kw">stop</span>(<span class="st">&quot;Invalid variable requested&quot;</span>)
  }
  
  if (x$transform ==<span class="st"> 'log'</span>) {
    xx &lt;-<span class="st"> </span><span class="kw">exp</span>(xx)
    pred.x &lt;-<span class="st"> </span><span class="kw">exp</span>(pred.x)
  }
  else if (x$transform !=<span class="st"> 'identity'</span>) {
    xtime &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">dimnames</span>(yy)[[<span class="dv">1</span>]])
    indx &lt;-<span class="st"> </span>!<span class="kw">duplicated</span>(xx)                           
    apr1  &lt;-<span class="st"> </span><span class="kw">approx</span>(xx[indx], xtime[indx], 
                    <span class="kw">seq</span>(<span class="kw">min</span>(xx), <span class="kw">max</span>(xx), <span class="dt">length =</span> <span class="dv">17</span>)[<span class="dv">2</span>*(<span class="dv">1</span>:<span class="dv">8</span>)])
    temp &lt;-<span class="st"> </span><span class="kw">signif</span>(apr1$y, <span class="dv">2</span>)
    apr2  &lt;-<span class="st"> </span><span class="kw">approx</span>(xtime[indx], xx[indx], temp)
    xaxisval &lt;-<span class="st"> </span>apr2$y
    xaxislab &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">8</span>)
    for (i in <span class="dv">1</span>:<span class="dv">8</span>) xaxislab[i] &lt;-<span class="st"> </span><span class="kw">format</span>(temp[i])
  }
  
  for (i in var) {
    y &lt;-<span class="st"> </span>yy[,i]
    yhat &lt;-<span class="st"> </span>pmat %*%<span class="st"> </span><span class="kw">qr.coef</span>(qmat, y)
    if (resid) yr &lt;-<span class="kw">range</span>(yhat, y)
    else       yr &lt;-<span class="kw">range</span>(yhat)
    if (se) {
      temp &lt;-<span class="st"> </span><span class="dv">2</span>*<span class="st"> </span><span class="kw">sqrt</span>(x$var[i,i] *<span class="st"> </span>seval)
      yup &lt;-<span class="st"> </span>yhat +<span class="st"> </span>temp
      ylow&lt;-<span class="st"> </span>yhat -<span class="st"> </span>temp
      yr &lt;-<span class="st"> </span><span class="kw">range</span>(yr, yup, ylow)
    }
    
    if (<span class="kw">is.null</span>(limits)) { limits &lt;-<span class="st"> </span>yr }
    
    if (x$transform ==<span class="st"> 'identity'</span>)
      <span class="kw">plot</span>(<span class="kw">range</span>(xx), limits, <span class="dt">type =</span> <span class="st">'n'</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">1</span>, ...)
    else if (x$transform==<span class="st">'log'</span>)
      <span class="kw">plot</span>(<span class="kw">range</span>(xx), limits, <span class="dt">type =</span> <span class="st">'n'</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">log =</span> <span class="st">'x'</span>, ...)
    else {
      <span class="kw">plot</span>(<span class="kw">range</span>(xx), limits, <span class="dt">type =</span><span class="st">'n'</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, ...)
      <span class="kw">axis</span>(<span class="dv">1</span>, xaxisval, xaxislab)
      <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">1</span>)
      <span class="kw">box</span>()
    }
    if (resid) <span class="kw">points</span>(xx, y)
    <span class="kw">lines</span>(pred.x, yhat, <span class="dt">lwd =</span> wd, ...)
    if (se) {
      <span class="kw">lines</span>(pred.x, yup,<span class="dt">lty =</span> <span class="dv">2</span>)
      <span class="kw">lines</span>(pred.x, ylow, <span class="dt">lty =</span> <span class="dv">2</span>)
    }
  }
}</code></pre></div>
</div>
<div id="section-2.1-gastric-cancer-study" class="section level2">
<h2>Section 2.1: Gastric cancer study</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;gastric&quot;</span>)
<span class="co">#head(gastric)</span>

### time in years
gastric$yrs &lt;-<span class="st"> </span>gastric$time /<span class="st"> </span><span class="fl">365.25</span>    

<span class="kw">nrow</span>(gastric)</code></pre></div>
<pre><code>## [1] 90</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### follow-up/observation time
<span class="kw">survfit</span>(<span class="kw">Surv</span>(yrs, <span class="kw">abs</span>(<span class="dv">1</span> -<span class="st"> </span>status)) ~<span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> gastric)</code></pre></div>
<pre><code>## Call: survfit(formula = Surv(yrs, abs(1 - status)) ~ 1, data = gastric)
## 
##       n  events  median 0.95LCL 0.95UCL 
##   90.00   11.00    4.34    4.00      NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#survfit(Surv(yrs, status) ~ 1, data = gastric)</span>


### descriptive analysis
gtable0 &lt;-<span class="st"> </span><span class="kw">table</span>(gastric$status, <span class="dt">deparse.level =</span> <span class="dv">2</span>)
gtable0</code></pre></div>
<pre><code>## gastric$status
##  0  1 
## 11 79</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(gtable0) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## gastric$status
##     0     1 
## 12.22 87.78</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gtable1 &lt;-<span class="st"> </span><span class="kw">table</span>(gastric$radiation, gastric$status, <span class="dt">deparse.level =</span> <span class="dv">2</span>) 
<span class="kw">addmargins</span>(gtable1)</code></pre></div>
<pre><code>##                  gastric$status
## gastric$radiation  0  1 Sum
##               0    3 42  45
##               1    8 37  45
##               Sum 11 79  90</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(gtable1, <span class="dt">margin =</span> <span class="dv">1</span>) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>##                  gastric$status
## gastric$radiation     0     1
##                 0  6.67 93.33
##                 1 17.78 82.22</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### check assumption of proportional hazards
gsurv &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation, <span class="dt">data =</span> gastric)   
<span class="co"># summary(gsurv)</span>


<span class="co"># plot of cumulative survival probabilities</span>
if (pdfind) {  <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure1A.pdf&quot;</span>, <span class="dt">width =</span> <span class="fl">10.2</span>, <span class="dt">height =</span> <span class="dv">5</span>)  }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plot</span>(gsurv, <span class="dt">lty =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;time (years)&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">3</span>, <span class="dt">text =</span> <span class="st">&quot;survival distribution function&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
  <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;radiation&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>), 
         <span class="dt">lty =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">inset =</span> <span class="fl">0.05</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.4</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">dev.off</span>() }


<span class="co"># plots of scaled Schoenfeld residuals and test departure from proportional hazards</span>
gfit1 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> gastric, <span class="dt">x =</span> <span class="ot">TRUE</span>, 
               <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>) 
gfit1.ph &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(<span class="dt">fit =</span> gfit1, <span class="dt">transform =</span> <span class="st">&quot;km&quot;</span>) 
gfit1.ph</code></pre></div>
<pre><code>##              rho chisq        p
## radiation -0.401  12.8 0.000343</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure1B.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plotcoxzph</span>(<span class="dt">x =</span> gfit1.ph, <span class="dt">wd =</span> <span class="dv">2</span>, <span class="dt">limits =</span> <span class="kw">c</span>(-<span class="dv">3</span>, <span class="fl">4.3</span>))
  <span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>) 
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, 
        <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;time (years, &quot;</span>, <span class="kw">hat</span>(F), <span class="st">&quot;(t) transformation)&quot;</span>)))
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.2</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, 
        <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">hat</span>(beta), <span class="st">&quot;(t) for radiation&quot;</span>)))     
  <span class="co"># add the linear fit</span>
  <span class="kw">abline</span>(<span class="kw">lm</span>(gfit1.ph$y ~<span class="st"> </span>gfit1.ph$x)$coefficients, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)  </code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">dev.off</span>() }



gfit1.ph2 &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(<span class="dt">fit =</span> gfit1, <span class="dt">transform =</span> <span class="st">&quot;identity&quot;</span>) 

if (pdfind) {  <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure1C.pdf&quot;</span>, <span class="dt">width =</span> <span class="fl">5.2</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>))
  <span class="kw">plotcoxzph</span>(<span class="dt">x =</span> gfit1.ph2, <span class="dt">wd =</span> <span class="dv">2</span>, <span class="dt">limits =</span> <span class="kw">c</span>(-<span class="dv">3</span>, <span class="fl">4.3</span>))
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;time (years)&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.2</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>,
        <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">hat</span>(beta), <span class="st">&quot;(t) for radiation&quot;</span>))) 
  <span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>) 
  <span class="kw">mtext</span>(<span class="dt">text =</span> <span class="st">&quot;radiation...&quot;</span>, <span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">line =</span> <span class="fl">0.1</span>, <span class="dt">font =</span> <span class="dv">3</span>)
  <span class="kw">mtext</span>(<span class="dt">text =</span> <span class="st">&quot;protective&quot;</span>,  <span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">line =</span> <span class="dv">1</span>, <span class="dt">adj =</span> <span class="dv">0</span>, <span class="dt">font =</span> <span class="dv">3</span>)
  <span class="kw">mtext</span>(<span class="dt">text =</span> <span class="st">&quot;    harmful&quot;</span>,     <span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">line =</span> <span class="dv">1</span>, <span class="dt">adj =</span> <span class="dv">1</span>, <span class="dt">font =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">dev.off</span>() }


### ignore non-proportional hazards and apply a standard Cox proportional hazards model
<span class="kw">summary</span>(<span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> gastric, <span class="dt">x =</span> <span class="ot">TRUE</span>, 
              <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>))</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + cluster(id), 
##     data = gastric, x = TRUE, method = &quot;breslow&quot;)
## 
##   n= 90, number of events= 79 
## 
##             coef exp(coef) se(coef) robust se     z Pr(&gt;|z|)
## radiation 0.1415    1.1520   0.2263    0.2292 0.617    0.537
## 
##           exp(coef) exp(-coef) lower .95 upper .95
## radiation     1.152     0.8681    0.7351     1.805
## 
## Concordance= 0.565  (se = 0.031 )
## Rsquare= 0.004   (max possible= 0.999 )
## Likelihood ratio test= 0.39  on 1 df,   p=0.5325
## Wald test            = 0.38  on 1 df,   p=0.537
## Score (logrank) test = 0.39  on 1 df,   p=0.5314,   Robust = 0.37  p=0.5413
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># or equivalently</span>
<span class="co"># coxphw(Surv(yrs, status) ~ radiation, data = gastric, template = &quot;PH&quot;) </span></code></pre></div>
</div>
<div id="section-2.2-biofeedback-therapy-study" class="section level2">
<h2>Section 2.2: Biofeedback therapy study</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;biofeedback&quot;</span>)
<span class="co">#head(biofeedback)</span>

### descriptive analysis
<span class="kw">nrow</span>(biofeedback)</code></pre></div>
<pre><code>## [1] 33</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">btable0 &lt;-<span class="st"> </span><span class="kw">table</span>(biofeedback$bfb, <span class="dt">deparse.level =</span> <span class="dv">2</span>)
btable0</code></pre></div>
<pre><code>## biofeedback$bfb
##  0  1 
## 14 19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(btable0) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## biofeedback$bfb
##     0     1 
## 42.42 57.58</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### follow-up/observation time
<span class="co"># survfit(Surv(thdur, abs(1-success)) ~ 1, data = biofeedback)</span>
<span class="kw">survfit</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> biofeedback)</code></pre></div>
<pre><code>## Call: survfit(formula = Surv(thdur, success) ~ 1, data = biofeedback)
## 
##       n  events  median 0.95LCL 0.95UCL 
##      33      23      25      21      89</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">btable1 &lt;-<span class="st"> </span><span class="kw">table</span>(biofeedback$bfb, biofeedback$success, <span class="dt">deparse.level =</span> <span class="dv">2</span>) 
<span class="kw">addmargins</span>(btable1)</code></pre></div>
<pre><code>##                biofeedback$success
## biofeedback$bfb  0  1 Sum
##             0    4 10  14
##             1    6 13  19
##             Sum 10 23  33</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(btable1, <span class="dt">margin =</span> <span class="dv">1</span>) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>##                biofeedback$success
## biofeedback$bfb     0     1
##               0 28.57 71.43
##               1 31.58 68.42</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#hist(biofeedback$theal)</span>
<span class="co">#hist(biofeedback$log2heal)</span>


<span class="co"># Kaplan-Meier analysis</span>
bsurv &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span>bfb, <span class="dt">data =</span> biofeedback)
<span class="co"># summary(bsurv)</span>

if (pdfind) {  <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure2A.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma  =</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plot</span>(bsurv, <span class="dt">fun =</span> <span class="st">'event'</span>, <span class="dt">lty =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;duration of therapy (days)&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">3</span>, <span class="dt">text =</span> <span class="st">&quot;cumulative propability of rehabilitation&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)   
  <span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;biofeedback (bfb)&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>:<span class="dv">2</span>, 
         <span class="dt">inset =</span> <span class="fl">0.05</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.4</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAgVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6ZmY6kNtmAABmADpmOgBmZgBmZjpmZmZmtv+QOgCQOmaQZgCQ27aQ29uQ2/+2ZgC2Zma2tv+2/7a2/9u2///bkDrb25Db/7bb/9vb////tmb/25D//7b//9v///8041wtAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAZeUlEQVR4nO2de2Ojup1Amdsmnrt7ne22yXZ3uNst7Q5O/P0/YNEDEA/Zxgj0kzjnjxlMQDLhRO9HcQUQTBH7CwDcAkFBNAgKokFQEA2CgmgQFESDoCAaBAXRBBW0AAjDRoKGDAwODIKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQzXJBL7/+vT2si+LbjzvBAqxhsaCfb7+0gtaNnfW8oQgKYVgqaJNotoJ+fZybf8vX28ECrGGhoHVxrltBL6f35t+qS1DngwVYw/IyaC/o9x/uR0+wAGtYIagpfg4KoTODpADWEFbQxYEB3IYsHkSzRlAqSbA5KwSlmQm2Z4WgNNTD9jwp6NeHSjgrujphYxgsAqJBUBANgoJoEBREg6AgGgQF0SAoiAZBQTQICqJBUBBNPEHL4r07rorz5OdVUcycHV9zHgbki2vaI6t6bId36ggH3+rl572AYWvEClqrcfn3zHte0M+38Z0mQveUvgbiIkPQGapidhzf+KJnBS3VkJfBnSbC4SnPUBjYD8GCPpB8PS3o5XQefwUT4eDU59sDfySwKVEFrdtiprXx862w0+4vJ5XhvrZHVhr3uFRD/VpB6768qkqShS08dsVYLWhzdyefMda5s41wGNhM2RX2JaagfylamYyglZ0RenYEted0SuYcf33ow383gvYB2fOFGbPaXa5Ea+zv/Px80wo7d/aC9oHpZQBC/lZgOVNBy6J/xwGC9VJqdxoxzlZQc9gc62SrsgmbVe19eFypr6cMPI8DUmYZF/U1l5MKrRG0ubiXzYrn3tll8c6pVmSIx0TQNhnbQVCdLNZKKZtVn+03MKP1tS8mj9WiOMefb/rYSOcE9PVhrlE322MT9LcfpZsYViYxdb9CJ6hzqglj1W8B1jMW1CRQAYP1Yqsj2gFHqHZ5Mu1Lm2OrPxf3+HIyKZtbSeplMkVPZ5WzRtA/DxoFylZQ585BJckG1n0niMVY0EAV10cENe9eO1C5QjmC6lqTldI9rq1utU0eu4CccmwrsY6rGM6esreM7jyPT1FLio90QftU0D32CloZOauJoOeycIqTCJoMkzJoGaRa8HgWr70bZPHGLCtoL4h7PJfFq4Daa6pJFv/DbWQaZfHOX8TwFFl8fCaCXk4hktBglSRzkRbSObbiTCpJVlx93l5jbtWJay8slaRkmGbx+9XibdvSe9/MZMx0mpnqwhZFz8Njc1HZNjO1AZn2JfUMr31TlC0FuO1MtojgfoW+mak/RTNTfGIK+peuIX3SUN91Ltlz2hPn2FTpm7r5eRhQ24irPthqv7pcFyXrvp40aqh/7SMcnKKhPj7Ruzp1SjXp6uz74nUXj9XEPa7GXZ3v7enmEtOmrz+YpNL2bHall0FX57sT4eAUdaT4HHTAshkscg8Gi8RnRtCyz+ICBCuU8pESDMPt4jMRtC2Erqu+ihf0kcHIJKACmLaDtpWQVdUD8YJ6VoYewJQPAUz74s1baf9fHSzAGrxdnQ8V0h4IFmANpKAgGn8ZdFUFAUEhDEetxUMiHLUdFBLhoD1JkAoICqJxBVVNTPuNZgJ4AAQF0ZDFg2imPUntUEhSUBAAgoJoBoKaBYoKZ5bF+mAB1jBMQUtH0FULjCAohMGbxYcKFmAN/lr875RBIT7xll8EeAD/8ouZT/mANJgOWP724/L9x9oJjWIEVc9TdkvbuRPvIQnmpnzoilKZx4DldlVRu5xOgMwBdmVO0K+P80OzHh8KNjJK0Hc7QWC4xjgkwTSLfzWppyBBi0eZudfOn9arhQ2Xz4MkmJmT9K4LoJl0ddolzZ01G4dL4YJwZtYHLd51l2cuZdBuldDREs6QBNN2UFWHr1d2xSMoBCL38aCOoKM1xiEJch9uN1gInEpSehxJ0OEa45AEuY8HdQWloT5Bch8POhCUrs7tebjR+qFm7OXjQWt3y7bK67EYQWFXVuj5oKB3qBs769ZQ1Z5fzxuKoMfEY9maEJ2j+/PidS99O45E94p6BpUg6DGJLejlpLe8Mj9CUBizraD3Ub1M/TgSsngYEVtQU/zsCqF1MWpSvFPghdzZOot361RzWfxQUNWW79kRC0GPSWxBB1n8oEDqDRaOROwsfuDkKL/3BAtHIragg2YmY+v8yHsEPSaxm5mGDfWUQWFEdEHNLthdG2jhG3iBoMckdhb/RLBwJBAURLOLoHrM3cohkwh6THYQtC2EZjJprp3eoSfGmxHZ7/ZEsXq7Mhizg6ClfmvZ7NXZzuAsVdXOjqg38z4C/BnCmO0F/XxrdzuWMyep7dy/9/8spU4x9WNdTuqZ9FIOn2+mLWLdvAEYs4egme0Xb/L2WhWqS9OAq2Rlavw27JHFtyloHlm8yQr0zKR2oTvVxKuOUTQ8u1SStKHrElBBgjalzXOTub9eh30QZgIrjgYm9mimJ4KNjprQWamy5ihbN9UkZiAHBUGX02Tv/6NrfKZi5NI8MGloUOhJeoK6+O2kC9SmBc1dmom6UmD2FDSbbWiadNIknbXO0ZuPZ9vi1GTzNIQGZQ9B89uGpmw1dFrn7VOySlNYdhA0w21o6u5ZdN39bE/SkRSe7QXNbRuaa7c8E+zAPj1JOW1Dc237kmAP9hE0t21oSEB3Y48sXt42NKsoVy4kCUvYZbhdVtvQwK7sIGhm29DAruzRDprXNjSwGcUswWOZOQoaLOTJvJ4ICkLYawHDI3R1wgZEE7Tr6kRQuEEsQQPNI0PQ3IklaDdpLlSwkCcICqKJVgYtgwxBQ9DciSZomCQUQXMnhqB5Tppby7gFms/DE6HDH4Ggd/C9j8N/LrYJfww9SfAU8XqSAgcLeRJR0LIozpdf12TwCJo/EWvxhRL0lM+kOdiCeO2gys5ztzLx6mAhT+L1JL38VIJKWsAWBBKzq1NvzsWcJAXbNvuIN5qpTUFXdXnm8l4R1EfE8aCqDJrNJgorQVAf0QRtF8rOZoXlVSCoj4jtoHpM/coRI7m8VwT1QU+SCBDUR8xKUtBg0wZBfTCiXgQI6iNaFl8zac4BQX3ES0Hb8Xk01MMNEBREQy0eRIOgIBoEBdEgaHAGU7PGU7XufYYRMQT9+q918zxmg5VC2LmGEGdevN2CJmSwUsC1cOz5tzsU9OUngsId9s1cBmXQsnDIrB0UQUOx729yIOhgaZHMBIVQRBT0es23DAqhiCto8GAhN2QLWrtbX6oNv+ZH5yFovkQXtLwx5aNu7KxbQ+uXn77xowiaL5EFbStKs3UkvQ9yu1O3+VDNXoig+RJZ0FJvgvj1UZxnrr6cVBXKOqn2TLwfLORGXEHbOUnzc5OMk3an7vqXvzWp7cDjvpFqsy/8LAK/UqLEbmayZcrZpW9M8dMWQitVDND7y98KVgoIGgrJKehQ0G9OcuoNVgoIGgopZdC5lHGQxZuiqCmW+oOVAoKGQnItflBJMp7OV5Xk2YCgoZDcDjpoZjK9omTxRyO6oLcYNNRXTWHAKHsjWCkgaChEC6pWFlN+msp7XRSzzaUImjOyBV0crBQQNBQICqJB0MCQdoYFQQODoGFB0MAgaFgi98X/b+Bg44OgYYk9WGT1+vTDYOODoGGJncXX6/f4QNCciS3o1fbHr9pNVpITCBoWAYK2uyXN9xItCzY+CBoWAYKqXP7l57V8vjQqyQkEDUt0Qasu7Xx+Q1mcyJfYI+obPdshyAgKU2I3M62twI+ChdyILahNPtkvHuZBUBBNREHVWksdq/bsRNB8iZmCuivYrlqGEUEDU0hi1wcfHeW2Pujuv9BNiCzkmF0ffeYoaLBRifAL3YQMHuFZXEHNLh/tn0kOlaRcXmwuz/EECJoCuTzHE+SdxecCgl4RVDIIejVZvFtVyyGLzwUEvSKoZBD0ShYvGQS9IqhkEPSaZzNTLiDoNU9Bc3mxuTzHE+SdxefyYnN5jidA0BTI5TmeYEZQPebu+RnHo2CjksuLzeU5nmAiaFsIXTVeGUHDkstzPMFEUDMZ3rMNzRPBRiWXF5vLczzBdMByu5EXtXg55PIcTzAV9NZWiE8EG5VcXmwuz/EE0yy+TUHJ4uWQy3M8wUwlSRu6LgGVImguIOg1t9FMeb3SvJ5mEQiaAnk9zSJy7UnK65Xm9TSL8Av6OymoGPJ6mkVMBS3J4sWR19MsYiJo1ZZBV/XGR/+F5vVK83qaRYwF/fr49uPy/ce1WrWHAoKGJa+nWcRcT5Jen6lMu6E+r1ea19MsYk7Qr48me68pg8ohr6dZxDSLfzWpZ+KC5gWC9kdl8a4LoFkMFskFBO2PLqfiXa+0nHYZNC8Q1DlSdfg6kxH1q1iwouv2xP5lRCPXrs7VxDZyROxfRzQQ1MOBnRBF3rM6V4CgMsh1VudqvxBUBjPNTCrx/Po4el88gspg2pNkxPz6SG0jL6cmEaJagaAymAqa5laIrpNB6r0IKoPZrs5reilocJ8QVAYzPUlmZZHEhtshaKZMs3i3eXiazddFMVC3nE9oERTCsFDQurGzdgytPc1RCAphWNaTpEeKOmOZG50RFLZkmaCXk6rjV13CWr38VYigwUFQGfi6OucH26mRTs5Y5ubjsAya0eCGDB4hC7xdnbPNoKb42RZCVYYvpZIUHASVwUxXp1LO09U5FLRqrkRQ2JRpQ327/OKceYMsXn9AUNiUuVmdmtmuzkElqV3i4f1msKmCoDJYloKOm5lIQWFj/GXQ2Xr8uKFejKC0g2bKslq8zteVn90K4QgKm7KsHfSJYHcCQTMll0lzCJopvkpSsGB3AkEzxdvMFCrYbXFmeYQOGUFFMMni69l2zeeD3ZLBLI/gYQcOEJ7CPx40gTlJW0qEoDJA0Ahhw+MkXYt/WiKWQ0qGIwr6kJ4IKgNfQ30SazM9LWjg7wHb4e3qTGFtJgTNn5nBIumszYSg+TOtxae6NtPjIGhCTAVNc22mJSBoQkz74tNcm2kJCJoQkzJoomszLQFBE8Lfk7SqN0m0AgiaEAgKokm6J+lJEDQhkhaUdtD8QVAQDYKCaBIW9OkRRwiaEOkK+vyQOARNiHQFfR4ETYj58aDny69reuIRFEIxPx70fDnR1QkSmBsPejmdr9W6xW9EK4CgCTHt6nz5qQT9+mC4HQhgbmURJSjjQUEE0/GgbQoqezzoGskQNCEmZdBKl0F9C9guD3YjEPQgTARt1Fy/sAiCQiBm2kGrFBawRdCDkGpPEoIeBAQF0XinHYcKdiMQ9CDMzUla18s5CnYjEPQgTLN4XY1fu1A9gkIYZsugesCI7HbQNSBoQvgqSZ9vdHWCAPwpaAKr2z0JgiZEqmXQNSBoQszV4tf1co6CFQiCJkSq7aBrQNCESLUnaQ0ImhCuoGqwcir7JNEOehAQFESTahaPoAfBW0kSPicJQQ8CgoJoBoJeTs7qykyaAwEMU9DSEXRVeyiCQhhSbahH0IPgr8X/ThkU4jMVtEyiHXQNCJoQMws3WBhuBwIYC6q2mLt8/3GtWH4RJDCtJL2ailLJlA8QwJygXx9N9l7nWQYtnl/aHmIwzeJfTeopWNA12ycgaGJMKkll8a4LoJ6uztqZNq8nh8zXpTZUYI1jqJkcE0Evp+Jdd3nOlkHrxs7aGqq37PYsFb6poHHuhShM20FVHb72dMXr0mlbf7qcVKdTNZvSIiiEYdl40Bkn69n2KASFMCwU9LuycVB/GpRV+6Emwb5gUKR+L/AynPLhDGaa7eo0yaWbaNbztSShIiBocqwUtPYs4SRUBARNjnVZvCf9RFAIxapKUuUdUSJUBARNjmlX560sftDM1PjpHdwsVAQETY5lgg4a6vWGdHeDFQWCJocviy89c+Yq09WpuuztyFHaQWFDfIKazDxAsMFB0EPhrST5ktClwQYHQQ+FX1Cpw+0Q9FD4BK3FLtyAoIfCX4unDAoC8Aq6bjdZBIUwLOtJeiLY4CDooUhH0HYMH4IeiomgeqKRvJVFwgwyRdDkmJk0J1RQOaHAjkwrSQF2SUJQCMVU0HXV90mwgUDQgzLN4tfugjgKNhCPqlXcIfT3go2ZmRe/qoV+EmwgHlPrnp4ImhzTZqZ2/UVZlaQHo0XA3EilFv9gtAiaG6nU4h+MFkFzI5Va/IPRImhupFKLfzBaBM2Nma5OkbX4B6NF0NxYOKtzebC7gqDZkYqgj7aDho4XIpPKcDsEPSgICqIhiwfRICiIxpfFr2wOXS3KeHAHgh4Un6CRl74Zjz56cBwSgmaHt5Ikdumbm9EiaG74BZVVBn0wWgTNDZ+gcpe+uRktguaGvxYfqwzKvHdw8AoabekbBAUHeT1JCAoOCAqimQqqd0Ga3yL2mWCX34qg0DMRtNa7IpSFf4uZZcEuvxVBoWcsqN4E/hqzmQlBwcE7aS5aQ/1AsvsrMbAwQ95MBbUppwRBF+uJoNkxndVpWkCrdQ2hYUTBN5gI2rbUr6vGIyiEYaYdtFzfkYSgEAh5DfVuKAh6eBAURCNI0GlFHEFBjqAzLUUICnIEnQsFQQ8PgoJoEBREg6AgGgQF0QgRdF5FBAUEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIJqlgtZFYSbOTz54gl0DgsJCQetGyLqVcvDBF+waEBSWCWpWri9fpx+8wa4BQWGZoJeTWrHJriw2+OANdniadRhgGQsF/a4y9NoK6n6wYdw2i4VCYCnLBDUlTlvuHHzwBguwBgQF0YTN4hcFBnCffStJAAsR3cwEILqhHmBpV2dleje/Pl77DzeDBViDkMEiAPMgKIgGQUE0CAqiQVAQDYKCaBAURLOVoABh2EZQj7bbRxElLh5sj7gQNI3IDvtgCJpGZId9MARNI7LDPhiCphHZYR8MQdOI7LAPhqBpRHbYB0PQNCI77IMhaBqRHfbB6J0E0SAoiAZBQTQICqJBUBANgoJoEBREg6AgGgQF0SAoiAZBQTQICqJBUBDN1oL6t6ULytdHURTnHSMsX37uE9nlVBR6teA9Hqxqfovve0R2+fXvg2i23r3Qy43VbkPy9dHEUakXuVOEdaEE3SGyuonn822nB6tUHMrQrSP7fNNLyHfRRFsU+dZ64SHpFs7fKcLPNyXoDpGZKHZ6MLM+cRPH1pE16aUStIsm3rLyt3ZcCE/zN7hThNXLXxtBd4jM7Kly3ec32Qm6cWR1cda7xHTRxNuY49aeNeEpm0fdJcImFlUG3SGy+pe/venC9S4P1mbx20dmBG2jibe10a1dv8JH1rzIXSJUOZISdIfIKpUXqpRtn9+kratsH5mWsYsm3uZwewpat3WkzSOsGjn3EvSbTVt2ebAmC2ry3T3+zKUIumMWX+tWpj0i1HHslMWbcllTRtvlwboy4WGy+P0qSZVpBd0jwsquEPi+Q2TmpTUvcI8H6xKy7SOTUknaq5mpkeZ93wjLfZqZPt/Uc9X7NDMZT3aJrBbSzLRXu7kqOO0aoelJ2iGyqv1D2OPB2jLo9pHVQhrqb21LFzgWhYppnwhtV+cOkdVtH+4eD1buFZktb3bRsHshJAqCgmgQFESDoCAaBAXRICiIBkFBNAgKokFQEA2CgmgQFESDoCAaBAXRICiIBkFBNAjqcjndHUX+9aFHgj7C55tdSGbpjZ7g/qMdMXn/a5bnOxckA4K63HnzlZ4D/LBnZTcKd+GNnuC673Zf0G7Bh+RBUJc7b75cNI3s66O7vAwgqDMl4oGEfodpWfuAoC6BBe2MDCGoo9wDgu60WMb2IKhFFRhf1Zs3Iql/vz5eq0KvBqOn6uglHl/bHzfH9rp/nOxEHk33E33Xa3dK3fjPN3tlt1rkKAqtcmmW1jJrNpj1kq7tlMv+a167e5wL1Zwi80ekV8TLAQQ1qGU4i+IPI0H/cGpcszPyzo6g5mqzLI396SAc9ZOpoH/8k73SXvSqfjSIQgn6n3b6n5mpWrfVLKNh/zWv3T39hWU3dXBpai8XBNU0DhlxhoKqk2Yty883td5Nm1OX2rxSX11oWdr0qv/JNItXCWtt7tGJZaPUNArtV9l9j86z0swk775mf093oUk1azsvM5M8HkE1tlRXjwRt7VBpoCOoVsnUgsw19kR3oM9OBFXKqAtsZCpTnkZh8+vmtFKsy6lNYM7XdO5pLzSrllpqp4UrZRBUY1d+UK/ZFVS/b5shO4K260Q0ZvRXu+FoZ2YrSeZ2u3iOJwp7/+fbudesFbT7ms493YVVW3K4Imhm3BD0U9dsBll8KEFVAjwThb1fLQ5R9gnsSFDnnv5CddJU0RA0LwZZ/LBwZ970QNBBFj8Q9GYW3wvaVfqnUfRZ/LX+9t9v58GFztd07hlc2Jwya4AhaFaUXe1DH+oaTWvPa7sofdmmi24laSCor5LUJai28qVX6epud6PQzUQmlM+33/oOIZNE9l/Tuae90OhryrpUkjLDZLu/qVes24f++Cc3i7ctR1XbzGTPDbQz4fQ/cQWtnAbUvpWqu92Jovz2b0XXmFk6lR63mUl9Teee7kLTzGQKoeXKjlUpIKhF1YhtC3ij08v/95UkrcJ7qast5gdt0+b1OhG0/4l70r1x3M4/jKL85f8+itZLpyzQHvdfs7/HKfrqdUtNjJkMF0FQWQza1wfZ9K0kcZqf09UJm+AK2rWuam4oN7zQhJNJTyeCCqMXdDia9Op3bnLhleF2sBW9oLZDtKcfsDxkcuGVAcsAO4GgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURPMvBLQHhIJXW8kAAAAASUVORK5CYII=" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">dev.off</span>() }


bfit1 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span>bfb +<span class="st"> </span>log2heal +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> biofeedback, 
               <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>) 
<span class="kw">summary</span>(bfit1)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ bfb + log2heal + cluster(id), 
##     data = biofeedback, x = TRUE, method = &quot;breslow&quot;)
## 
##   n= 33, number of events= 23 
## 
##             coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)
## bfb       0.2700    1.3099   0.4273    0.3453  0.782    0.434
## log2heal -0.5267    0.5906   0.2543    0.3636 -1.448    0.148
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## bfb         1.3099     0.7634    0.6658     2.577
## log2heal    0.5906     1.6933    0.2896     1.205
## 
## Concordance= 0.665  (se = 0.067 )
## Rsquare= 0.196   (max possible= 0.984 )
## Likelihood ratio test= 7.19  on 2 df,   p=0.02753
## Wald test            = 2.66  on 2 df,   p=0.2648
## Score (logrank) test = 5.16  on 2 df,   p=0.07595,   Robust = 4.72  p=0.09426
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bfit1.ph &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(bfit1, <span class="dt">transform =</span> <span class="st">&quot;km&quot;</span>) 
bfit1.ph</code></pre></div>
<pre><code>##             rho chisq       p
## bfb      -0.553  4.39 0.03615
## log2heal -0.287  8.78 0.00305
## GLOBAL       NA 13.46 0.00119</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure2B.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plotcoxzph</span>(<span class="dt">x =</span>  bfit1.ph[<span class="dv">1</span>], <span class="dt">wd =</span> <span class="dv">2</span>)           
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;duration of therapy (days)&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.2</span>, <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(beta)), <span class="dt">cex =</span> <span class="fl">1.2</span>)
  <span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>) 
  <span class="kw">abline</span>(<span class="kw">lm</span>(bfit1.ph$y[,<span class="dv">1</span>] ~<span class="st"> </span>bfit1.ph$x)$coefficients, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)  
  <span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="dt">legend =</span> <span class="st">&quot;bfb&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">inset =</span> <span class="fl">0.08</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">dev.off</span>() }

if (pdfind) {  <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure2C.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plotcoxzph</span>(<span class="dt">x =</span> bfit1.ph[<span class="dv">2</span>], <span class="dt">wd =</span> <span class="dv">2</span>, <span class="dt">limits =</span> <span class="kw">c</span>(-<span class="fl">4.5</span>, <span class="dv">4</span>))
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;duration of therapy (days)&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
    <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.2</span>, <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(beta)), <span class="dt">cex =</span> <span class="fl">1.2</span>)
  <span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>) 
  <span class="kw">abline</span>(<span class="kw">lm</span>(bfit1.ph$y[,<span class="dv">2</span>] ~<span class="st"> </span>bfit1.ph$x)$coefficients, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)  
  <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="st">&quot;log2heal&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">inset =</span> <span class="fl">0.08</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) {  <span class="kw">dev.off</span>() }</code></pre></div>
</div>
<div id="section-5-simulation" class="section level2">
<h2>Section 5: Simulation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simulation &lt;-<span class="st"> </span>function(<span class="dt">n1 =</span> <span class="dv">100</span>, <span class="dt">n2 =</span> <span class="dv">100</span>, <span class="dt">sim =</span> <span class="dv">10</span>, <span class="dt">seed =</span> <span class="dv">123</span>, 
                       <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;ph&quot;</span>, <span class="st">&quot;nph1&quot;</span>, <span class="st">&quot;nph2&quot;</span>, <span class="st">&quot;nph3&quot;</span>), <span class="dt">scalewei =</span> <span class="ot">NULL</span>, 
                       <span class="dt">shapewei =</span> <span class="ot">NULL</span>, <span class="dt">beta =</span> <span class="ot">NULL</span>, <span class="dt">scaleexp =</span> <span class="ot">NULL</span>, <span class="dt">shapewei2 =</span> <span class="ot">NULL</span>, 
                       <span class="dt">scalewei2 =</span> <span class="ot">NULL</span>, <span class="dt">shapegom =</span> <span class="ot">NULL</span>, <span class="dt">scalegom =</span> <span class="ot">NULL</span>, scaleexpC, 
                       admincens, <span class="dt">npop =</span> <span class="dv">10000</span>, <span class="dt">xmaxplot =</span> <span class="ot">NULL</span>, <span class="dt">addconstant =</span> <span class="fl">1e-4</span>)
  {
 
    <span class="co">#</span>
    <span class="co"># Simulate time-to-event data (following either an expoential, Weibuill or Gompertz</span>
    <span class="co"># distribution) with one binary explanatory variable, generate six versions of</span>
    <span class="co"># each simulated data set with differnt censoring patterns (no censoring, administrative</span>
    <span class="co"># censoring and loss-to-follow-up) and analyse these data sets with Cox regression</span>
    <span class="co"># and weighted Cox regression. Population-c is computed, as well.</span>
    <span class="co">#</span>
    <span class="co"># sim: number of simulations, 0 only population c is computed and plot is generated.</span>
    <span class="co">#</span>
    <span class="co"># type = &quot;ph&quot;   : Weibull distributed distributions, proportional hazards</span>
    <span class="co">#        &quot;nph1&quot; : exponential and Weibull distribution, non-proportional hazards</span>
    <span class="co">#        &quot;nph2&quot; : exponential and Weibull distribution, non-proportional hazards</span>
    <span class="co">#        &quot;nph3&quot; : exponential and Gompertz distribution, non-proportional hazards</span>
    <span class="co">#</span>
    <span class="co"># &quot;ph&quot; requires scalewei, shapewei and beta</span>
    <span class="co"># &quot;nph1&quot; requires scalewei, shapewei and scaleexp</span>
    <span class="co"># &quot;nph2&quot; requires scalewei, shapewei, scalewei2 and shapewei2</span>
    <span class="co"># &quot;nph3&quot; requires scaleexp, scalegom and shapegom</span>
    <span class="co">#</span>
    <span class="co"># scaleexpC and admincens: parameters for loss-to-follow-up and adminitrative censoring</span>
    <span class="co">#</span>
    <span class="co"># add.constant  : this number will be added to all times to prevent survival times of </span>
    <span class="co">#                 exactly 0.</span>
    <span class="co">#</span>

    type &lt;-<span class="st"> </span><span class="kw">match.arg</span>(type)
    if (type ==<span class="st"> &quot;ph&quot;</span>)   {
        <span class="kw">stopifnot</span>(!<span class="kw">is.null</span>(scalewei),!<span class="kw">is.null</span>(shapewei),!<span class="kw">is.null</span>(beta))
    } else if (type ==<span class="st"> &quot;nph1&quot;</span>) {
        <span class="kw">stopifnot</span>(!<span class="kw">is.null</span>(scalewei),!<span class="kw">is.null</span>(shapewei),!<span class="kw">is.null</span>(scaleexp))
    } else if (type ==<span class="st"> &quot;nph2&quot;</span>) {
        <span class="kw">stopifnot</span>(!<span class="kw">is.null</span>(scalewei),!<span class="kw">is.null</span>(shapewei),!<span class="kw">is.null</span>(scalewei2),!<span class="kw">is.null</span>(shapewei2))
    } else if (type ==<span class="st"> &quot;nph3&quot;</span>) {
        <span class="kw">stopifnot</span>(!<span class="kw">is.null</span>(scaleexp),!<span class="kw">is.null</span>(scalegom),!<span class="kw">is.null</span>(shapegom)) 
    }

    <span class="kw">set.seed</span>(seed)

    <span class="co"># 1) compute population c</span>
    if (type !=<span class="st"> &quot;ph&quot;</span>) {
      if (type ==<span class="st"> &quot;nph1&quot;</span>) {
        integrandA &lt;-<span class="st"> </span>function(x) { (scalewei *<span class="st"> </span><span class="kw">exp</span>(-scalewei *<span class="st"> </span>x)) *<span class="st"> </span>
<span class="st">                                     </span><span class="kw">exp</span>(-scalewei *<span class="st"> </span>x ^<span class="st"> </span>scalewei) }
      } else if (type ==<span class="st"> &quot;nph2&quot;</span>) {
        integrandA &lt;-<span class="st"> </span>function(x) { (scalewei2 *<span class="st"> </span>shapewei2 *<span class="st"> </span>x ^<span class="st"> </span>(shapewei2 -<span class="st"> </span><span class="dv">1</span>) *<span class="st"> </span>
<span class="st">                                     </span><span class="kw">exp</span>(-scalewei2 *<span class="st"> </span>x ^<span class="st"> </span>shapewei2)) *<span class="st"> </span><span class="kw">exp</span>(-scalewei *<span class="st"> </span>
<span class="st">                                     </span>x ^<span class="st"> </span>shapewei) }
      } else if (type ==<span class="st"> &quot;nph3&quot;</span>) {
        integrandA &lt;-<span class="st"> </span>function(x) { scaleexp *<span class="st"> </span><span class="kw">exp</span>(-scaleexp *<span class="st"> </span>x) *<span class="st"> </span>
<span class="st">                                    </span><span class="kw">exp</span>(scalegom /<span class="st"> </span>shapegom *<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span><span class="kw">exp</span>(shapegom *<span class="st"> </span>x)))  }
      }
      popc100 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">integrate</span>(integrandA, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="ot">Inf</span>)$value,
                       <span class="kw">integrate</span>(integrandA, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> admincens[<span class="dv">1</span>])$value,
                       <span class="kw">integrate</span>(integrandA, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> admincens[<span class="dv">2</span>])$value) *<span class="st"> </span><span class="dv">100</span>, 
                     <span class="dt">each =</span> <span class="dv">2</span>)
    } else { popc100 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">exp</span>(beta) /<span class="st"> </span>(<span class="dv">1</span>+<span class="kw">exp</span>(beta)), <span class="dv">6</span>) *<span class="st"> </span><span class="dv">100</span> }

    if (sim ==<span class="st"> </span><span class="dv">0</span>) { output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">results =</span> <span class="ot">NA</span>, <span class="dt">olist =</span> <span class="ot">NA</span>, <span class="dt">popc100 =</span> popc100) }

    <span class="co"># 2) Kaplan-Meier plot of scenario</span>
    xpop &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, npop /<span class="st"> </span><span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">1</span>, npop /<span class="st"> </span><span class="dv">2</span>))
    u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> npop, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)

    if (type ==<span class="st"> &quot;ph&quot;</span>) {
      time1pop &lt;-<span class="st"> </span>(-<span class="kw">log</span>(u[<span class="dv">1</span>:(npop /<span class="st"> </span><span class="dv">2</span>)]) /<span class="st"> </span>(scalewei *<span class="st"> </span><span class="kw">exp</span>(beta *<span class="st"> </span><span class="dv">0</span>))) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
      time2pop &lt;-<span class="st"> </span>(-<span class="kw">log</span>(u[((npop /<span class="st"> </span><span class="dv">2</span>) +<span class="st"> </span><span class="dv">1</span>):npop]) /<span class="st"> </span>(scalewei *<span class="st"> </span><span class="kw">exp</span>(beta *<span class="st"> </span><span class="dv">1</span>))) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
    } else if (type ==<span class="st"> &quot;nph1&quot;</span>) {
      time1pop &lt;-<span class="st"> </span>((-<span class="kw">log</span>(u[<span class="dv">1</span>:(npop /<span class="st"> </span><span class="dv">2</span>)])) /<span class="st"> </span>scalewei) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
      time2pop &lt;-<span class="st"> </span>-<span class="kw">log</span>(u[((npop /<span class="st"> </span><span class="dv">2</span>) +<span class="st"> </span><span class="dv">1</span>):npop]) /<span class="st"> </span>scaleexp
    } else if (type ==<span class="st"> &quot;nph2&quot;</span>) {
      time1pop &lt;-<span class="st"> </span>((-<span class="kw">log</span>(u[<span class="dv">1</span>:(npop /<span class="st"> </span><span class="dv">2</span>)])) /<span class="st"> </span>scalewei) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
      time2pop &lt;-<span class="st"> </span>((-<span class="kw">log</span>(u[((npop /<span class="st"> </span><span class="dv">2</span>) +<span class="st"> </span><span class="dv">1</span>):npop])) /<span class="st"> </span>scalewei2) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei2)
    } else if (type ==<span class="st"> &quot;nph3&quot;</span>) {
      time1pop &lt;-<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span>shapegom *<span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> -<span class="st"> </span>(shapegom *<span class="st"> </span><span class="kw">log</span>(u[<span class="dv">1</span>:(npop /<span class="st"> </span><span class="dv">2</span>)])) /<span class="st"> </span>scalegom)
      time2pop &lt;-<span class="st"> </span>-<span class="kw">log</span>(u[((npop /<span class="st"> </span><span class="dv">2</span>) +<span class="st"> </span><span class="dv">1</span>):npop]) /<span class="st"> </span>scaleexp
    }

    time1pop &lt;-<span class="st"> </span>time1pop +<span class="st"> </span>addconstant
    time2pop &lt;-<span class="st"> </span>time2pop +<span class="st"> </span>addconstant
    datapop &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">c</span>(time1pop, time2pop), <span class="dt">event =</span> <span class="dv">1</span>, <span class="dt">x =</span> xpop))

    fitpop &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> datapop)

    if (<span class="kw">is.null</span>(xmaxplot)) { xmaxplot &lt;-<span class="st"> </span><span class="kw">max</span>(datapop$time)  }

    <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
    <span class="kw">plot</span>(<span class="kw">survfit</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> datapop), <span class="dt">lty =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, 
         <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, xmaxplot))
    <span class="kw">abline</span>(<span class="dt">v =</span> admincens, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
    <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
    <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">3</span>, <span class="dt">text =</span> <span class="st">&quot;survival distribution function&quot;</span>, 
          <span class="dt">cex =</span> <span class="fl">1.2</span>)
    <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> -<span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, <span class="dt">font =</span> <span class="dv">2</span>, 
          <span class="dt">text =</span> if (type ==<span class="st"> &quot;ph&quot;</span>) { <span class="st">&quot;proportional hazards scenario&quot;</span> } else {
          <span class="st">&quot;non-proportional</span><span class="ch">\n</span><span class="st">hazards scenario&quot;</span> } )
    
    <span class="co"># 3) simulate data sets and analyse them</span>
    if (sim !=<span class="st"> </span><span class="dv">0</span>) {
      n &lt;-<span class="st"> </span>n1 +<span class="st"> </span>n2
      out &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> sim, <span class="dt">ncol =</span> <span class="dv">7</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="dv">1</span>:(sim), 
                        <span class="kw">c</span>(<span class="st">&quot;cens&quot;</span>, <span class="st">&quot;cox_beta&quot;</span>, <span class="st">&quot;cox_c100&quot;</span>, <span class="st">&quot;wcox_beta&quot;</span>, <span class="st">&quot;wcox_c100&quot;</span>, 
                          <span class="st">&quot;wilcox100&quot;</span>, <span class="st">&quot;prt0st1&quot;</span>))))
      olist &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">out =</span> out, <span class="dt">outC =</span> out, <span class="dt">out1 =</span> out, <span class="dt">outC1 =</span> out, <span class="dt">out2 =</span> out, <span class="dt">outC2 =</span> out)
      x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, n1), <span class="kw">rep</span>(<span class="dv">1</span>, n2))

      for (i in <span class="dv">1</span>:sim) {
        <span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))

        ### simulate data without censoring (data), type 1
        u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)

        if (type ==<span class="st"> &quot;ph&quot;</span>) {
          time1 &lt;-<span class="st"> </span>(-<span class="kw">log</span>(u[<span class="dv">1</span>:n1]) /<span class="st"> </span>(scalewei *<span class="st"> </span><span class="kw">exp</span>(beta *<span class="st"> </span><span class="dv">0</span>))) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
          time2 &lt;-<span class="st"> </span>(-<span class="kw">log</span>(u[(n1 +<span class="st"> </span><span class="dv">1</span>):n]) /<span class="st"> </span>(scalewei *<span class="st"> </span><span class="kw">exp</span>(beta *<span class="st"> </span><span class="dv">1</span>))) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
        } else if (type ==<span class="st"> &quot;nph1&quot;</span>) {
          time1 &lt;-<span class="st"> </span>((-<span class="kw">log</span>(u[<span class="dv">1</span>:n1])) /<span class="st"> </span>scalewei) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
          time2 &lt;-<span class="st"> </span>-<span class="kw">log</span>(u[(n1 +<span class="st"> </span><span class="dv">1</span>):n]) /<span class="st"> </span>scaleexp
        } else if (type ==<span class="st"> &quot;nph2&quot;</span>) {
          time1 &lt;-<span class="st"> </span>((-<span class="kw">log</span>(u[<span class="dv">1</span>:n1])) /<span class="st"> </span>scalewei) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei)
          time2 &lt;-<span class="st"> </span>((-<span class="kw">log</span>(u[(n1 +<span class="st"> </span><span class="dv">1</span>):n])) /<span class="st"> </span>scalewei2) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>shapewei2)
        } else if (type ==<span class="st"> &quot;nph3&quot;</span>) {
          time1 &lt;-<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span>shapegom *<span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> -<span class="st"> </span>(shapegom *<span class="st"> </span><span class="kw">log</span>(u[<span class="dv">1</span>:n1])) /<span class="st"> </span>scalegom)
          time2 &lt;-<span class="st"> </span>-<span class="kw">log</span>(u[(n1 +<span class="st"> </span><span class="dv">1</span>):n]) /<span class="st"> </span>scaleexp
        }
        time1 &lt;-<span class="st"> </span>time1 +<span class="st"> </span>addconstant
        time2 &lt;-<span class="st"> </span>time2 +<span class="st"> </span>addconstant

        data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">c</span>(time1, time2), <span class="dt">event =</span> <span class="dv">1</span>, <span class="dt">x =</span> x))
        
        fit1 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> data)
        fit2 &lt;-
<span class="st">          </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> data)
        fit1zph &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(<span class="dt">fit =</span> fit1, <span class="dt">transform =</span> <span class="st">&quot;km&quot;</span>)

        eg &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(time1, time2)
        olist$out[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(
          <span class="dv">0</span>,
          fit1$coefficients, <span class="kw">concord</span>(fit1)[<span class="dv">1</span>],
          fit2$coefficients, <span class="kw">concord</span>(fit2)[<span class="dv">1</span>],
          <span class="kw">wilcox.test</span>(time ~<span class="st"> </span>x, <span class="dt">data =</span> data, <span class="dt">correct =</span> <span class="ot">FALSE</span>)$statistic /
<span class="st">            </span>(n1 *<span class="st"> </span>n2),
          <span class="dv">1</span> -<span class="st"> </span>(<span class="kw">sum</span>(eg[,<span class="dv">1</span>] &lt;<span class="st"> </span>eg[,<span class="dv">2</span>]) /<span class="st"> </span><span class="kw">nrow</span>(eg)))

        ### follow-up distribution
        timecens &lt;-<span class="st"> </span>(-<span class="kw">log</span>(<span class="kw">runif</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data), <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)) /<span class="st"> </span>scaleexpC) +<span class="st"> </span>addconstant

        ### data with censoring (dataC), type 2
        dataC &lt;-<span class="st"> </span>data
        dataC$time[data$time &gt;<span class="st"> </span>timecens] &lt;-<span class="st"> </span>timecens[data$time &gt;<span class="st"> </span>timecens]
        dataC$event[data$time &gt;<span class="st"> </span>timecens] &lt;-<span class="st"> </span><span class="dv">0</span>
        censC &lt;-<span class="st"> </span><span class="kw">sum</span>(dataC$event ==<span class="st"> </span><span class="dv">0</span>) /<span class="st"> </span>n *<span class="st"> </span><span class="dv">100</span>

        fit1C &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> dataC)
        fit2C &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> dataC)

        dataC$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(dataC)

        wilcoxC &lt;-<span class="st"> </span><span class="kw">wilcox.test</span>(time ~<span class="st"> </span>x, <span class="dt">data =</span> dataC, <span class="dt">correct =</span> <span class="ot">FALSE</span>)$statistic
        egC &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(dataC$event[dataC$x ==<span class="st"> </span><span class="dv">0</span>], dataC$event[dataC$x ==<span class="st"> </span><span class="dv">1</span>])
        olist$outC[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(censC,
                            fit1C$coefficients, <span class="kw">concord</span>(fit1C)[<span class="dv">1</span>],
                            fit2C$coefficients, <span class="kw">concord</span>(fit2C)[<span class="dv">1</span>],
                            wilcoxC /<span class="st"> </span>(<span class="kw">length</span>(dataC$x[dataC$x ==<span class="st"> </span><span class="dv">0</span>]) *<span class="st"> </span>
<span class="st">                                         </span><span class="kw">length</span>(dataC$x[dataC$x ==<span class="st"> </span><span class="dv">1</span>])),
                            <span class="ot">NA</span>)

        ### data with administrative censoring 1 (data1), type 3
        data1 &lt;-<span class="st"> </span>data
        data1$event[data$time &gt;<span class="st"> </span>admincens[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="dv">0</span>
        data1$time[data$time &gt;<span class="st"> </span>admincens[<span class="dv">1</span>]] &lt;-<span class="st"> </span>admincens[<span class="dv">1</span>]
        cens1 &lt;-<span class="st"> </span><span class="kw">sum</span>(data1$event ==<span class="st"> </span><span class="dv">0</span>) /<span class="st"> </span>n *<span class="st"> </span><span class="dv">100</span>

        fit11 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> data1)
        fit21 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> data1)
        fit11zph &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(<span class="dt">fit =</span> fit11, <span class="dt">transform =</span> <span class="st">&quot;km&quot;</span>)

        eg1 &lt;-<span class="st"> </span>eg[!(eg[,<span class="dv">1</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">1</span>] &amp;<span class="st"> </span>eg[,<span class="dv">2</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">1</span>]),]
        wilcox1 &lt;-<span class="st"> </span><span class="kw">wilcox.test</span>(time ~<span class="st"> </span>x, <span class="dt">data =</span> data1, <span class="dt">correct =</span> <span class="ot">FALSE</span>)$statistic
        olist$out1[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(cens1,
                            fit11$coefficients, <span class="kw">concord</span>(fit11)[<span class="dv">1</span>],
                            fit21$coefficients, <span class="kw">concord</span>(fit21)[<span class="dv">1</span>],
                            wilcox1 /<span class="st"> </span>(n1 *<span class="st"> </span>n2),
                            <span class="dv">1</span> -<span class="st"> </span>((<span class="kw">sum</span>(eg1[,<span class="dv">1</span>] &lt;<span class="st"> </span>eg1[,<span class="dv">2</span>]) +<span class="st"> </span><span class="kw">sum</span>(eg[,<span class="dv">1</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">1</span>] &amp;
<span class="st">                                  </span>eg[,<span class="dv">2</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">1</span>]) /<span class="st"> </span><span class="dv">2</span>) /<span class="st"> </span><span class="kw">nrow</span>(eg)))

        ### data1 with censoring (datacens1), type 4
        dataC1 &lt;-<span class="st"> </span>data1
        dataC1$time[data1$time &gt;<span class="st"> </span>timecens] &lt;-<span class="st"> </span>timecens[data1$time &gt;<span class="st"> </span>timecens]
        dataC1$event[data1$time &gt;<span class="st"> </span>timecens] &lt;-<span class="st"> </span><span class="dv">0</span>
        censC1 &lt;-<span class="st"> </span><span class="kw">sum</span>(dataC1$event ==<span class="st"> </span><span class="dv">0</span>) /<span class="st"> </span>n *<span class="st"> </span><span class="dv">100</span>

        fit1C1 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> dataC1)
        fit2C1 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> dataC1)

        wilcoxC1 &lt;-<span class="st"> </span><span class="kw">wilcox.test</span>(time ~<span class="st"> </span>x, <span class="dt">data =</span> dataC1, <span class="dt">correct =</span> <span class="ot">FALSE</span>)$statistic
        egC1 &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(dataC1$event[dataC1$x ==<span class="st"> </span><span class="dv">0</span>], dataC1$event[dataC1$x ==<span class="st"> </span><span class="dv">1</span>])
        olist$outC1[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(censC1,
                             fit1C1$coefficients, <span class="kw">concord</span>(fit1C1)[<span class="dv">1</span>],
                             fit2C1$coefficients, <span class="kw">concord</span>(fit2C1)[<span class="dv">1</span>],
                             wilcoxC1 /<span class="st"> </span>(<span class="kw">length</span>(dataC1$x[dataC1$x ==<span class="st"> </span><span class="dv">0</span>]) *
<span class="st">                                   </span><span class="kw">length</span>(dataC1$x[dataC1$x ==<span class="st"> </span><span class="dv">1</span>])),
                             <span class="ot">NA</span>)

        ### data with administrative censoring 2 (data2), type 5
        data2 &lt;-<span class="st"> </span>data
        data2$event[data$time &gt;<span class="st"> </span>admincens[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="dv">0</span>
        data2$time[data$time &gt;<span class="st"> </span>admincens[<span class="dv">2</span>]] &lt;-<span class="st"> </span>admincens[<span class="dv">2</span>]
        cens2 &lt;-<span class="st"> </span><span class="kw">sum</span>(data2$event ==<span class="st"> </span><span class="dv">0</span>) /<span class="st"> </span>n *<span class="st"> </span><span class="dv">100</span>

        fit12 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> data2)
        fit22 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> data2)
        fit12zph &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(<span class="dt">fit =</span> fit12, <span class="dt">transform =</span> <span class="st">&quot;km&quot;</span>)

        eg2 &lt;-<span class="st"> </span>eg[!(eg[,<span class="dv">1</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">2</span>] &amp;<span class="st"> </span>eg[,<span class="dv">2</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">2</span>]),]
        wilcox2 &lt;-<span class="st"> </span><span class="kw">wilcox.test</span>(time ~<span class="st"> </span>x, <span class="dt">data =</span> data2, <span class="dt">correct =</span> <span class="ot">FALSE</span>)$statistic
        olist$out2[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(cens2,
                            fit12$coefficients, <span class="kw">concord</span>(fit12)[<span class="dv">1</span>],
                            fit22$coefficients, <span class="kw">concord</span>(fit22)[<span class="dv">1</span>],
                            wilcox2 /<span class="st"> </span>(n1 *<span class="st"> </span>n2),
                            <span class="dv">1</span> -<span class="st"> </span>((<span class="kw">sum</span>(eg2[,<span class="dv">1</span>] &lt;<span class="st"> </span>eg2[,<span class="dv">2</span>]) +<span class="st"> </span><span class="kw">sum</span>(eg[,<span class="dv">1</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">2</span>] &amp;
<span class="st">                                   </span>eg[,<span class="dv">2</span>] &gt;=<span class="st"> </span>admincens[<span class="dv">2</span>]) /<span class="st"> </span><span class="dv">2</span>) /<span class="st"> </span><span class="kw">nrow</span>(eg)))

        ### data2 with censoring (datacens2), type 6
        dataC2 &lt;-<span class="st"> </span>data2
        dataC2$time[data2$time &gt;<span class="st"> </span>timecens] &lt;-<span class="st"> </span>timecens[data2$time &gt;<span class="st"> </span>timecens]
        dataC2$event[data2$time &gt;<span class="st"> </span>timecens] &lt;-<span class="st"> </span><span class="dv">0</span>
        censC2 &lt;-<span class="st"> </span><span class="kw">sum</span>(dataC2$event ==<span class="st"> </span><span class="dv">0</span>) /<span class="st"> </span>n *<span class="st"> </span><span class="dv">100</span>

        fit1C2 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> dataC2)
        fit2C2 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(time, event) ~<span class="st"> </span>x, <span class="dt">data =</span> dataC2)

        wilcoxC2 &lt;-<span class="st"> </span><span class="kw">wilcox.test</span>(time ~<span class="st"> </span>x, <span class="dt">data =</span> dataC2, <span class="dt">correct =</span> <span class="ot">FALSE</span>)$statistic
        egC2 &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(dataC2$event[dataC2$x ==<span class="st"> </span><span class="dv">0</span>], dataC2$event[dataC2$x ==<span class="st"> </span><span class="dv">1</span>])
        olist$outC2[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(censC2,
                             fit1C2$coefficients, <span class="kw">concord</span>(fit1C2)[<span class="dv">1</span>],
                             fit2C2$coefficients, <span class="kw">concord</span>(fit2C2)[<span class="dv">1</span>],
                             wilcoxC2 /<span class="st"> </span>(<span class="kw">length</span>(dataC2$x[dataC2$x ==<span class="st"> </span><span class="dv">0</span>]) *
<span class="st">                                           </span><span class="kw">length</span>(dataC2$x[dataC2$x ==<span class="st"> </span><span class="dv">1</span>])),
                             <span class="ot">NA</span>)
      }

      results &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> <span class="dv">6</span>, <span class="dt">ncol =</span> <span class="dv">7</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Loss-to-fup&quot;</span>, 
          <span class="st">&quot;Admin. 1&quot;</span>, <span class="st">&quot;Loss-to-fup &amp; admin. 1&quot;</span>, <span class="st">&quot;Admin. 2&quot;</span>, <span class="st">&quot;Loss-to-fup &amp; admin. 2&quot;</span>),
          <span class="kw">colnames</span>(olist$out)))
      
      for (j in <span class="dv">1</span>:<span class="dv">6</span>) {
        olist[[j]][, <span class="kw">c</span>(<span class="st">&quot;cox_c100&quot;</span>, <span class="st">&quot;wcox_c100&quot;</span>, <span class="st">&quot;wilcox100&quot;</span>, <span class="st">&quot;prt0st1&quot;</span>)] &lt;-
<span class="st">          </span>olist[[j]][, <span class="kw">c</span>(<span class="st">&quot;cox_c100&quot;</span>, <span class="st">&quot;wcox_c100&quot;</span>, <span class="st">&quot;wilcox100&quot;</span>, <span class="st">&quot;prt0st1&quot;</span>)] *<span class="st"> </span><span class="dv">100</span>

        r1 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">apply</span>(olist[[j]], <span class="dv">2</span>, mean), <span class="dv">3</span>)
        r2 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">apply</span>(olist[[j]], <span class="dv">2</span>, sd) /<span class="st"> </span><span class="kw">sqrt</span>(sim), <span class="dv">3</span>)

        results[j,] &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">paste</span>(r1, <span class="st">&quot; (&quot;</span>, r2, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))
      }

      output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">results =</span> results, <span class="dt">olist =</span> olist, <span class="dt">popc100 =</span> popc100)
    }

    <span class="kw">invisible</span>(output)
  }

## if (pdfind) { pdf(&quot;simph.pdf&quot;, width = 5, height = 5) }
## sim1 &lt;- simulation(n1 = 1000, n2 = 1000, sim = 2000, seed = 3460, type = &quot;ph&quot;,
##                   scalewei = 0.11, shapewei = 1.22, scaleexpC =0.06029,
##                   beta = log(0.55/(1-0.55)), admincens = c(11.21083, 9.549136),
##                   npop = 10000, xmaxplot = 23, addconstant = 1e-4)
## if (pdfind) { dev.off() }
## sim1$results[, 1:6]
## round(sim1$popc100[1], 2)        # true population-c * 100
## 
## 
## if (pdfind) { pdf(&quot;simnph.pdf&quot;, width = 5, height = 5) }
## sim2 &lt;- simulation(n1 = 1000, n2 = 1000, sim = 2000, seed = 3458, type =&quot;nph3&quot;,
##                    scaleexp = 0.35653, shapegom = 1.6, scalegom = 0.0228,
##                    scaleexpC = 0.122, admincens = c(4.506223, 3.535000), 
##                    npop = 10000,  xmaxplot = 6)
## if (pdfind) { dev.off() } 
## sim2$results[, 1:6]
## round(sim2$popc[1], 2)          # true population-c * 100</code></pre></div>
</div>
<div id="section-6.1-gastric-cancer-study" class="section level2">
<h2>Section 6.1: Gastric cancer study</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### prepare Table 1
models &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Ignoring non-proportional hazards *&quot;</span>, <span class="st">&quot;HR Cox regression&quot;</span>, 
            <span class="st">&quot;Estimating piecewise constant HRs *&quot;</span>, <span class="st">&quot;HR 1st year&quot;</span>, <span class="st">&quot;HR &gt;1st year&quot;</span>, 
            <span class="st">&quot;Including a time-by-covariate interaction&quot;</span>, <span class="st">&quot;HR at 0.5 years&quot;</span>, <span class="st">&quot;HR at 1 year&quot;</span>, 
            <span class="st">&quot;HR at 2 years&quot;</span>, <span class="st">&quot;Weighted Cox regression&quot;</span>, <span class="st">&quot;average HR&quot;</span>, <span class="st">&quot;c'%&quot;</span>)
Table1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> <span class="kw">length</span>(models), <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(models, 
                     <span class="kw">c</span>(<span class="st">&quot;HR&quot;</span>, <span class="st">&quot;HRlower&quot;</span>, <span class="st">&quot;HRupper&quot;</span>, <span class="st">&quot;p&quot;</span>))))


## ignore non-proportional hazards and apply a Cox proportional hazards model
gfit2 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation, <span class="dt">data =</span> gastric, <span class="dt">template =</span> <span class="st">&quot;PH&quot;</span>,
                <span class="dt">robust =</span> <span class="ot">TRUE</span>) 

<span class="co"># or equivalently</span>
<span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> gastric, <span class="dt">x =</span> <span class="ot">TRUE</span>, 
      <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>) </code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + cluster(id), 
##     data = gastric, x = TRUE, method = &quot;breslow&quot;)
## 
##            coef exp(coef) se(coef) robust se    z    p
## radiation 0.141     1.152    0.226     0.229 0.62 0.54
## 
## Likelihood ratio test=0.39  on 1 df, p=0.532
## n= 90, number of events= 79</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># extract estimates for Table 1: HR, 95% CI, p-value</span>
Table1[<span class="st">&quot;HR Cox regression&quot;</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">exp</span>(gfit2$coeff), 
                                   <span class="kw">exp</span>(<span class="kw">confint</span>(gfit2)), 
                                   <span class="kw">summary</span>(gfit2)$prob)</code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastric, 
##     template = &quot;PH&quot;, robust = TRUE)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##               coef  se(coef) exp(coef) lower 0.95 upper 0.95         z
## radiation 0.141495 0.2292141  1.151995  0.7350944   1.805335 0.6173052
##                   p
## radiation 0.5370334
## 
## Wald Chi-square = 0.3810657 on 1  df, p = 0.5370334
## 
## Covariance-Matrix:
##            radiation
## radiation 0.05253909
## 
## Generalized concordance probability:   Estimates may be biased!
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.5353     0.4237     0.6435</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### estimating piecewise constant hazard ratios (by two separate Cox models)
### (two time periods with equal number of events)

<span class="kw">table</span>(gastric$status)</code></pre></div>
<pre><code>## 
##  0  1 
## 11 79</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#79/2</span>
<span class="kw">nrow</span>(<span class="kw">subset</span>(gastric, status ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>yrs &lt;<span class="st"> </span><span class="dv">1</span>))          <span class="co"># breakpoint = 1 year</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## first time period
gastricp1 &lt;-<span class="st"> </span>gastric
gastricp1$status[gastricp1$yrs &gt;<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
gastricp1$yrs[gastricp1$yrs &gt;<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>


<span class="kw">nrow</span>(gastricp1)</code></pre></div>
<pre><code>## [1] 90</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gtable0 &lt;-<span class="st"> </span><span class="kw">table</span>(gastricp1$status, <span class="dt">deparse.level =</span> <span class="dv">2</span>)
gtable0</code></pre></div>
<pre><code>## gastricp1$status
##  0  1 
## 51 39</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(gtable0) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## gastricp1$status
##     0     1 
## 56.67 43.33</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gtable1 &lt;-<span class="st"> </span><span class="kw">table</span>(gastricp1$radiation, gastricp1$status, <span class="dt">deparse.level =</span> <span class="dv">2</span>) 
<span class="kw">addmargins</span>(gtable1)</code></pre></div>
<pre><code>##                    gastricp1$status
## gastricp1$radiation  0  1 Sum
##                 0   31 14  45
##                 1   20 25  45
##                 Sum 51 39  90</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(gtable1, <span class="dt">margin =</span> <span class="dv">1</span>) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>##                    gastricp1$status
## gastricp1$radiation     0     1
##                   0 68.89 31.11
##                   1 44.44 55.56</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gfit3 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> gastricp1, 
               <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>) 
gfit3.ph &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(<span class="dt">fit =</span> gfit3, <span class="dt">transform =</span> <span class="st">&quot;km&quot;</span>) 
gfit3.ph$table</code></pre></div>
<pre><code>##                 rho    chisq         p
## radiation -0.275521 2.652014 0.1034188</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## plot of scaled Schoenfeld residuals in the first time period
<span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
<span class="kw">plotcoxzph</span>(<span class="dt">x =</span> gfit3.ph, <span class="dt">wd =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>) 
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;time (years, KM-transformation)&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(beta, <span class="st">&quot;(t) for radiation&quot;</span>)), <span class="dt">cex =</span> <span class="dv">1</span>)   
<span class="kw">abline</span>(<span class="kw">lm</span>(gfit3.ph$y ~<span class="st"> </span>gfit3.ph$x)$coefficients, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)  </code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## plot of cumulative survival probabilities
## gsurv2 &lt;- survfit(Surv(yrs, status) ~ radiation, data = gastricp1)   
## par(oma = c(2, 2, 0.5, 0.5), mar = c(2, 2, 0, 0))
## plot(gsurv2, lty = 1:2, las = 1, lwd = 2)
## mtext(side = 1, line = 2.5, text = &quot;time (years)&quot;)
## mtext(side = 2, line = 3, text = &quot;survival distribution function&quot;)
## legend(&quot;bottomleft&quot;, title = &quot;radiation&quot;, legend = c(&quot;yes&quot;, &quot;no&quot;), 
##        lty = 2:1, inset = 0.02, bty = &quot;n&quot;, cex = 1.2)



## Cox proportional hazards model for the first time period
gfit4 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation, <span class="dt">data =</span> gastricp1, <span class="dt">template =</span> <span class="st">&quot;PH&quot;</span>)
<span class="kw">summary</span>(gfit4)</code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastricp1, 
##     template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                coef se(coef) exp(coef) lower 0.95 upper 0.95        z
## radiation 0.8774141 0.325826  2.404673   1.269733    4.55407 2.692892
##                     p
## radiation 0.007083531
## 
## Wald Chi-square = 7.251665 on 1  df, p = 0.007083531
## 
## Covariance-Matrix:
##           radiation
## radiation 0.1061626
## 
## Generalized concordance probability:   Estimates may be biased!
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.7063     0.5594       0.82</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Table1[<span class="st">&quot;HR 1st year&quot;</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">exp</span>(gfit4$coeff), 
                             <span class="kw">exp</span>(<span class="kw">confint</span>(gfit4)), 
                             <span class="kw">summary</span>(gfit4, <span class="dt">print =</span> <span class="ot">FALSE</span>)$prob)

<span class="co"># or equivalently</span>
<span class="co"># coxph(Surv(yrs, status) ~ radiation + cluster(id), data = gastricp1, method = &quot;breslow&quot;) </span>




## second time period
gastricp2 &lt;-<span class="st"> </span><span class="kw">subset</span>(gastric, yrs &gt;<span class="st"> </span><span class="dv">1</span>)


<span class="kw">nrow</span>(gastricp2)</code></pre></div>
<pre><code>## [1] 51</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gtable0 &lt;-<span class="st"> </span><span class="kw">table</span>(gastricp2$status, <span class="dt">deparse.level =</span> <span class="dv">2</span>)
gtable0</code></pre></div>
<pre><code>## gastricp2$status
##  0  1 
## 11 40</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(gtable0) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## gastricp2$status
##     0     1 
## 21.57 78.43</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gtable1 &lt;-<span class="st"> </span><span class="kw">table</span>(gastricp2$radiation, gastricp2$status, <span class="dt">deparse.level =</span> <span class="dv">2</span>) 
<span class="kw">addmargins</span>(gtable1)</code></pre></div>
<pre><code>##                    gastricp2$status
## gastricp2$radiation  0  1 Sum
##                 0    3 28  31
##                 1    8 12  20
##                 Sum 11 40  51</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(gtable1, <span class="dt">margin =</span> <span class="dv">1</span>) *<span class="st"> </span><span class="dv">100</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>##                    gastricp2$status
## gastricp2$radiation     0     1
##                   0  9.68 90.32
##                   1 40.00 60.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gfit5 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> gastricp2, <span class="dt">x =</span> <span class="ot">TRUE</span>, 
               <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>) 
gfit5.ph &lt;-<span class="st"> </span><span class="kw">cox.zph</span>(<span class="dt">fit =</span> gfit5, <span class="dt">transform =</span> <span class="st">&quot;km&quot;</span>) 
gfit5.ph$table</code></pre></div>
<pre><code>##                  rho     chisq         p
## radiation -0.1203536 0.5816761 0.4456561</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot of scaled Schoenfeld residuals for the second time period</span>
<span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
<span class="kw">plotcoxzph</span>(<span class="dt">x =</span> gfit5.ph, <span class="dt">wd =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>) 
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;time (years, KM-transformation)&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(beta, <span class="st">&quot;(t) for radiation&quot;</span>)), <span class="dt">cex =</span> <span class="dv">1</span>)   
<span class="kw">abline</span>(<span class="kw">lm</span>(gfit5.ph$y ~<span class="st"> </span>gfit5.ph$x)$coefficients, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)  </code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## plot of cumulative survival probabilities
## gsurv3 &lt;- survfit(Surv(yrs, status) ~ radiation, data = gastricp2)   
## par(oma = c(2, 2, 0.5, 0.5), mar = c(2, 2, 0, 0))
## plot(gsurv3, lty = 1:2, las = 1, lwd = 2, xlim=c(1,5))
## mtext(side = 1, line = 2.5, text = &quot;time (years)&quot;)
## mtext(side = 2, line = 3, text = &quot;survival distribution function&quot;)
## legend(&quot;bottomleft&quot;, title = &quot;radiation&quot;, legend = c(&quot;yes&quot;, &quot;no&quot;), 
##        lty = 2:1, inset = 0.02, bty = &quot;n&quot;, cex = 1.2)



## Cox proportional hazards model for the second time period
gfit6 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation, <span class="dt">data =</span> gastricp2, <span class="dt">template =</span> <span class="st">&quot;PH&quot;</span>)
<span class="kw">summary</span>(gfit6)</code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastricp2, 
##     template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                 coef  se(coef) exp(coef) lower 0.95 upper 0.95         z
## radiation -0.6051688 0.3471071 0.5459823  0.2765161   1.078044 -1.743464
##                    p
## radiation 0.08125255
## 
## Wald Chi-square = 3.039668 on 1  df, p = 0.08125255
## 
## Covariance-Matrix:
##           radiation
## radiation 0.1204833
## 
## Generalized concordance probability:   Estimates may be biased!
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.3532     0.2166     0.5188</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Table1[<span class="st">&quot;HR &gt;1st year&quot;</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">exp</span>(gfit6$coeff), 
                              <span class="kw">exp</span>(<span class="kw">confint</span>(gfit6)), 
                              <span class="kw">summary</span>(gfit6, <span class="dt">print =</span> <span class="ot">FALSE</span>)$prob)

<span class="co"># or equivalently</span>
<span class="co"># coxph(Surv(yrs, status) ~ radiation + cluster(id), data = gastricp2, method = &quot;breslow&quot;) </span>


### including a time-by-covariate interaction
fun &lt;-<span class="st"> </span>function(t) { (t &gt;<span class="st"> </span><span class="dv">1</span>) *<span class="st"> </span><span class="dv">1</span> }

gfit7 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">fun</span>(yrs):radiation, <span class="dt">data =</span> gastric, <span class="dt">template =</span> <span class="st">&quot;PH&quot;</span>)
<span class="kw">summary</span>(gfit7)</code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation + fun(yrs):radiation, 
##     data = gastric, template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                          coef  se(coef) exp(coef) lower 0.95 upper 0.95
## radiation           0.8774141 0.3258260 2.4046734 1.26973327  4.5540699
## fun(yrs):radiation -1.4825829 0.4758515 0.2270505 0.08934636  0.5769896
##                            z           p
## radiation           2.692892 0.007083531
## fun(yrs):radiation -3.115642 0.001835452
## 
## Wald Chi-square = 10.30011 on 2  df, p = 0.005799087
## 
## Covariance-Matrix:
##                     radiation fun(yrs):radiation
## radiation           0.1061626         -0.1060570
## fun(yrs):radiation -0.1060570          0.2264347
## 
## Generalized concordance probability:   Estimates may be biased!
##                    concordance prob. lower 0.95 upper 0.95
## radiation                     0.7063     0.5594     0.8200
## fun(yrs):radiation            0.1850     0.0820     0.3659</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 2.4046734 * 0.2270505 </span>
<span class="co"># exp(0.8774141 - 1.4825829)</span>

<span class="co"># or equivalently</span>
<span class="kw">summary</span>(<span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">tt</span>(radiation) +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> gastric, 
              <span class="dt">tt =</span> function(x, t, ...) x *<span class="st"> </span>(t &gt;<span class="st"> </span><span class="dv">1</span>), <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>))</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + tt(radiation) + 
##     cluster(id), data = gastric, tt = function(x, t, ...) x * 
##     (t &gt; 1), method = &quot;breslow&quot;)
## 
##   n= 90, number of events= 79 
## 
##                  coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)   
## radiation      0.8774    2.4047   0.3351    0.3258  2.693  0.00708 **
## tt(radiation) -1.4826    0.2271   0.4816    0.4759 -3.116  0.00184 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
##               exp(coef) exp(-coef) lower .95 upper .95
## radiation        2.4047     0.4159   1.26973     4.554
## tt(radiation)    0.2271     4.4043   0.08935     0.577
## 
## Concordance= 0.6  (se = 0.248 )
## Rsquare= 0.11   (max possible= 0.999 )
## Likelihood ratio test= 10.49  on 2 df,   p=0.005265
## Wald test            = 10.3  on 2 df,   p=0.005799
## Score (logrank) test = 10.45  on 2 df,   p=0.005383,   Robust = 10.73  p=0.004683
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### extended Cox model - assume a linear time-dependent effect
fit1 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span>yrs:radiation, <span class="dt">data =</span> gastric, <span class="dt">template =</span> <span class="st">&quot;PH&quot;</span>)
<span class="kw">summary</span>(fit1)</code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation + yrs:radiation, 
##     data = gastric, template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                     coef  se(coef) exp(coef) lower 0.95 upper 0.95
## radiation      1.2699606 0.4334889 3.5607124  1.5224762  8.3276657
## yrs:radiation -0.9652886 0.3409321 0.3808733  0.1952444  0.7429892
##                       z           p
## radiation      2.929627 0.003393692
## yrs:radiation -2.831322 0.004635608
## 
## Wald Chi-square = 9.047941 on 2  df, p = 0.01084588
## 
## Covariance-Matrix:
##                radiation yrs:radiation
## radiation      0.1879126    -0.1241715
## yrs:radiation -0.1241715     0.1162347
## 
## Generalized concordance probability:   Estimates may be biased!
##               concordance prob. lower 0.95 upper 0.95
## radiation                0.7807     0.6036     0.8928
## yrs:radiation            0.2758     0.1634     0.4263</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## or equivalently
<span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">tt</span>(radiation) +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">tt =</span> function(x,t, ...) x *<span class="st"> </span>t, 
     <span class="dt">data =</span> gastric, <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + tt(radiation) + 
##     cluster(id), data = gastric, tt = function(x, t, ...) x * 
##     t, method = &quot;breslow&quot;)
## 
##                 coef exp(coef) se(coef) robust se     z      p
## radiation      1.270     3.561    0.419     0.433  2.93 0.0034
## tt(radiation) -0.965     0.381    0.318     0.341 -2.83 0.0046
## 
## Likelihood ratio test=13.5  on 2 df, p=0.00119
## n= 90, number of events= 79</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## extract HR at 0.5, 1 and 2 years
fit1est &lt;-<span class="st"> </span><span class="kw">predict</span>(fit1, <span class="dt">type =</span> <span class="st">&quot;slice.time&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;yrs&quot;</span>, <span class="dt">z =</span> <span class="st">&quot;radiation&quot;</span>, <span class="dt">newx =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>), 
                   <span class="dt">exp =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>, <span class="dt">pval =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##   yrs     HR HR lower 0.95 HR upper 0.95      p
## 1 0.5 2.1975        1.2096        3.9924 0.0098
## 2 1.0 1.3562        0.8536        2.1547 0.1971
## 3 2.0 0.5165        0.2381        1.1207 0.0946</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Table1[<span class="kw">c</span>(<span class="st">&quot;HR at 0.5 years&quot;</span>, <span class="st">&quot;HR at 1 year&quot;</span>, 
         <span class="st">&quot;HR at 2 years&quot;</span>), ] &lt;-<span class="st"> </span><span class="kw">cbind</span>(fit1est$estimates[, <span class="st">&quot;HR&quot;</span>], 
                                      fit1est$estimates[, <span class="st">&quot;HR lower 0.95&quot;</span>],
                                      fit1est$estimates[, <span class="st">&quot;HR upper 0.95&quot;</span>],
                                      fit1est$estimates[, <span class="st">&quot;p&quot;</span>])


## visualize the estimated linear time-dependent effect
fit1est2 &lt;-<span class="st"> </span><span class="kw">predict</span>(fit1, <span class="dt">type =</span> <span class="st">&quot;slice.time&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;yrs&quot;</span>, <span class="dt">z =</span> <span class="st">&quot;radiation&quot;</span>, 
                    <span class="dt">newx =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.1</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))

if (pdfind) { <span class="kw">pdf</span>(<span class="st">&quot;figure3.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">7</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plot</span>(fit1est2, <span class="dt">addci =</span> <span class="ot">TRUE</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;time (yrs)&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.3</span>, <span class="dt">text =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">hat</span>(beta), <span class="st">&quot;(t) for radiation&quot;</span>)), 
        <span class="dt">cex =</span> <span class="fl">1.3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) { <span class="kw">dev.off</span>() }


### extended Cox model - assume a log-linear time-dependent effect
gfit8 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">log</span>(yrs):radiation, <span class="dt">data =</span> gastric, 
                <span class="dt">template =</span> <span class="st">&quot;PH&quot;</span>)
<span class="kw">summary</span>(gfit8)</code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation + log(yrs):radiation, 
##     data = gastric, template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                           coef  se(coef) exp(coef) lower 0.95 upper 0.95
## radiation           0.03766302 0.2367992 1.0383813  0.6528193   1.651660
## log(yrs):radiation -0.66924556 0.4821178 0.5120948  0.1990540   1.317437
##                             z         p
## radiation           0.1590504 0.8736291
## log(yrs):radiation -1.3881370 0.1650953
## 
## Wald Chi-square = 1.97312 on 2  df, p = 0.372857
## 
## Covariance-Matrix:
##                      radiation log(yrs):radiation
## radiation          0.056073853        0.004581723
## log(yrs):radiation 0.004581723        0.232437577
## 
## Generalized concordance probability:   Estimates may be biased!
##                    concordance prob. lower 0.95 upper 0.95
## radiation                     0.5094      0.395     0.6229
## log(yrs):radiation            0.3387      0.166     0.5685</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## or equivalently
<span class="kw">coxph</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation +<span class="st"> </span><span class="kw">tt</span>(radiation) +<span class="st"> </span><span class="kw">cluster</span>(id), 
     <span class="dt">tt =</span> function(x, t, ...) x *<span class="st"> </span><span class="kw">log</span>(t), <span class="dt">data =</span> gastric, <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + tt(radiation) + 
##     cluster(id), data = gastric, tt = function(x, t, ...) x * 
##     log(t), method = &quot;breslow&quot;)
## 
##                  coef exp(coef) se(coef) robust se     z    p
## radiation      0.0377    1.0384   0.2396    0.2368  0.16 0.87
## tt(radiation) -0.6692    0.5121   0.2730    0.4821 -1.39 0.17
## 
## Likelihood ratio test=8.02  on 2 df, p=0.0181
## n= 90, number of events= 79</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## visualize and compare the linear and the log-linear time-dependent effects
## (superimpose the LOWESS of the scaled Schoenfeld residuals)
## plotx &lt;- seq(from = quantile(gastric$yrs, probs = 0.05), 
##              to = quantile(gastric$yrs, probs = 0.95), length = 100)
## y1 &lt;- predict(fit1, type = &quot;slice.time&quot;, x = &quot;yrs&quot;, z = &quot;radiation&quot;, newx = plotx)
## y8 &lt;- predict(gfit8, type = &quot;slice.time&quot;, x = &quot;yrs&quot;, z = &quot;radiation&quot;, newx = plotx)
##
## if (pdfind) { pdf(&quot;figure6.pdf&quot;, width = 7, height = 5) }
##   par(oma = c(2, 2, 0.5, 0.5), mar=c(2, 2, 0, 0))
##   plotcoxzph(x = gfit1.ph2, se = FALSE, wd = 2, xlim = c(0, 3), las = 1, lty = 3)
##   mtext(side = 1, line = 2.5, text = &quot;time (yrs)&quot;, cex = 1.3)
##   mtext(side = 2, line = 2.5, text = expression(paste(hat(beta), &quot;(t) for radiation&quot;)), 
##         cex = 1.3)
##   abline(a = 0, b = 0, lty = 3) 
##   lines(x = plotx, y = y1$estimates[, &quot;coef&quot;], col = &quot;red&quot;, lty = 1, lwd = 2)
##   lines(x = plotx, y = y8$estimates[, &quot;coef&quot;], col = &quot;blue&quot;, lty = 2, lwd = 2)
##   legend(x = 1.7, y = 1.6, title = &quot;time-dependent effect&quot;, title.col = &quot;black&quot;, 
##         legend = c(&quot;LOWESS&quot;, &quot;linear&quot;, &quot;log-linear&quot;), col = c(&quot;black&quot;, &quot;red&quot;, &quot;blue&quot;), 
##         lty = c(3, 1:2), bty = &quot;n&quot;, lwd = 2, text.col = c(&quot;black&quot;, &quot;red&quot;, &quot;blue&quot;), 
##         cex = 1.1)
## if (pdfind) { dev.off() }



## weighted Cox regression with truncation of weights
gfit9 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(yrs, status) ~<span class="st"> </span>radiation, <span class="dt">data =</span> gastric, <span class="dt">template =</span> <span class="st">&quot;AHR&quot;</span>, 
                  <span class="dt">trunc.weights =</span> <span class="fl">0.95</span>)
<span class="kw">summary</span>(gfit9)</code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastric, 
##     template = &quot;AHR&quot;, trunc.weights = 0.95)
## 
## Model fitted by weighted estimation (AHR template) 
## 
##                coef  se(coef) exp(coef) lower 0.95 upper 0.95        z
## radiation 0.4622282 0.2384041  1.587608  0.9949774   2.533221 1.938843
##                    p
## radiation 0.05252042
## 
## Wald Chi-square = 3.759113 on 1  df, p = 0.05252042
## 
## Covariance-Matrix:
##            radiation
## radiation 0.05683651
## 
## Generalized concordance probability:
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.6135     0.4987      0.717</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) { <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure4.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plot</span>(<span class="dt">x =</span> gfit9, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) 
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;time (years)&quot;</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;weight&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) { <span class="kw">dev.off</span>() }


<span class="co"># range of normalized totatl weights</span>
<span class="kw">range</span>(gfit9$w.matrix[, <span class="st">&quot;w&quot;</span>])</code></pre></div>
<pre><code>## [1] 0.3134808 1.6534706</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Table1[<span class="st">&quot;average HR&quot;</span>, ] &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">exp</span>(gfit9$coeff), 
                                         <span class="kw">exp</span>(<span class="kw">confint</span>(gfit9)), 
                                         <span class="kw">summary</span>(gfit9, <span class="dt">print =</span> <span class="ot">FALSE</span>)$prob)
Table1[<span class="st">&quot;c'%&quot;</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">as.vector</span>(<span class="kw">concord</span>(gfit9)), <span class="kw">summary</span>(gfit9, <span class="dt">print =</span> <span class="ot">FALSE</span>)$prob)


### finish Table 1
Table1[<span class="st">&quot;c'%&quot;</span>, <span class="dv">1</span>:<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">100</span> *<span class="st"> </span>Table1[<span class="st">&quot;c'%&quot;</span>, <span class="dv">1</span>:<span class="dv">3</span>]
Table1 &lt;-<span class="st"> </span><span class="kw">round</span>(Table1, <span class="dt">digits =</span> <span class="dv">3</span>)

Table1[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(Table1[, <span class="dv">1</span>], <span class="st">&quot; (&quot;</span>, Table1[, <span class="dv">2</span>], <span class="st">&quot;-&quot;</span>, Table1[, <span class="dv">3</span>], <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
Table1[, <span class="dv">2</span>] &lt;-<span class="st"> </span>Table1[, <span class="dv">4</span>]
Table1 &lt;-<span class="st"> </span>Table1[, <span class="dv">1</span>:<span class="dv">2</span>]
<span class="kw">dimnames</span>(Table1)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Estimate (95% CI)&quot;</span>, <span class="st">&quot;p&quot;</span>)
Table1</code></pre></div>
<pre><code>##                                             Estimate (95% CI)     p
## Ignoring non-proportional hazards *                NA (NA-NA)    NA
## HR Cox regression                         1.152 (0.735-1.805) 0.537
## Estimating piecewise constant HRs *                NA (NA-NA)    NA
## HR 1st year                                2.405 (1.27-4.554) 0.007
## HR &gt;1st year                              0.546 (0.277-1.078) 0.081
## Including a time-by-covariate interaction          NA (NA-NA)    NA
## HR at 0.5 years                            2.197 (1.21-3.992) 0.010
## HR at 1 year                              1.356 (0.854-2.155) 0.197
## HR at 2 years                             0.517 (0.238-1.121) 0.095
## Weighted Cox regression                            NA (NA-NA)    NA
## average HR                                1.588 (0.995-2.533) 0.053
## c'%                                        61.35 (49.87-71.7) 0.053</code></pre>
</div>
<div id="section-6.2-biofeedback-therapy-study" class="section level2">
<h2>Section 6.2: Biofeedback therapy study</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### ignore non-proportional hazards and apply a Cox model
### (use breslow weights to make it directly comparable to coxphw)
bfit2 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span>bfb +<span class="st"> </span>log2heal, <span class="dt">data =</span> biofeedback, <span class="dt">template =</span> <span class="st">&quot;PH&quot;</span>)
<span class="kw">summary</span>(bfit2)</code></pre></div>
<pre><code>## coxphw(formula = Surv(thdur, success) ~ bfb + log2heal, data = biofeedback, 
##     template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                coef  se(coef) exp(coef) lower 0.95 upper 0.95          z
## bfb       0.2699762 0.3453073 1.3099332  0.6657683   2.577361  0.7818433
## log2heal -0.5266649 0.3636448 0.5905713  0.2895592   1.204502 -1.4482949
##                  p
## bfb      0.4343067
## log2heal 0.1475346
## 
## Wald Chi-square = 2.657646 on 2  df, p = 0.2647887
## 
## Covariance-Matrix:
##                   bfb     log2heal
## bfb       0.119237110 -0.002917929
## log2heal -0.002917929  0.132237551
## 
## Generalized concordance probability:   Estimates may be biased!
##          concordance prob. lower 0.95 upper 0.95
## bfb                 0.5671     0.3997     0.7205
## log2heal            0.3713     0.2245     0.5464</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># or equivalently </span>
<span class="kw">coxph</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span>bfb +<span class="st"> </span>log2heal +<span class="st"> </span><span class="kw">cluster</span>(id), <span class="dt">data =</span> biofeedback, 
      <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>) </code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ bfb + log2heal + cluster(id), 
##     data = biofeedback, x = TRUE, method = &quot;breslow&quot;)
## 
##            coef exp(coef) se(coef) robust se     z    p
## bfb       0.270     1.310    0.427     0.345  0.78 0.43
## log2heal -0.527     0.591    0.254     0.364 -1.45 0.15
## 
## Likelihood ratio test=7.19  on 2 df, p=0.0275
## n= 33, number of events= 23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### two stage estimation 
stage1 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span><span class="kw">strata</span>(bfb) +<span class="st"> </span>log2heal +<span class="st"> </span><span class="kw">tt</span>(log2heal) +<span class="st"> </span><span class="kw">cluster</span>(id), 
                <span class="dt">tt =</span> function(x, t, ...) x *<span class="st"> </span><span class="kw">log</span>(t), <span class="dt">data =</span> biofeedback, <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>)
<span class="kw">summary</span>(stage1)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ strata(bfb) + log2heal + 
##     tt(log2heal) + cluster(id), data = biofeedback, tt = function(x, 
##     t, ...) x * log(t), method = &quot;breslow&quot;)
## 
##   n= 33, number of events= 23 
## 
##                 coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)   
## log2heal      0.7368    2.0892   0.9008    0.3797  1.940  0.05233 . 
## tt(log2heal) -0.4153    0.6602   0.3257    0.1490 -2.786  0.00533 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
##              exp(coef) exp(-coef) lower .95 upper .95
## log2heal        2.0892     0.4787    0.9926    4.3971
## tt(log2heal)    0.6602     1.5148    0.4929    0.8841
## 
## Concordance= 0.664  (se = 0.301 )
## Rsquare= 0.228   (max possible= 0.96 )
## Likelihood ratio test= 8.53  on 2 df,   p=0.01403
## Wald test            = 7.84  on 2 df,   p=0.01989
## Score (logrank) test = 6.59  on 2 df,   p=0.03701,   Robust = 7.71  p=0.02122
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># for comparison linear time-dependent effect</span>
<span class="kw">coxph</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span><span class="kw">strata</span>(bfb) +<span class="st"> </span>log2heal +<span class="st"> </span><span class="kw">tt</span>(log2heal) +<span class="st"> </span><span class="kw">cluster</span>(id), 
      <span class="dt">tt =</span> function(x, t, ...) x *<span class="st"> </span>t, <span class="dt">data =</span> biofeedback, <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ strata(bfb) + log2heal + 
##     tt(log2heal) + cluster(id), data = biofeedback, tt = function(x, 
##     t, ...) x * t, method = &quot;breslow&quot;)
## 
##                 coef exp(coef) se(coef) robust se     z    p
## log2heal     -0.0213    0.9789   0.4527    0.4330 -0.05 0.96
## tt(log2heal) -0.0196    0.9806   0.0222    0.0155 -1.26 0.21
## 
## Likelihood ratio test=8.64  on 2 df, p=0.0133
## n= 33, number of events= 23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stage2 &lt;-<span class="st"> </span><span class="kw">coxphw</span>(<span class="kw">Surv</span>(thdur, success) ~<span class="st"> </span>bfb +<span class="st"> </span>log2heal +<span class="st"> </span><span class="kw">log</span>(thdur):log2heal, <span class="dt">data =</span> biofeedback, 
                <span class="dt">template =</span> <span class="st">&quot;AHR&quot;</span>, <span class="dt">betafix =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">coef</span>(stage1)))
<span class="kw">summary</span>(stage2)</code></pre></div>
<pre><code>## coxphw(formula = Surv(thdur, success) ~ bfb + log2heal + log(thdur):log2heal, 
##     data = biofeedback, template = &quot;AHR&quot;, betafix = c(NA, coef(stage1)))
## 
## Model fitted by weighted estimation (AHR template) 
## 
##                           coef  se(coef) exp(coef) lower 0.95 upper 0.95
## bfb                  0.5967993 0.3732872 1.8162961  0.8738643   3.775107
## log2heal             0.7367590        NA 2.0891536         NA         NA
## log(thdur):log2heal -0.4152653        NA 0.6601651         NA         NA
##                            z         p
## bfb                 1.598767 0.1098724
## log2heal                  NA        NA
## log(thdur):log2heal       NA        NA
## 
## Wald Chi-square = 2.556056 on 1  df, p = 0.1098724  (based on: bfb )
## 
## Covariance-Matrix:
## [1] 0.1393434
## 
## Generalized concordance probability:
##                     concordance prob. lower 0.95 upper 0.95
## bfb                            0.6449     0.4663     0.7906
## log2heal                       0.6763         NA         NA
## log(thdur):log2heal            0.3977         NA         NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) { <span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;figure5.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">5</span>) }
  <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))
  <span class="kw">plot</span>(<span class="dt">x =</span> stage2, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">legendxy =</span> <span class="kw">c</span>(<span class="dv">45</span>, <span class="fl">1.15</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;treatment duration (days)&quot;</span>)
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">text =</span> <span class="st">&quot;weight&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (pdfind) { <span class="kw">dev.off</span>() }</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
