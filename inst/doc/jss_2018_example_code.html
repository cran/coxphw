<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Daniela Dunkler" />

<meta name="date" content="2023-11-28" />

<title>R code for ‘Weighted Cox Regression using the R package coxphw’</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">R code for ‘Weighted Cox Regression using
the R package coxphw’</h1>
<h4 class="author">Daniela Dunkler</h4>
<h4 class="date">2023-11-28</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This is the R example code from ‘Weighted Cox Regression Using the R
Package <strong>coxphw</strong>’ by <a href="https://www.jstatsoft.org/article/view/v084i02">Dunkler, Ploner,
Schemper and Heinze (Journal of Statistical Software, 2018, 84: 1-26,
doi: 10.18637/jss.v084.i02</a>). It works with R &gt;=3.2.2 and
<strong>coxphw</strong> package &gt;=4.0.0.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">#########################################################################################</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## R code for</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">## Weighted Cox Regression using the R package coxphw</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">## written by Daniela Dunkler</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">#########################################################################################</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">## This R example code works with R &gt;=3.4.2 and coxphw-package &gt;=4.0.0.</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="do">## load R packages</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;coxphw&quot;</span>)</span></code></pre></div>
<pre><code>## Lade nötiges Paket: survival</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;survival&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;splines&quot;</span>)                              <span class="co"># for splines::ns used in plotzph</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>pdfind <span class="ot">&lt;-</span> <span class="cn">FALSE</span>                                 <span class="co"># indicator, if plots should be saved as pdf</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>runSimulation <span class="ot">&lt;-</span> <span class="cn">FALSE</span>                          <span class="co"># indicator, if simulation should be run</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                                                <span class="co"># Running the simulation is time-consuming.</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="do">#########################################################################################</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="do">## additional function for nice plots of scaled Schoenfeld residuals versus time</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="do">#########################################################################################</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>plotcoxzph <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">resid =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">df =</span> <span class="dv">4</span>, <span class="at">nsmo =</span> <span class="dv">40</span>, var, <span class="at">wd =</span> <span class="dv">1</span>,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="cn">NULL</span>, ...)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>{</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="do">## plot.cox.zph function from survival package 2.37-4 slightly adapted</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> x<span class="sc">$</span>x</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  yy <span class="ot">&lt;-</span> x<span class="sc">$</span>y</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">nrow</span>(yy)</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">max</span>(df)</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  nvar <span class="ot">&lt;-</span> <span class="fu">ncol</span>(yy)</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  pred.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(xx), <span class="at">to =</span> <span class="fu">max</span>(xx), <span class="at">length =</span> nsmo)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">c</span>(pred.x, xx)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>  lmat <span class="ot">&lt;-</span> <span class="fu">ns</span>(temp, <span class="at">df =</span> df, <span class="at">intercept =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>  pmat <span class="ot">&lt;-</span> lmat[<span class="dv">1</span><span class="sc">:</span>nsmo, ]</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>  xmat <span class="ot">&lt;-</span> lmat[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>nsmo), ]</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>  qmat <span class="ot">&lt;-</span> <span class="fu">qr</span>(xmat)</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>  <span class="cf">if</span> (qmat<span class="sc">$</span>rank <span class="sc">&lt;</span> df)</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Spline fit is singular, try a smaller degrees of freedom&quot;</span>)</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>  <span class="cf">if</span> (se) {</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>    bk <span class="ot">&lt;-</span> <span class="fu">backsolve</span>(qmat<span class="sc">$</span>qr[<span class="dv">1</span><span class="sc">:</span>df, <span class="dv">1</span><span class="sc">:</span>df], <span class="fu">diag</span>(df))</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>    xtx <span class="ot">&lt;-</span> bk <span class="sc">%*%</span> <span class="fu">t</span>(bk)</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>    seval <span class="ot">&lt;-</span> d<span class="sc">*</span>((pmat<span class="sc">%*%</span> xtx) <span class="sc">*</span>pmat) <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>, df)</span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>  }</span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>  ylab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Beta(t) for&quot;</span>, <span class="fu">dimnames</span>(yy)[[<span class="dv">2</span>]])</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(var)) var <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nvar</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.character</span>(var)) var <span class="ot">&lt;-</span> <span class="fu">match</span>(var, <span class="fu">dimnames</span>(yy)[[<span class="dv">2</span>]])</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>    <span class="cf">if</span>  (<span class="fu">any</span>(<span class="fu">is.na</span>(var)) <span class="sc">||</span> <span class="fu">max</span>(var)<span class="sc">&gt;</span>nvar <span class="sc">||</span> <span class="fu">min</span>(var) <span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;Invalid variable requested&quot;</span>)</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>  }</span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>  <span class="cf">if</span> (x<span class="sc">$</span>transform <span class="sc">==</span> <span class="st">&quot;log&quot;</span>) {</span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>    xx <span class="ot">&lt;-</span> <span class="fu">exp</span>(xx)</span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>    pred.x <span class="ot">&lt;-</span> <span class="fu">exp</span>(pred.x)</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>  }</span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (x<span class="sc">$</span>transform <span class="sc">!=</span> <span class="st">&quot;identity&quot;</span>) {</span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>    xtime <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(yy)[[<span class="dv">1</span>]])</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>    indx <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">duplicated</span>(xx)</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>    apr1  <span class="ot">&lt;-</span> <span class="fu">approx</span>(xx[indx], xtime[indx],</span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>                    <span class="fu">seq</span>(<span class="fu">min</span>(xx), <span class="fu">max</span>(xx), <span class="at">length =</span> <span class="dv">17</span>)[<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)])</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">signif</span>(apr1<span class="sc">$</span>y, <span class="dv">2</span>)</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>    apr2  <span class="ot">&lt;-</span> <span class="fu">approx</span>(xtime[indx], xx[indx], temp)</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>    xaxisval <span class="ot">&lt;-</span> apr2<span class="sc">$</span>y</span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>    xaxislab <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">8</span>)</span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) xaxislab[i] <span class="ot">&lt;-</span> <span class="fu">format</span>(temp[i])</span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>  }</span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> var) {</span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>    y <span class="ot">&lt;-</span> yy[,i]</span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>    yhat <span class="ot">&lt;-</span> pmat <span class="sc">%*%</span> <span class="fu">qr.coef</span>(qmat, y)</span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>    <span class="cf">if</span> (resid) yr <span class="ot">&lt;-</span><span class="fu">range</span>(yhat, y)</span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>    <span class="cf">else</span>       yr <span class="ot">&lt;-</span><span class="fu">range</span>(yhat)</span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a>    <span class="cf">if</span> (se) {</span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span> <span class="fu">sqrt</span>(x<span class="sc">$</span>var[i,i] <span class="sc">*</span> seval)</span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>      yup <span class="ot">&lt;-</span> yhat <span class="sc">+</span> temp</span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a>      ylow<span class="ot">&lt;-</span> yhat <span class="sc">-</span> temp</span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a>      yr <span class="ot">&lt;-</span> <span class="fu">range</span>(yr, yup, ylow)</span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a>    }</span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(limits)) { limits <span class="ot">&lt;-</span> yr }</span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">$</span>transform <span class="sc">==</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>      <span class="fu">plot</span>(<span class="fu">range</span>(xx), limits, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, ...)</span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (x<span class="sc">$</span>transform <span class="sc">==</span> <span class="st">&quot;log&quot;</span>)</span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a>      <span class="fu">plot</span>(<span class="fu">range</span>(xx), limits, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">log =</span> <span class="st">&quot;x&quot;</span>, ...)</span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a>      <span class="fu">plot</span>(<span class="fu">range</span>(xx), limits, <span class="at">type =</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, ...)</span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a>      <span class="fu">axis</span>(<span class="dv">1</span>, xaxisval, xaxislab)</span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a>      <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a>      <span class="fu">box</span>()</span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a>    }</span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a>    <span class="cf">if</span> (resid) <span class="fu">points</span>(xx, y)</span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a>    <span class="fu">lines</span>(pred.x, yhat, <span class="at">lwd =</span> wd, ...)</span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a>    <span class="cf">if</span> (se) {</span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a>      <span class="fu">lines</span>(pred.x, yup,<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a>      <span class="fu">lines</span>(pred.x, ylow, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a>    }</span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a>  }</span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-2.1-gastric-cancer-study" class="section level2">
<h2>Section 2.1: Gastric cancer study</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="do">## ------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;gastric&quot;</span>, <span class="at">package =</span> <span class="st">&quot;coxphw&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">head</span>(gastric)</span></code></pre></div>
<pre><code>##   id radiation time status
## 1  1         0    1      1
## 2  2         1   17      1
## 3  3         1   42      1
## 4  4         1   44      1
## 5  5         1   48      1
## 6  6         1   60      1</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="do">## time in years</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>gastric<span class="sc">$</span>yrs <span class="ot">&lt;-</span> gastric<span class="sc">$</span>time <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">nrow</span>(gastric)</span></code></pre></div>
<pre><code>## [1] 90</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="do">## follow-up/observation time</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(yrs, <span class="fu">abs</span>(<span class="dv">1</span> <span class="sc">-</span> status)) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> gastric)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(yrs, abs(1 - status)) ~ 1, data = gastric)
## 
##       n events median 0.95LCL 0.95UCL
## [1,] 90     11   4.34       4      NA</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="do">## descriptive analysis</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>gtable0 <span class="ot">&lt;-</span> <span class="fu">table</span>(gastric<span class="sc">$</span>status, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>gtable0</span></code></pre></div>
<pre><code>## gastric$status
##  0  1 
## 11 79</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(gtable0) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## gastric$status
##     0     1 
## 12.22 87.78</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>gtable1 <span class="ot">&lt;-</span> <span class="fu">table</span>(gastric<span class="sc">$</span>radiation, gastric<span class="sc">$</span>status, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">addmargins</span>(gtable1)</span></code></pre></div>
<pre><code>##                  gastric$status
## gastric$radiation  0  1 Sum
##               0    3 42  45
##               1    8 37  45
##               Sum 11 79  90</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(gtable1, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                  gastric$status
## gastric$radiation     0     1
##                 0  6.67 93.33
##                 1 17.78 82.22</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="do">## check assumption of proportional hazards</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>gsurv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation, <span class="at">data =</span> gastric)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">summary</span>(gsurv)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(yrs, status) ~ radiation, data = gastric)
## 
##                 radiation=0 
##     time n.risk n.event survival std.err lower 95% CI upper 95% CI
##  0.00274     45       1   0.9778  0.0220       0.9356        1.000
##  0.17248     44       1   0.9556  0.0307       0.8972        1.000
##  0.28747     43       1   0.9333  0.0372       0.8632        1.000
##  0.34223     42       1   0.9111  0.0424       0.8316        0.998
##  0.49829     41       1   0.8889  0.0468       0.8017        0.986
##  0.59138     40       1   0.8667  0.0507       0.7728        0.972
##  0.68446     39       1   0.8444  0.0540       0.7449        0.957
##  0.71732     38       1   0.8222  0.0570       0.7178        0.942
##  0.82409     37       2   0.7778  0.0620       0.6653        0.909
##  0.93634     35       1   0.7556  0.0641       0.6399        0.892
##  0.96920     34       1   0.7333  0.0659       0.6149        0.875
##  0.97467     33       1   0.7111  0.0676       0.5903        0.857
##  0.98015     32       1   0.6889  0.0690       0.5661        0.838
##  1.04038     31       1   0.6667  0.0703       0.5422        0.820
##  1.04860     30       2   0.6222  0.0723       0.4955        0.781
##  1.06229     28       1   0.6000  0.0730       0.4727        0.762
##  1.07871     27       1   0.5778  0.0736       0.4501        0.742
##  1.11704     26       1   0.5556  0.0741       0.4278        0.721
##  1.25941     25       1   0.5333  0.0744       0.4058        0.701
##  1.33881     24       1   0.5111  0.0745       0.3841        0.680
##  1.36619     23       1   0.4889  0.0745       0.3626        0.659
##  1.43190     22       1   0.4667  0.0744       0.3415        0.638
##  1.43463     21       1   0.4444  0.0741       0.3206        0.616
##  1.46475     20       1   0.4222  0.0736       0.3000        0.594
##  1.53867     19       1   0.4000  0.0730       0.2797        0.572
##  1.55784     18       1   0.3778  0.0723       0.2597        0.550
##  1.84805     17       1   0.3556  0.0714       0.2399        0.527
##  1.85079     16       1   0.3333  0.0703       0.2205        0.504
##  2.04791     15       1   0.3111  0.0690       0.2014        0.481
##  2.13005     14       1   0.2889  0.0676       0.1827        0.457
##  2.15195     13       1   0.2667  0.0659       0.1643        0.433
##  2.18207     12       1   0.2444  0.0641       0.1462        0.409
##  2.61465     11       1   0.2222  0.0620       0.1286        0.384
##  2.65024     10       1   0.2000  0.0596       0.1115        0.359
##  2.67488      9       1   0.1778  0.0570       0.0948        0.333
##  3.40862      8       1   0.1556  0.0540       0.0787        0.307
##  3.47981      7       1   0.1333  0.0507       0.0633        0.281
##  3.88775      6       1   0.1111  0.0468       0.0486        0.254
##  4.24641      3       1   0.0741  0.0435       0.0234        0.234
##  4.63792      1       1   0.0000     NaN           NA           NA
## 
##                 radiation=1 
##    time n.risk n.event survival std.err lower 95% CI upper 95% CI
##  0.0465     45       1    0.978  0.0220        0.936        1.000
##  0.1150     44       1    0.956  0.0307        0.897        1.000
##  0.1205     43       1    0.933  0.0372        0.863        1.000
##  0.1314     42       1    0.911  0.0424        0.832        0.998
##  0.1643     41       1    0.889  0.0468        0.802        0.986
##  0.1971     40       1    0.867  0.0507        0.773        0.972
##  0.2026     39       1    0.844  0.0540        0.745        0.957
##  0.2601     38       1    0.822  0.0570        0.718        0.942
##  0.2820     37       1    0.800  0.0596        0.691        0.926
##  0.2957     36       1    0.778  0.0620        0.665        0.909
##  0.3340     35       1    0.756  0.0641        0.640        0.892
##  0.3943     34       1    0.733  0.0659        0.615        0.875
##  0.4572     33       1    0.711  0.0676        0.590        0.857
##  0.4654     32       1    0.689  0.0690        0.566        0.838
##  0.5010     31       1    0.667  0.0703        0.542        0.820
##  0.5065     30       1    0.644  0.0714        0.519        0.801
##  0.5284     29       1    0.622  0.0723        0.496        0.781
##  0.5339     28       1    0.600  0.0730        0.473        0.762
##  0.5394     27       1    0.578  0.0736        0.450        0.742
##  0.5695     26       1    0.556  0.0741        0.428        0.721
##  0.6407     25       1    0.533  0.0744        0.406        0.701
##  0.6434     24       1    0.511  0.0745        0.384        0.680
##  0.6954     23       1    0.489  0.0745        0.363        0.659
##  0.8405     22       1    0.467  0.0744        0.341        0.638
##  0.8624     21       1    0.444  0.0741        0.321        0.616
##  1.0979     20       1    0.422  0.0736        0.300        0.594
##  1.2183     19       1    0.400  0.0730        0.280        0.572
##  1.2704     18       1    0.378  0.0723        0.260        0.550
##  1.3251     17       1    0.356  0.0714        0.240        0.527
##  1.4456     16       1    0.333  0.0703        0.221        0.504
##  1.4839     15       1    0.311  0.0690        0.201        0.481
##  1.5524     14       1    0.289  0.0676        0.183        0.457
##  1.5797     13       1    0.267  0.0659        0.164        0.433
##  1.5880     12       1    0.244  0.0641        0.146        0.409
##  2.1766     11       1    0.222  0.0620        0.129        0.384
##  2.3409     10       1    0.200  0.0596        0.111        0.359
##  3.7399      6       1    0.167  0.0583        0.084        0.331</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="do">## plot of cumulative survival probabilities</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure1A.pdf&quot;</span>, <span class="at">width =</span> <span class="fl">10.2</span>, <span class="at">height =</span> <span class="dv">5</span>)  }</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="fu">plot</span>(gsurv, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;time (years)&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">text =</span> <span class="st">&quot;survival distribution function&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">title =</span> <span class="st">&quot;radiation&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>),</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>         <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.05</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">dev.off</span>() }</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="do">## plots of scaled Schoenfeld residuals and test departure from proportional hazards</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>gfit1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> gastric, <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>gfit1.ph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(<span class="at">fit =</span> gfit1, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>gfit1.ph</span></code></pre></div>
<pre><code>##           chisq df       p
## radiation  12.4  1 0.00042
## GLOBAL     12.4  1 0.00042</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure1B.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">plotcoxzph</span>(<span class="at">x =</span> gfit1.ph, <span class="at">wd =</span> <span class="dv">2</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">4.3</span>))</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;time (years, &quot;</span>, <span class="fu">hat</span>(F), <span class="st">&quot;(t) transformation)&quot;</span>)))</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.2</span>, <span class="at">cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">hat</span>(beta), <span class="st">&quot;(t) for radiation&quot;</span>)))</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  <span class="do">## add the linear fit</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(gfit1.ph<span class="sc">$</span>y <span class="sc">~</span> gfit1.ph<span class="sc">$</span>x)<span class="sc">$</span>coefficients, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">dev.off</span>() }</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>gfit1.ph2 <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(<span class="at">fit =</span> gfit1, <span class="at">transform =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure1C.pdf&quot;</span>, <span class="at">width =</span> <span class="fl">5.2</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  <span class="fu">plotcoxzph</span>(<span class="at">x =</span> gfit1.ph2, <span class="at">wd =</span> <span class="dv">2</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">4.3</span>))</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;time (years)&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.2</span>, <span class="at">cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">hat</span>(beta), <span class="st">&quot;(t) for radiation&quot;</span>)))</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;radiation...&quot;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="fl">0.1</span>, <span class="at">font =</span> <span class="dv">3</span>)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;protective&quot;</span>,  <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">1</span>, <span class="at">adj =</span> <span class="dv">0</span>, <span class="at">font =</span> <span class="dv">3</span>)</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;    harmful&quot;</span>,     <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">1</span>, <span class="at">adj =</span> <span class="dv">1</span>, <span class="at">font =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">dev.off</span>() }</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="do">## ignore non-proportional hazards and apply a standard Cox proportional hazards model</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> gastric, <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>))</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation, data = gastric, 
##     x = TRUE, method = &quot;breslow&quot;, cluster = id)
## 
##   n= 90, number of events= 79 
## 
##             coef exp(coef) se(coef) robust se     z Pr(&gt;|z|)
## radiation 0.1415    1.1520   0.2263    0.2292 0.617    0.537
## 
##           exp(coef) exp(-coef) lower .95 upper .95
## radiation     1.152     0.8681    0.7351     1.805
## 
## Concordance= 0.565  (se = 0.031 )
## Likelihood ratio test= 0.39  on 1 df,   p=0.5
## Wald test            = 0.38  on 1 df,   p=0.5
## Score (logrank) test = 0.39  on 1 df,   p=0.5,   Robust = 0.37  p=0.5
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="do">## coxphw(Surv(yrs, status) ~ radiation, data = gastric, template = &quot;PH&quot;)</span></span></code></pre></div>
</div>
<div id="section-2.2-biofeedback-therapy-study" class="section level2">
<h2>Section 2.2: Biofeedback therapy study</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="do">## ------------------------------------------</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;biofeedback&quot;</span>, <span class="at">package =</span> <span class="st">&quot;coxphw&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="fu">head</span>(biofeedback)</span></code></pre></div>
<pre><code>##   id success thdur bfb theal log2heal
## 1  1       1    25   0    17  4.08746
## 2  2       1     5   1    20  4.32193
## 3  3       0    53   0    81  6.33985
## 4  4       0   100   1   135  7.07682
## 5  5       0    30   0   730  9.51175
## 6  6       1    89   0    15  3.90689</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="do">## descriptive analysis</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">nrow</span>(biofeedback)</span></code></pre></div>
<pre><code>## [1] 33</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>btable0 <span class="ot">&lt;-</span> <span class="fu">table</span>(biofeedback<span class="sc">$</span>bfb, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>btable0</span></code></pre></div>
<pre><code>## biofeedback$bfb
##  0  1 
## 14 19</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(btable0) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## biofeedback$bfb
##     0     1 
## 42.42 57.58</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="do">## follow-up/observation time</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="do">## survfit(Surv(thdur, abs(1-success)) ~ 1, data = biofeedback)</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> biofeedback)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(thdur, success) ~ 1, data = biofeedback)
## 
##       n events median 0.95LCL 0.95UCL
## [1,] 33     23     25      21      89</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>btable1 <span class="ot">&lt;-</span> <span class="fu">table</span>(biofeedback<span class="sc">$</span>bfb, biofeedback<span class="sc">$</span>success, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">addmargins</span>(btable1)</span></code></pre></div>
<pre><code>##                biofeedback$success
## biofeedback$bfb  0  1 Sum
##             0    4 10  14
##             1    6 13  19
##             Sum 10 23  33</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(btable1, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                biofeedback$success
## biofeedback$bfb     0     1
##               0 28.57 71.43
##               1 31.58 68.42</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="do">## hist(biofeedback$theal)</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="do">## hist(biofeedback$log2heal)</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="do">## Kaplan-Meier analysis</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>bsurv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> bfb, <span class="at">data =</span> biofeedback)</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="fu">summary</span>(bsurv)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(thdur, success) ~ bfb, data = biofeedback)
## 
##                 bfb=0 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     9     14       1    0.929  0.0688       0.8030        1.000
##    18     13       1    0.857  0.0935       0.6921        1.000
##    24     12       1    0.786  0.1097       0.5977        1.000
##    25     11       2    0.643  0.1281       0.4351        0.950
##    32      8       1    0.562  0.1349       0.3515        0.900
##    58      6       1    0.469  0.1413       0.2596        0.846
##    84      5       1    0.375  0.1407       0.1797        0.783
##    85      4       1    0.281  0.1332       0.1112        0.711
##    89      3       1    0.188  0.1172       0.0551        0.639
## 
##                 bfb=1 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     5     19       1    0.947  0.0512        0.852        1.000
##     7     18       1    0.895  0.0704        0.767        1.000
##    11     17       1    0.842  0.0837        0.693        1.000
##    13     16       1    0.789  0.0935        0.626        0.996
##    14     15       2    0.684  0.1066        0.504        0.929
##    15     13       1    0.632  0.1107        0.448        0.890
##    17     12       1    0.579  0.1133        0.395        0.850
##    20     11       1    0.526  0.1145        0.344        0.806
##    21     10       1    0.474  0.1145        0.295        0.761
##    22      9       1    0.421  0.1133        0.249        0.713
##    23      8       1    0.368  0.1107        0.204        0.664
##    33      6       1    0.307  0.1079        0.154        0.611</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure2A.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma  =</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="fu">plot</span>(bsurv, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;duration of therapy (days)&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">text =</span> <span class="st">&quot;cumulative propability of rehabilitation&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">title =</span> <span class="st">&quot;biofeedback (bfb)&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>         <span class="at">inset =</span> <span class="fl">0.05</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">dev.off</span>() }</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>bfit1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> bfb <span class="sc">+</span> log2heal <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> biofeedback,</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>               <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a><span class="fu">summary</span>(bfit1)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ bfb + log2heal, data = biofeedback, 
##     x = TRUE, method = &quot;breslow&quot;, cluster = id)
## 
##   n= 33, number of events= 23 
## 
##             coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)
## bfb       0.2700    1.3099   0.4273    0.3453  0.782    0.434
## log2heal -0.5267    0.5906   0.2543    0.3636 -1.448    0.148
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## bfb         1.3099     0.7634    0.6658     2.577
## log2heal    0.5906     1.6933    0.2896     1.205
## 
## Concordance= 0.665  (se = 0.061 )
## Likelihood ratio test= 7.19  on 2 df,   p=0.03
## Wald test            = 2.66  on 2 df,   p=0.3
## Score (logrank) test = 5.16  on 2 df,   p=0.08,   Robust = 4.72  p=0.09
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>bfit1.ph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(bfit1, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>bfit1.ph</span></code></pre></div>
<pre><code>##          chisq df      p
## bfb       7.44  1 0.0064
## log2heal  4.29  1 0.0384
## GLOBAL   11.10  2 0.0039</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure2B.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>  <span class="fu">plotcoxzph</span>(<span class="at">x =</span>  bfit1.ph[<span class="dv">1</span>], <span class="at">wd =</span> <span class="dv">2</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;duration of therapy (days)&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.2</span>, <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)), <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(bfit1.ph<span class="sc">$</span>y[, <span class="dv">1</span>] <span class="sc">~</span> bfit1.ph<span class="sc">$</span>x)<span class="sc">$</span>coefficients, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;bfb&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">inset =</span> <span class="fl">0.08</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">dev.off</span>() }</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure2C.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="fu">plotcoxzph</span>(<span class="at">x =</span> bfit1.ph[<span class="dv">2</span>], <span class="at">wd =</span> <span class="dv">2</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.5</span>, <span class="dv">4</span>))</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;duration of therapy (days)&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.2</span>, <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)), <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(bfit1.ph<span class="sc">$</span>y[, <span class="dv">2</span>] <span class="sc">~</span> bfit1.ph<span class="sc">$</span>x)<span class="sc">$</span>coefficients, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;log2heal&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">inset =</span> <span class="fl">0.08</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAz1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZgBmZmZmZpBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQZmaQkGaQtraQttuQ2/+2ZgC2Zjq2kDq2kGa2tra2ttu22/+2/7a2/9u2///bkDrbkGbbtmbbtpDbtrbb25Db27bb29vb2//b/9vb////AAD/tmb/25D/27b/29v//7b//9v///9DUwQOAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAWH0lEQVR4nO2dDXvbxpVGR44lJmlqR+o6mzTdWHF2Y7rNamvGadNGphQR//83LQZfBEgQBDAD4B3gnOcxTZHAxWBweOcDIGgiAGHM1AUAaAJBQRoEBWkQFKRBUJAGQUEaBAVpEBSk8SqoAfDDQIL6DOaBQcqjtpOzZBGCGq3iQAeCErRnVPQMmKAE7Rd2UD+Rvxnn+glLUEEf9EqkhHvtBCZo18Aj6IOhDSxP0E6MMzjS2FdJPFTNjAVl7D45yxQU75aEq6Dry/vmsANwPjWOnTz5zAyGo6BbM4Gg5wScoG3H0KFwE/TpZhpBG5lk2xh6jJc6cRN0c/n9dIJqOaFVGgX81IiToA+fvp2iD1psxBz8aRi46+DpULgIuru9Phgk1VwkNSjZdhBTEAFBN7GcU2bQfFsqdqqUQwJfleEgaNzATzPNJMsy93pYHATdZK3568awi2Khuz0kIU7UC7PU/R4OBIUB8Hf8ERT84/HwB3ixiDpL3vcMBJVm0Ttv8VkBCDoAy957BNVn4bvvEwQFaRAUpEHQgVhuDfjdcwQdiqVWgef9RtDBkLnKalR87zSCDsgCa8H7LiPoPMguEjfF/1MXyBcIOguO63su3zJA0IEZuiaaRQzfUgQdmsnvYTHisRhgUwg6OMPURTfxwr2NGoIOzxB5pXPMETLpIBtAUPAFgoaLx69AOGXCIdPoQF2ZYeIj6AGezHAPE9q4HkHHIjQzREDQQPA6yAno8CBoEPhOv97T+WAHHEFHRade/Co63H4h6Lh09iKMc+oIOh+UzgD5ij7K5BWCjojKOXQ/GxmypAg6ESpXIan3IBB0Umr0UDdmZBB0Yg6vhJ+k5hw2Ovj1rsNsCUHDovfxGvESKQRdMj0z9/DHGUEhxURPNxdvzyz0y1fGXLy4s08fVs/etznMLaI2F+v4mQcQNEDOq/Qu/VWCC/uzBFZQP1EbQVDIebo509BvzcV3UfR4a6yaCAojY1VqmkbY3ZrrdDn7yy4GQWFccpUe38SafnGXvvj7u5UxL+/XsZOFautYVGMz6IfPjXn+Y7rg45vVfi3bVzWffHsfISh4I1Npu9p3NOOGPPnj+dfln8Na2zwbC/p16YeysrXSP7K+avJT2AgKnkhVipW8vLNnDOwfcav+/C7a/bXye21xE58uZ768tz3SVMM4zdoF7VppX3X3LlkJQcETqUprk/6y0NpcWU3TjuYmF9Tmzk2yRCxo0iN9WNm1NvHS6YJXaRcgyvusCAqeSFSKrUpV3FoN1/kZ2GRclE7nb5MsmYlZrJVZ+LDa/3AWgoJXEpUKn+wgqLC1dJHAdpX3TtPkmq1V/BB7+uru159+iEdQCAr+yFTLZo/skyIxRuvc1I0pCVxaqyKoHd0nICj4oymDZoLGA59ctwNByxZu4xHWF3/+n3/RxINPavugyXAnf9UO6vPZ+Yqge5Oj/YQ+fVDwSmUUH9t1ZS1NLdwmo/hdPsK3VAQtxv5W67yXsF0hKHikPA/6+5vyPOjPq0TQTcnPA0HTtaIP1sm4Q3p1H+3+tqIPCj5pOJN0+X1yqrMYCV0dClqcSXoZJbOmyUp/tcshKHiiOBdvT6S/KJ2Lv0jPxW9Ng6DpufjsxLwdxX/yXdqNRVAYnsogaFQQFBrIz2C2vfjTPwgKDWyTC0KiX1aZqOODoNBA3LTvL5ybBASFRpJLj//w3VR+Iihog6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEjjImjyndTrM2EBXHAQNLn97qb+G/0ICn5wEPRhZW/Xs6m9JwqCgh+c+6Db2nuXISj4wVnQdTmD7u/P51gsgBRXQbf1oyQEBT84Cro9cdczBAU/uAl6In8iKPjCSdDNKT8RFDzhIujm9G2hERT84DQPeip/Iij4wkHQ7MdGmAeFAeFiEZAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWkQFKRBUJAGQQeBrw36AkGHwESLrwJfIOgAmNIjuIGgA4Cg/kDQAUBQfyDoENAH9QaCDgKjeF8gKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIIywov9YGyoIaP2EgbGQFNZ7iQNgMJejHj64RSo+wXAYS9GMuaG9RERQsAzfxDqLSB4VotD5oH1EZxcPogyT3ph+WxUSjeESFdkw8zYSo0IzIPCiiQj0iguYgKlQREzTHi6imCccCwkg4Cbo15uLtmbBunBW1UcL2eCruEhi5tlwE3cZ2busN9b0Px6I6aheGrkplyRj7/ImDoLvb6/hxfdUc1i9W1MShjx99yiTqqeDJtNHPQDsI+rB6HT9unr1vDOuDY3cGHUypeKp4OUJQgn5qW/dtWdDKYXX719wE5//SjJpePeW+zaYy+I7d+t+U2xYok+kvaNr9rO+Edg5Wo3iXJDZgRp0ulZrSowwmGrdIMoL6aVeHEnUaS8eWoRUT1MHhs5bUNPF9gg3S4xtC1Ak6plP2gEVwEdRxkDSImQd4F3WMQkMJB0E7TzPlB3SCg+xbVBwdizpBdx8+K7Lirz988+OpdTtO1BuB9ONZVBwdnGNBf3+3Mpf3UfTLVy/uone2/u1ftWy6nOo0+7zjVmQf+BNVZ5/myaGgj2+MicW059kvPjfffBE/fbytbcVbhj14SexAer0oxU+RoMKBoE835sskXyYdzKf/TJ4/fFY3DmoZ9uAl0aPoLCpd0oE4EHT3LkugT//xPnso/usXtvqa+vFzEZVx0xAc9UF3cRf0+Y/R059s5/Kn5KWtlyY+qFm9j86ZNJhdFadmFL/7sHr2Plpf3uV//9A5gcpnyrb0EhVHPVI/D/qPe9sbrVA7H98ibNjkgnYXFUn9cHqifvePn/77mz1/XqSgOb1ExVEPOJxJahd2XnQWFUkdQdBedBEVR11AUCfaioqkfUFQL7QQFUd7gaBeOSMqknYGQQfhtKg42g0EHZR6UY8lxdhTIOgoHIladTSEyxQmAkFHpSJqIan0hV4Tg6CTUBK1SKTUWR0Kgi64A5bfyicRderCSCIgKB2wyGSZtP9lfrNlekHpgEX77mj/q6eyKH6LJQCCCrEf2ve7eiqaYT0iqBjV+adOF6WUHufD9ILO84PvQs3JpjaiImivsG0WnmHXyZUTZ0SbREXQXmGhL01n7WtFnWVThKDSnLu0pCrqHJui+Qg6x6NjaXX5U3rq1OHr0rLMRtBZtm85rSS177rNoyoyF0HnOUIoYcw5S8tVMJ9f7EPQgGiWtK4KwhcVQUPjtKUNvZxwRZ2LoPPugx5ywtHz48TwRJ2NoLMdxZ/E5dtN4Yg6H0FP0fEQBuW5i6MJ+qLOXtCOTX94PQVnSS26os5d0I6DpzDHWvtxk2vJ9URFUJfFhTAVXKPpiIqgLovLYfx6KiDq3AWdfx+0Dt+eTijq7AWd9Sj+DN49nUDU+QsKPTw9t9h4oiLoYjC11C8atTyEXUWtL8O5ohw+8wCCDopLe93Cke5DxQZRG7eHoLPE40iuvT6tyG/lY/L/W0l4bl8Pn/nYb5/BoMpwc2GDiOpYpJpnHkDQARl+stZbinYfTCFoeIxwNqFPY9xE8aW+7j+IVvPMAwg6JLpnExrFNn0yKoKGiO8E54vGT0458bcXFUHBG819j7p3z4uKoOCN7oLmnBYVQcEbZ0ZvLbrOx6IiKPjjjILNQ6jym3UZFUHBmf6jt3q3PyIoSHCyd0ATDwogqCOqM49zAUHd0D13MxdO1TCCtmGEs9+L50QbhaBtQNDJCFDQCbqDCDoZ4Qk6SXeQPuhUBCfoRMmMUfxEIChIg6DLJYhWIThB6Q76IoyKDE/QMD74+gTSFAUoKHgBQUEaBF0EAfc36IMugK4HWcpnqcKcAkFd6NpMhpG0pEBQFzoKGki3TwoXQXe3cSNxfSbsrEHQwXEQdHd78TbamKvmsPOmW5uNoN1xEPRh9Tp+3Dx73xh25nQbaNAH7YxzH3Qbp9GmsFAmiIGzFM6CrpedQWFgXAXdVkZJDrd6BqjDUdBt/RiJDAqecBN0e2KWCUHBE/0E3aQToJtTfiIoeMIlg27M6/NhAVxwmgc9lT8RFHzhIOgmHa8zDwoDwsUiIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSDMDQY2l9D/MibAFRcjZ4yro+vK+OeyAnNATa+eEo6BbM52gp7dBUz8f3AR9uplQUFgCboJuLr/XFZQ0OgecBH349O1EfdB28VE0fFwE3d1eHwySTIGHop2mfXgMDR0XQTexnFNkUKxbEA6Cxg38JNNMXWPjc8j0E3QTN+LXm6w1f90YVgCpwkA3Qp6obw2DpXAJTtB+kTE0VEITFNMWRmAXizjERe0gWY6gkxlavRiQiwK7EZagbmEnEePURrG0HWEJ6sqoxTqXKcmkbViWoCPS1j5qqpmABPUUcwQjOqVG8mgj4QjqLeTgV1p1PheLoqcJRlCPEYcVAtu8skRBkSggQhE0CKVcUnMQOzgBoQjqH99FdJ01oiday3IF1TNCrkAKLFhQf0Zg1nAEIaj28UfPIQlBUG0BtEsXPAiqJphaeSYmAEHlzvzsVxykaBhaBkGjnooO1/WkU1siAEFHQqnISmWZGAQtaJ24uJBzRBC0RCvxsHNU5AUdXYfTGxw1c/IxSFEXdILjVHy7rfRCNH7mxNAEBG3Y9iRiljY/0YalEBd02cdo2XufgqAgjbigsHQQVJvFVySCirP0mhxKUAA/DCNoX1wK4evyeKEoPsJohPAQCEF9htEpjEYID4EQ1GcYncJohPAQCEF9htEpjEYID4EQ1GcYncJohPAQCEF9htEpjEYID4EQ1GcYncJohPAQCEF9htEpjEYID4EQ1GcYncJohPAQSEJQgFMgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtJMJ+g2+4Lp6/TPjTEXb7tFePjsfc81a8I83djCXPULsbuN1722z7YuhdmH6b1PlRB53XZnfXnvWCXlIrgEmjiDPt1kxV7Hx+Nh1alCn26eWbM28ePWwdAszMOn/UPsbuPtb+wRsAXpXZh9mN77VAphS9LX0K2xgrpUiaUogkugiQXdJHJYS+ynfmOrpS1xrrIrJ2vubnt/zrMw0TYrSR/ST1a8L7tbuxvrnoUpwvTfp1JJrvqXJM549ki4VEmU74AtgkugaQV9WF2nT9J00SVpbM31fr/7C1qE2Tg0ZVmoi7eFH25hkv9dPnQXb50E3Vx+bwV1rJJ9EVwCTSvoOj+UmaDdmqS9oBuXTmgaZv2HvPPWl3hn0rbMLfPkdeKwTzaEQxMf70XSB3WtkqIILoEmFTRt2C1Z6ukn6NbNrG3aU0gOiUOcOBf3aAhqw0Ru+5SG6D1cs/0UK6iPKkmK4BRoUkFLRzIdJPXNoLvbLr3Xk2Fcct82HyO5CbotBru99ykNYbNo0YPqhB0JrIttO1RJtQg9A00q6Lp0CNbxYOX//tTpyJbNcnFiH6bjPEI5SJK1nJv4bSlv9tynrCS9e8PJPuyPTP8qOShCz0BTCrpv4TOyic22eDGrGqbvfMgmFct1kLQpt+v99ikL0T+Xb6rz0/2niA6K0DPQlIIeHYFO00yZWWkQl3GJhzB559ltmqkI41AYDyEsNoO61myxvlOgKQUtfb6TCfuun/ds+B3XZSpG32KkYZKOW78wpY6Wy0T9PkzvfSqF6N0HzQvgVCWVIrgEmlLQrClM5svs2bCuBzb7TK5dzul5CZO1irb8LuddS2H6FuYgRG+50j6oa80WRXAIxMUiIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgaJmHVfPF8L93+i7b06viKshuK54IV3xj61wx3b6LqQWCljlz5H/+7H0Xz9bFxcsdVzwRrijbeUFd71qjA4KWOXPk152+VrO7LRa3K7oKWvomyXlB+38vSg0ELeNZ0MJIH4KWlGshqNPNI5RA0IzHr4x5+c/4yKci2cfd7dXGPLuLPnwet9Xf3id3NrxK3358szLmxV2y3D9fmYu/7OPk72yLWw4WK/52my35+CaJmHwfq7wJq/Lf3xnzxV3+/fbi9n/ZV2CLYkbFOvsFd+9W6bql9UIHQVMeVtanTw4E/WRlLu+zL6JdlwRNlzZJXszercSx7xwL+vxVtmS20JV9q7IJK+jX2bfeUsWK2yult2raFzMq1tkvuC6+Mdc12+uCoAmxQ1/eR7+sTFVQq8zTTZzhogd7f6GipV6bl/dxvkqWNlf36R05E/bvHDfx5vIu+tm+s7Ybixd6HR1vwlz8mK2fKFZ4ljwpFfOgWPYhvQfSh+z+tTNp4xE0IevVbQ8Ezez4108/fG5KgqYmJKOgdJnsheJJ8uqRoPmNtLKN2a9bH28i8Sp52ebEoqVOg5WKWVonX/Dp5uLFT//ONtn75rViIGhCdouDpCNXEjQxLGuQS4LmN0TY2Ptw5kuX4yT5q3aQlK6e3V3mxCay9W1hCs1yQYtiltYpFkxa/aQri6Azo0HQpxvzx2//99ebAQS1CbhmE9n69sYWRQt/JGhpnf2Cv77JnEXQmVFp4vNGO5Vim/0OwKkmviJoYxO/F7Q4z3O8iX0THxfqv4qx+FETX1qnsuDvv7zqczNgWRA0ZV2MPuKn18mIphA0HgU9vso7iEeDpIqgpwZJRUJNM/PFX+xoppgyKG/CPL/L1k+G+IVlaYrcF7O0Tr5grG/cA31M+roMkmZG2uz+0WaoZH7o+atSE5/PHG0Oppkq2pXjJFM9JUGLFaPa1UubWF98nj1LVtvPFZWnmWwxS+sUC6bTTOkIqnzv1ZBB0Aw7d57NgP+8Mi9+2w+S4jRlPvnOJsGnOGH9lk3Ux369/Hd0JOj+nfKL+xV3xer5PH91E+tnf4/fe5H3aMtnj66rxdyvUyy4+9vKvpZs8fDeq6GCoFpU5tcr/cimlHjc4eRUJwxCWdDHytn7BuWqC6ZxZnKmE0HF2AtqO5mVZvqUc0cLRlxuB0OxF3R3a15W3no68RMTRwtGXLAMMBIICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNP8PcTYHesg7TTQAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) {  <span class="fu">dev.off</span>() }</span></code></pre></div>
</div>
<div id="section-5-simulation" class="section level2">
<h2>Section 5: Simulation</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n1 =</span> <span class="dv">100</span>, <span class="at">n2 =</span> <span class="dv">100</span>, <span class="at">sim =</span> <span class="dv">10</span>, <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>                       <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;ph&quot;</span>, <span class="st">&quot;nph1&quot;</span>, <span class="st">&quot;nph2&quot;</span>, <span class="st">&quot;nph3&quot;</span>), <span class="at">scalewei =</span> <span class="cn">NULL</span>,</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>                       <span class="at">shapewei =</span> <span class="cn">NULL</span>, <span class="at">beta =</span> <span class="cn">NULL</span>, <span class="at">scaleexp =</span> <span class="cn">NULL</span>, <span class="at">shapewei2 =</span> <span class="cn">NULL</span>,</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>                       <span class="at">scalewei2 =</span> <span class="cn">NULL</span>, <span class="at">shapegom =</span> <span class="cn">NULL</span>, <span class="at">scalegom =</span> <span class="cn">NULL</span>, scaleexpC,</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>                       admincens, <span class="at">npop =</span> <span class="dv">10000</span>, <span class="at">xmaxplot =</span> <span class="cn">NULL</span>, <span class="at">addconstant =</span> <span class="fl">1e-4</span>)</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>  {</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>    <span class="do">## Simulate time-to-event data (following either an expoential, Weibuill or Gompertz</span></span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>    <span class="do">## distribution) with one binary explanatory variable, generate six versions of</span></span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>    <span class="do">## each simulated data set with differnt censoring patterns (no censoring, administrative</span></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>    <span class="do">## censoring and loss-to-follow-up) and analyse these data sets with Cox regression</span></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>    <span class="do">## and weighted Cox regression. Population-c is computed, as well.</span></span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>    <span class="do">## sim: number of simulations, 0 only population c is computed and plot is generated.</span></span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>    <span class="do">## type = &quot;ph&quot;   : Weibull distributed distributions, proportional hazards</span></span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>    <span class="do">##        &quot;nph1&quot; : exponential and Weibull distribution, non-proportional hazards</span></span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>    <span class="do">##        &quot;nph2&quot; : exponential and Weibull distribution, non-proportional hazards</span></span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>    <span class="do">##        &quot;nph3&quot; : exponential and Gompertz distribution, non-proportional hazards</span></span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>    <span class="do">## &quot;ph&quot; requires scalewei, shapewei and beta</span></span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a>    <span class="do">## &quot;nph1&quot; requires scalewei, shapewei and scaleexp</span></span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a>    <span class="do">## &quot;nph2&quot; requires scalewei, shapewei, scalewei2 and shapewei2</span></span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a>    <span class="do">## &quot;nph3&quot; requires scaleexp, scalegom and shapegom</span></span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a>    <span class="do">## scaleexpC and admincens: parameters for loss-to-follow-up and adminitrative censoring</span></span>
<span id="cb52-26"><a href="#cb52-26" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb52-27"><a href="#cb52-27" tabindex="-1"></a>    <span class="do">## add.constant  : this number will be added to all times to prevent survival times of</span></span>
<span id="cb52-28"><a href="#cb52-28" tabindex="-1"></a>    <span class="do">##                 exactly 0.</span></span>
<span id="cb52-29"><a href="#cb52-29" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" tabindex="-1"></a>    type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(type)</span>
<span id="cb52-31"><a href="#cb52-31" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;ph&quot;</span>)   {</span>
<span id="cb52-32"><a href="#cb52-32" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(scalewei),<span class="sc">!</span><span class="fu">is.null</span>(shapewei),<span class="sc">!</span><span class="fu">is.null</span>(beta))</span>
<span id="cb52-33"><a href="#cb52-33" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph1&quot;</span>) {</span>
<span id="cb52-34"><a href="#cb52-34" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(scalewei),<span class="sc">!</span><span class="fu">is.null</span>(shapewei),<span class="sc">!</span><span class="fu">is.null</span>(scaleexp))</span>
<span id="cb52-35"><a href="#cb52-35" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph2&quot;</span>) {</span>
<span id="cb52-36"><a href="#cb52-36" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(scalewei),<span class="sc">!</span><span class="fu">is.null</span>(shapewei),<span class="sc">!</span><span class="fu">is.null</span>(scalewei2),<span class="sc">!</span><span class="fu">is.null</span>(shapewei2))</span>
<span id="cb52-37"><a href="#cb52-37" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph3&quot;</span>) {</span>
<span id="cb52-38"><a href="#cb52-38" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(scaleexp),<span class="sc">!</span><span class="fu">is.null</span>(scalegom),<span class="sc">!</span><span class="fu">is.null</span>(shapegom))</span>
<span id="cb52-39"><a href="#cb52-39" tabindex="-1"></a>    }</span>
<span id="cb52-40"><a href="#cb52-40" tabindex="-1"></a></span>
<span id="cb52-41"><a href="#cb52-41" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb52-42"><a href="#cb52-42" tabindex="-1"></a></span>
<span id="cb52-43"><a href="#cb52-43" tabindex="-1"></a>    <span class="do">## 1) compute population c</span></span>
<span id="cb52-44"><a href="#cb52-44" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="sc">!=</span> <span class="st">&quot;ph&quot;</span>) {</span>
<span id="cb52-45"><a href="#cb52-45" tabindex="-1"></a>      <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph1&quot;</span>) {</span>
<span id="cb52-46"><a href="#cb52-46" tabindex="-1"></a>        integrandA <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { (scalewei <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>scalewei <span class="sc">*</span> x)) <span class="sc">*</span></span>
<span id="cb52-47"><a href="#cb52-47" tabindex="-1"></a>                                     <span class="fu">exp</span>(<span class="sc">-</span>scalewei <span class="sc">*</span> x <span class="sc">^</span> scalewei) }</span>
<span id="cb52-48"><a href="#cb52-48" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph2&quot;</span>) {</span>
<span id="cb52-49"><a href="#cb52-49" tabindex="-1"></a>        integrandA <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { (scalewei2 <span class="sc">*</span> shapewei2 <span class="sc">*</span> x <span class="sc">^</span> (shapewei2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span></span>
<span id="cb52-50"><a href="#cb52-50" tabindex="-1"></a>                                     <span class="fu">exp</span>(<span class="sc">-</span>scalewei2 <span class="sc">*</span> x <span class="sc">^</span> shapewei2)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>scalewei <span class="sc">*</span></span>
<span id="cb52-51"><a href="#cb52-51" tabindex="-1"></a>                                     x <span class="sc">^</span> shapewei) }</span>
<span id="cb52-52"><a href="#cb52-52" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph3&quot;</span>) {</span>
<span id="cb52-53"><a href="#cb52-53" tabindex="-1"></a>        integrandA <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { scaleexp <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>scaleexp <span class="sc">*</span> x) <span class="sc">*</span></span>
<span id="cb52-54"><a href="#cb52-54" tabindex="-1"></a>                                    <span class="fu">exp</span>(scalegom <span class="sc">/</span> shapegom <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(shapegom <span class="sc">*</span> x)))  }</span>
<span id="cb52-55"><a href="#cb52-55" tabindex="-1"></a>      }</span>
<span id="cb52-56"><a href="#cb52-56" tabindex="-1"></a>      popc100 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">integrate</span>(integrandA, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value,</span>
<span id="cb52-57"><a href="#cb52-57" tabindex="-1"></a>                       <span class="fu">integrate</span>(integrandA, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> admincens[<span class="dv">1</span>])<span class="sc">$</span>value,</span>
<span id="cb52-58"><a href="#cb52-58" tabindex="-1"></a>                       <span class="fu">integrate</span>(integrandA, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> admincens[<span class="dv">2</span>])<span class="sc">$</span>value) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb52-59"><a href="#cb52-59" tabindex="-1"></a>                     <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb52-60"><a href="#cb52-60" tabindex="-1"></a>    } <span class="cf">else</span> { popc100 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">exp</span>(beta) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(beta)), <span class="dv">6</span>) <span class="sc">*</span> <span class="dv">100</span> }</span>
<span id="cb52-61"><a href="#cb52-61" tabindex="-1"></a></span>
<span id="cb52-62"><a href="#cb52-62" tabindex="-1"></a>    <span class="cf">if</span> (sim <span class="sc">==</span> <span class="dv">0</span>) { output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">results =</span> <span class="cn">NA</span>, <span class="at">olist =</span> <span class="cn">NA</span>, <span class="at">popc100 =</span> popc100) }</span>
<span id="cb52-63"><a href="#cb52-63" tabindex="-1"></a></span>
<span id="cb52-64"><a href="#cb52-64" tabindex="-1"></a>    <span class="do">## 2) Kaplan-Meier plot of scenario</span></span>
<span id="cb52-65"><a href="#cb52-65" tabindex="-1"></a>    xpop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, npop <span class="sc">/</span> <span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, npop <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb52-66"><a href="#cb52-66" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> npop, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb52-67"><a href="#cb52-67" tabindex="-1"></a></span>
<span id="cb52-68"><a href="#cb52-68" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;ph&quot;</span>) {</span>
<span id="cb52-69"><a href="#cb52-69" tabindex="-1"></a>      time1pop <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>(npop <span class="sc">/</span> <span class="dv">2</span>)]) <span class="sc">/</span> (scalewei <span class="sc">*</span> <span class="fu">exp</span>(beta <span class="sc">*</span> <span class="dv">0</span>))) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-70"><a href="#cb52-70" tabindex="-1"></a>      time2pop <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fu">log</span>(u[((npop <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>npop]) <span class="sc">/</span> (scalewei <span class="sc">*</span> <span class="fu">exp</span>(beta <span class="sc">*</span> <span class="dv">1</span>))) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-71"><a href="#cb52-71" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph1&quot;</span>) {</span>
<span id="cb52-72"><a href="#cb52-72" tabindex="-1"></a>      time1pop <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>(npop <span class="sc">/</span> <span class="dv">2</span>)])) <span class="sc">/</span> scalewei) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-73"><a href="#cb52-73" tabindex="-1"></a>      time2pop <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(u[((npop <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>npop]) <span class="sc">/</span> scaleexp</span>
<span id="cb52-74"><a href="#cb52-74" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph2&quot;</span>) {</span>
<span id="cb52-75"><a href="#cb52-75" tabindex="-1"></a>      time1pop <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>(npop <span class="sc">/</span> <span class="dv">2</span>)])) <span class="sc">/</span> scalewei) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-76"><a href="#cb52-76" tabindex="-1"></a>      time2pop <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="fu">log</span>(u[((npop <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>npop])) <span class="sc">/</span> scalewei2) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei2)</span>
<span id="cb52-77"><a href="#cb52-77" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph3&quot;</span>) {</span>
<span id="cb52-78"><a href="#cb52-78" tabindex="-1"></a>      time1pop <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> shapegom <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (shapegom <span class="sc">*</span> <span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>(npop <span class="sc">/</span> <span class="dv">2</span>)])) <span class="sc">/</span> scalegom)</span>
<span id="cb52-79"><a href="#cb52-79" tabindex="-1"></a>      time2pop <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(u[((npop <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>npop]) <span class="sc">/</span> scaleexp</span>
<span id="cb52-80"><a href="#cb52-80" tabindex="-1"></a>    }</span>
<span id="cb52-81"><a href="#cb52-81" tabindex="-1"></a></span>
<span id="cb52-82"><a href="#cb52-82" tabindex="-1"></a>    time1pop <span class="ot">&lt;-</span> time1pop <span class="sc">+</span> addconstant</span>
<span id="cb52-83"><a href="#cb52-83" tabindex="-1"></a>    time2pop <span class="ot">&lt;-</span> time2pop <span class="sc">+</span> addconstant</span>
<span id="cb52-84"><a href="#cb52-84" tabindex="-1"></a>    datapop <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">time =</span> <span class="fu">c</span>(time1pop, time2pop), <span class="at">event =</span> <span class="dv">1</span>, <span class="at">x =</span> xpop))</span>
<span id="cb52-85"><a href="#cb52-85" tabindex="-1"></a></span>
<span id="cb52-86"><a href="#cb52-86" tabindex="-1"></a>    fitpop <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> datapop)</span>
<span id="cb52-87"><a href="#cb52-87" tabindex="-1"></a></span>
<span id="cb52-88"><a href="#cb52-88" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(xmaxplot)) { xmaxplot <span class="ot">&lt;-</span> <span class="fu">max</span>(datapop<span class="sc">$</span>time)  }</span>
<span id="cb52-89"><a href="#cb52-89" tabindex="-1"></a></span>
<span id="cb52-90"><a href="#cb52-90" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb52-91"><a href="#cb52-91" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> datapop), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb52-92"><a href="#cb52-92" tabindex="-1"></a>         <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, xmaxplot))</span>
<span id="cb52-93"><a href="#cb52-93" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> admincens, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb52-94"><a href="#cb52-94" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;time&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb52-95"><a href="#cb52-95" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">text =</span> <span class="st">&quot;survival distribution function&quot;</span>,</span>
<span id="cb52-96"><a href="#cb52-96" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb52-97"><a href="#cb52-97" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">font =</span> <span class="dv">2</span>,</span>
<span id="cb52-98"><a href="#cb52-98" tabindex="-1"></a>          <span class="at">text =</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;ph&quot;</span>) { <span class="st">&quot;proportional hazards scenario&quot;</span> } <span class="cf">else</span> {</span>
<span id="cb52-99"><a href="#cb52-99" tabindex="-1"></a>          <span class="st">&quot;non-proportional</span><span class="sc">\n</span><span class="st">hazards scenario&quot;</span> } )</span>
<span id="cb52-100"><a href="#cb52-100" tabindex="-1"></a></span>
<span id="cb52-101"><a href="#cb52-101" tabindex="-1"></a>    <span class="do">## 3) simulate data sets and analyse them</span></span>
<span id="cb52-102"><a href="#cb52-102" tabindex="-1"></a>    <span class="cf">if</span> (sim <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb52-103"><a href="#cb52-103" tabindex="-1"></a>      n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb52-104"><a href="#cb52-104" tabindex="-1"></a>      out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> sim, <span class="at">ncol =</span> <span class="dv">7</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>(sim),</span>
<span id="cb52-105"><a href="#cb52-105" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">&quot;cens&quot;</span>, <span class="st">&quot;cox_beta&quot;</span>, <span class="st">&quot;cox_c100&quot;</span>, <span class="st">&quot;wcox_beta&quot;</span>, <span class="st">&quot;wcox_c100&quot;</span>,</span>
<span id="cb52-106"><a href="#cb52-106" tabindex="-1"></a>                          <span class="st">&quot;wilcox100&quot;</span>, <span class="st">&quot;prt0st1&quot;</span>))))</span>
<span id="cb52-107"><a href="#cb52-107" tabindex="-1"></a>      olist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">out =</span> out, <span class="at">outC =</span> out, <span class="at">out1 =</span> out, <span class="at">outC1 =</span> out, <span class="at">out2 =</span> out, <span class="at">outC2 =</span> out)</span>
<span id="cb52-108"><a href="#cb52-108" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n1), <span class="fu">rep</span>(<span class="dv">1</span>, n2))</span>
<span id="cb52-109"><a href="#cb52-109" tabindex="-1"></a></span>
<span id="cb52-110"><a href="#cb52-110" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>sim) {</span>
<span id="cb52-111"><a href="#cb52-111" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb52-112"><a href="#cb52-112" tabindex="-1"></a></span>
<span id="cb52-113"><a href="#cb52-113" tabindex="-1"></a>        <span class="do">## simulate data without censoring (data), type 1</span></span>
<span id="cb52-114"><a href="#cb52-114" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb52-115"><a href="#cb52-115" tabindex="-1"></a></span>
<span id="cb52-116"><a href="#cb52-116" tabindex="-1"></a>        <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;ph&quot;</span>) {</span>
<span id="cb52-117"><a href="#cb52-117" tabindex="-1"></a>          time1 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>n1]) <span class="sc">/</span> (scalewei <span class="sc">*</span> <span class="fu">exp</span>(beta <span class="sc">*</span> <span class="dv">0</span>))) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-118"><a href="#cb52-118" tabindex="-1"></a>          time2 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fu">log</span>(u[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]) <span class="sc">/</span> (scalewei <span class="sc">*</span> <span class="fu">exp</span>(beta <span class="sc">*</span> <span class="dv">1</span>))) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-119"><a href="#cb52-119" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph1&quot;</span>) {</span>
<span id="cb52-120"><a href="#cb52-120" tabindex="-1"></a>          time1 <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>n1])) <span class="sc">/</span> scalewei) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-121"><a href="#cb52-121" tabindex="-1"></a>          time2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(u[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]) <span class="sc">/</span> scaleexp</span>
<span id="cb52-122"><a href="#cb52-122" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph2&quot;</span>) {</span>
<span id="cb52-123"><a href="#cb52-123" tabindex="-1"></a>          time1 <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>n1])) <span class="sc">/</span> scalewei) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei)</span>
<span id="cb52-124"><a href="#cb52-124" tabindex="-1"></a>          time2 <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="fu">log</span>(u[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n])) <span class="sc">/</span> scalewei2) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> shapewei2)</span>
<span id="cb52-125"><a href="#cb52-125" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;nph3&quot;</span>) {</span>
<span id="cb52-126"><a href="#cb52-126" tabindex="-1"></a>          time1 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> shapegom <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (shapegom <span class="sc">*</span> <span class="fu">log</span>(u[<span class="dv">1</span><span class="sc">:</span>n1])) <span class="sc">/</span> scalegom)</span>
<span id="cb52-127"><a href="#cb52-127" tabindex="-1"></a>          time2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(u[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]) <span class="sc">/</span> scaleexp</span>
<span id="cb52-128"><a href="#cb52-128" tabindex="-1"></a>        }</span>
<span id="cb52-129"><a href="#cb52-129" tabindex="-1"></a>        time1 <span class="ot">&lt;-</span> time1 <span class="sc">+</span> addconstant</span>
<span id="cb52-130"><a href="#cb52-130" tabindex="-1"></a>        time2 <span class="ot">&lt;-</span> time2 <span class="sc">+</span> addconstant</span>
<span id="cb52-131"><a href="#cb52-131" tabindex="-1"></a></span>
<span id="cb52-132"><a href="#cb52-132" tabindex="-1"></a>        data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">time =</span> <span class="fu">c</span>(time1, time2), <span class="at">event =</span> <span class="dv">1</span>, <span class="at">x =</span> x))</span>
<span id="cb52-133"><a href="#cb52-133" tabindex="-1"></a></span>
<span id="cb52-134"><a href="#cb52-134" tabindex="-1"></a>        fit1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb52-135"><a href="#cb52-135" tabindex="-1"></a>        fit2 <span class="ot">&lt;-</span></span>
<span id="cb52-136"><a href="#cb52-136" tabindex="-1"></a>          <span class="fu">coxphw</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb52-137"><a href="#cb52-137" tabindex="-1"></a>        fit1zph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(<span class="at">fit =</span> fit1, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb52-138"><a href="#cb52-138" tabindex="-1"></a></span>
<span id="cb52-139"><a href="#cb52-139" tabindex="-1"></a>        eg <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(time1, time2)</span>
<span id="cb52-140"><a href="#cb52-140" tabindex="-1"></a>        olist<span class="sc">$</span>out[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-141"><a href="#cb52-141" tabindex="-1"></a>          <span class="dv">0</span>,</span>
<span id="cb52-142"><a href="#cb52-142" tabindex="-1"></a>          fit1<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit1)[<span class="dv">1</span>],</span>
<span id="cb52-143"><a href="#cb52-143" tabindex="-1"></a>          fit2<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit2)[<span class="dv">1</span>],</span>
<span id="cb52-144"><a href="#cb52-144" tabindex="-1"></a>          <span class="fu">wilcox.test</span>(time <span class="sc">~</span> x, <span class="at">data =</span> data, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>statistic <span class="sc">/</span></span>
<span id="cb52-145"><a href="#cb52-145" tabindex="-1"></a>            (n1 <span class="sc">*</span> n2),</span>
<span id="cb52-146"><a href="#cb52-146" tabindex="-1"></a>          <span class="dv">1</span> <span class="sc">-</span> (<span class="fu">sum</span>(eg[, <span class="dv">1</span>] <span class="sc">&lt;</span> eg[, <span class="dv">2</span>]) <span class="sc">/</span> <span class="fu">nrow</span>(eg)))</span>
<span id="cb52-147"><a href="#cb52-147" tabindex="-1"></a></span>
<span id="cb52-148"><a href="#cb52-148" tabindex="-1"></a>        <span class="do">## follow-up distribution</span></span>
<span id="cb52-149"><a href="#cb52-149" tabindex="-1"></a>        timecens <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fu">log</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)) <span class="sc">/</span> scaleexpC) <span class="sc">+</span> addconstant</span>
<span id="cb52-150"><a href="#cb52-150" tabindex="-1"></a></span>
<span id="cb52-151"><a href="#cb52-151" tabindex="-1"></a>        <span class="do">## data with censoring (dataC), type 2</span></span>
<span id="cb52-152"><a href="#cb52-152" tabindex="-1"></a>        dataC <span class="ot">&lt;-</span> data</span>
<span id="cb52-153"><a href="#cb52-153" tabindex="-1"></a>        dataC<span class="sc">$</span>time[data<span class="sc">$</span>time <span class="sc">&gt;</span> timecens] <span class="ot">&lt;-</span> timecens[data<span class="sc">$</span>time <span class="sc">&gt;</span> timecens]</span>
<span id="cb52-154"><a href="#cb52-154" tabindex="-1"></a>        dataC<span class="sc">$</span>event[data<span class="sc">$</span>time <span class="sc">&gt;</span> timecens] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-155"><a href="#cb52-155" tabindex="-1"></a>        censC <span class="ot">&lt;-</span> <span class="fu">sum</span>(dataC<span class="sc">$</span>event <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb52-156"><a href="#cb52-156" tabindex="-1"></a></span>
<span id="cb52-157"><a href="#cb52-157" tabindex="-1"></a>        fit1C <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> dataC)</span>
<span id="cb52-158"><a href="#cb52-158" tabindex="-1"></a>        fit2C <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> dataC)</span>
<span id="cb52-159"><a href="#cb52-159" tabindex="-1"></a></span>
<span id="cb52-160"><a href="#cb52-160" tabindex="-1"></a>        dataC<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dataC)</span>
<span id="cb52-161"><a href="#cb52-161" tabindex="-1"></a></span>
<span id="cb52-162"><a href="#cb52-162" tabindex="-1"></a>        wilcoxC <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(time <span class="sc">~</span> x, <span class="at">data =</span> dataC, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>statistic</span>
<span id="cb52-163"><a href="#cb52-163" tabindex="-1"></a>        egC <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(dataC<span class="sc">$</span>event[dataC<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>], dataC<span class="sc">$</span>event[dataC<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb52-164"><a href="#cb52-164" tabindex="-1"></a>        olist<span class="sc">$</span>outC[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(censC,</span>
<span id="cb52-165"><a href="#cb52-165" tabindex="-1"></a>                             fit1C<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit1C)[<span class="dv">1</span>],</span>
<span id="cb52-166"><a href="#cb52-166" tabindex="-1"></a>                             fit2C<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit2C)[<span class="dv">1</span>],</span>
<span id="cb52-167"><a href="#cb52-167" tabindex="-1"></a>                             wilcoxC <span class="sc">/</span> (<span class="fu">length</span>(dataC<span class="sc">$</span>x[dataC<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">*</span></span>
<span id="cb52-168"><a href="#cb52-168" tabindex="-1"></a>                                        <span class="fu">length</span>(dataC<span class="sc">$</span>x[dataC<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">1</span>])),</span>
<span id="cb52-169"><a href="#cb52-169" tabindex="-1"></a>                             <span class="cn">NA</span>)</span>
<span id="cb52-170"><a href="#cb52-170" tabindex="-1"></a></span>
<span id="cb52-171"><a href="#cb52-171" tabindex="-1"></a>        <span class="do">## data with administrative censoring 1 (data1), type 3</span></span>
<span id="cb52-172"><a href="#cb52-172" tabindex="-1"></a>        data1 <span class="ot">&lt;-</span> data</span>
<span id="cb52-173"><a href="#cb52-173" tabindex="-1"></a>        data1<span class="sc">$</span>event[data<span class="sc">$</span>time <span class="sc">&gt;</span> admincens[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-174"><a href="#cb52-174" tabindex="-1"></a>        data1<span class="sc">$</span>time[data<span class="sc">$</span>time <span class="sc">&gt;</span> admincens[<span class="dv">1</span>]] <span class="ot">&lt;-</span> admincens[<span class="dv">1</span>]</span>
<span id="cb52-175"><a href="#cb52-175" tabindex="-1"></a>        cens1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data1<span class="sc">$</span>event <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb52-176"><a href="#cb52-176" tabindex="-1"></a></span>
<span id="cb52-177"><a href="#cb52-177" tabindex="-1"></a>        fit11 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> data1)</span>
<span id="cb52-178"><a href="#cb52-178" tabindex="-1"></a>        fit21 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> data1)</span>
<span id="cb52-179"><a href="#cb52-179" tabindex="-1"></a>        fit11zph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(<span class="at">fit =</span> fit11, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb52-180"><a href="#cb52-180" tabindex="-1"></a></span>
<span id="cb52-181"><a href="#cb52-181" tabindex="-1"></a>        eg1 <span class="ot">&lt;-</span> eg[<span class="sc">!</span>(eg[, <span class="dv">1</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">1</span>] <span class="sc">&amp;</span> eg[, <span class="dv">2</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">1</span>]), ]</span>
<span id="cb52-182"><a href="#cb52-182" tabindex="-1"></a>        wilcox1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(time <span class="sc">~</span> x, <span class="at">data =</span> data1, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>statistic</span>
<span id="cb52-183"><a href="#cb52-183" tabindex="-1"></a>        olist<span class="sc">$</span>out1[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(cens1,</span>
<span id="cb52-184"><a href="#cb52-184" tabindex="-1"></a>                             fit11<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit11)[<span class="dv">1</span>],</span>
<span id="cb52-185"><a href="#cb52-185" tabindex="-1"></a>                             fit21<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit21)[<span class="dv">1</span>],</span>
<span id="cb52-186"><a href="#cb52-186" tabindex="-1"></a>                             wilcox1 <span class="sc">/</span> (n1 <span class="sc">*</span> n2),</span>
<span id="cb52-187"><a href="#cb52-187" tabindex="-1"></a>                             <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>(eg1[, <span class="dv">1</span>] <span class="sc">&lt;</span> eg1[, <span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb52-188"><a href="#cb52-188" tabindex="-1"></a>                                   <span class="fu">sum</span>(eg[, <span class="dv">1</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb52-189"><a href="#cb52-189" tabindex="-1"></a>                                       eg[, <span class="dv">2</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">1</span>]) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">nrow</span>(eg)))</span>
<span id="cb52-190"><a href="#cb52-190" tabindex="-1"></a></span>
<span id="cb52-191"><a href="#cb52-191" tabindex="-1"></a>        <span class="do">## data1 with censoring (datacens1), type 4</span></span>
<span id="cb52-192"><a href="#cb52-192" tabindex="-1"></a>        dataC1 <span class="ot">&lt;-</span> data1</span>
<span id="cb52-193"><a href="#cb52-193" tabindex="-1"></a>        dataC1<span class="sc">$</span>time[data1<span class="sc">$</span>time <span class="sc">&gt;</span> timecens] <span class="ot">&lt;-</span> timecens[data1<span class="sc">$</span>time <span class="sc">&gt;</span> timecens]</span>
<span id="cb52-194"><a href="#cb52-194" tabindex="-1"></a>        dataC1<span class="sc">$</span>event[data1<span class="sc">$</span>time <span class="sc">&gt;</span> timecens] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-195"><a href="#cb52-195" tabindex="-1"></a>        censC1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(dataC1<span class="sc">$</span>event <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb52-196"><a href="#cb52-196" tabindex="-1"></a></span>
<span id="cb52-197"><a href="#cb52-197" tabindex="-1"></a>        fit1C1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> dataC1)</span>
<span id="cb52-198"><a href="#cb52-198" tabindex="-1"></a>        fit2C1 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> dataC1)</span>
<span id="cb52-199"><a href="#cb52-199" tabindex="-1"></a></span>
<span id="cb52-200"><a href="#cb52-200" tabindex="-1"></a>        wilcoxC1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(time <span class="sc">~</span> x, <span class="at">data =</span> dataC1, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>statistic</span>
<span id="cb52-201"><a href="#cb52-201" tabindex="-1"></a>        egC1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(dataC1<span class="sc">$</span>event[dataC1<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>], dataC1<span class="sc">$</span>event[dataC1<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb52-202"><a href="#cb52-202" tabindex="-1"></a>        olist<span class="sc">$</span>outC1[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(censC1,</span>
<span id="cb52-203"><a href="#cb52-203" tabindex="-1"></a>                              fit1C1<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit1C1)[<span class="dv">1</span>],</span>
<span id="cb52-204"><a href="#cb52-204" tabindex="-1"></a>                              fit2C1<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit2C1)[<span class="dv">1</span>],</span>
<span id="cb52-205"><a href="#cb52-205" tabindex="-1"></a>                              wilcoxC1 <span class="sc">/</span> (<span class="fu">length</span>(dataC1<span class="sc">$</span>x[dataC1<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">*</span></span>
<span id="cb52-206"><a href="#cb52-206" tabindex="-1"></a>                                          <span class="fu">length</span>(dataC1<span class="sc">$</span>x[dataC1<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">1</span>])),</span>
<span id="cb52-207"><a href="#cb52-207" tabindex="-1"></a>                              <span class="cn">NA</span>)</span>
<span id="cb52-208"><a href="#cb52-208" tabindex="-1"></a></span>
<span id="cb52-209"><a href="#cb52-209" tabindex="-1"></a>        <span class="do">## data with administrative censoring 2 (data2), type 5</span></span>
<span id="cb52-210"><a href="#cb52-210" tabindex="-1"></a>        data2 <span class="ot">&lt;-</span> data</span>
<span id="cb52-211"><a href="#cb52-211" tabindex="-1"></a>        data2<span class="sc">$</span>event[data<span class="sc">$</span>time <span class="sc">&gt;</span> admincens[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-212"><a href="#cb52-212" tabindex="-1"></a>        data2<span class="sc">$</span>time[data<span class="sc">$</span>time <span class="sc">&gt;</span> admincens[<span class="dv">2</span>]] <span class="ot">&lt;-</span> admincens[<span class="dv">2</span>]</span>
<span id="cb52-213"><a href="#cb52-213" tabindex="-1"></a>        cens2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data2<span class="sc">$</span>event <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb52-214"><a href="#cb52-214" tabindex="-1"></a></span>
<span id="cb52-215"><a href="#cb52-215" tabindex="-1"></a>        fit12 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> data2)</span>
<span id="cb52-216"><a href="#cb52-216" tabindex="-1"></a>        fit22 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> data2)</span>
<span id="cb52-217"><a href="#cb52-217" tabindex="-1"></a>        fit12zph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(<span class="at">fit =</span> fit12, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb52-218"><a href="#cb52-218" tabindex="-1"></a></span>
<span id="cb52-219"><a href="#cb52-219" tabindex="-1"></a>        eg2 <span class="ot">&lt;-</span> eg[<span class="sc">!</span>(eg[, <span class="dv">1</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">2</span>] <span class="sc">&amp;</span> eg[, <span class="dv">2</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">2</span>]), ]</span>
<span id="cb52-220"><a href="#cb52-220" tabindex="-1"></a>        wilcox2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(time <span class="sc">~</span> x, <span class="at">data =</span> data2, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>statistic</span>
<span id="cb52-221"><a href="#cb52-221" tabindex="-1"></a>        olist<span class="sc">$</span>out2[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(cens2,</span>
<span id="cb52-222"><a href="#cb52-222" tabindex="-1"></a>                             fit12<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit12)[<span class="dv">1</span>],</span>
<span id="cb52-223"><a href="#cb52-223" tabindex="-1"></a>                             fit22<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit22)[<span class="dv">1</span>],</span>
<span id="cb52-224"><a href="#cb52-224" tabindex="-1"></a>                             wilcox2 <span class="sc">/</span> (n1 <span class="sc">*</span> n2),</span>
<span id="cb52-225"><a href="#cb52-225" tabindex="-1"></a>                             <span class="dv">1</span> <span class="sc">-</span> ((<span class="fu">sum</span>(eg2[, <span class="dv">1</span>] <span class="sc">&lt;</span> eg2[, <span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb52-226"><a href="#cb52-226" tabindex="-1"></a>                                   <span class="fu">sum</span>(eg[, <span class="dv">1</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">2</span>] <span class="sc">&amp;</span></span>
<span id="cb52-227"><a href="#cb52-227" tabindex="-1"></a>                                       eg[, <span class="dv">2</span>] <span class="sc">&gt;=</span> admincens[<span class="dv">2</span>]) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">nrow</span>(eg)))</span>
<span id="cb52-228"><a href="#cb52-228" tabindex="-1"></a></span>
<span id="cb52-229"><a href="#cb52-229" tabindex="-1"></a>        <span class="do">## data2 with censoring (datacens2), type 6</span></span>
<span id="cb52-230"><a href="#cb52-230" tabindex="-1"></a>        dataC2 <span class="ot">&lt;-</span> data2</span>
<span id="cb52-231"><a href="#cb52-231" tabindex="-1"></a>        dataC2<span class="sc">$</span>time[data2<span class="sc">$</span>time <span class="sc">&gt;</span> timecens] <span class="ot">&lt;-</span> timecens[data2<span class="sc">$</span>time <span class="sc">&gt;</span> timecens]</span>
<span id="cb52-232"><a href="#cb52-232" tabindex="-1"></a>        dataC2<span class="sc">$</span>event[data2<span class="sc">$</span>time <span class="sc">&gt;</span> timecens] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-233"><a href="#cb52-233" tabindex="-1"></a>        censC2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(dataC2<span class="sc">$</span>event <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb52-234"><a href="#cb52-234" tabindex="-1"></a></span>
<span id="cb52-235"><a href="#cb52-235" tabindex="-1"></a>        fit1C2 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> dataC2)</span>
<span id="cb52-236"><a href="#cb52-236" tabindex="-1"></a>        fit2C2 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(time, event) <span class="sc">~</span> x, <span class="at">data =</span> dataC2)</span>
<span id="cb52-237"><a href="#cb52-237" tabindex="-1"></a></span>
<span id="cb52-238"><a href="#cb52-238" tabindex="-1"></a>        wilcoxC2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(time <span class="sc">~</span> x, <span class="at">data =</span> dataC2, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>statistic</span>
<span id="cb52-239"><a href="#cb52-239" tabindex="-1"></a>        egC2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(dataC2<span class="sc">$</span>event[dataC2<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>], dataC2<span class="sc">$</span>event[dataC2<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb52-240"><a href="#cb52-240" tabindex="-1"></a>        olist<span class="sc">$</span>outC2[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(censC2,</span>
<span id="cb52-241"><a href="#cb52-241" tabindex="-1"></a>                              fit1C2<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit1C2)[<span class="dv">1</span>],</span>
<span id="cb52-242"><a href="#cb52-242" tabindex="-1"></a>                              fit2C2<span class="sc">$</span>coefficients, <span class="fu">concord</span>(fit2C2)[<span class="dv">1</span>],</span>
<span id="cb52-243"><a href="#cb52-243" tabindex="-1"></a>                              wilcoxC2 <span class="sc">/</span> (<span class="fu">length</span>(dataC2<span class="sc">$</span>x[dataC2<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">*</span></span>
<span id="cb52-244"><a href="#cb52-244" tabindex="-1"></a>                                          <span class="fu">length</span>(dataC2<span class="sc">$</span>x[dataC2<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">1</span>])),</span>
<span id="cb52-245"><a href="#cb52-245" tabindex="-1"></a>                              <span class="cn">NA</span>)</span>
<span id="cb52-246"><a href="#cb52-246" tabindex="-1"></a>      }</span>
<span id="cb52-247"><a href="#cb52-247" tabindex="-1"></a></span>
<span id="cb52-248"><a href="#cb52-248" tabindex="-1"></a>      results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">7</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Loss-to-fup&quot;</span>,</span>
<span id="cb52-249"><a href="#cb52-249" tabindex="-1"></a>          <span class="st">&quot;Admin. 1&quot;</span>, <span class="st">&quot;Loss-to-fup &amp; admin. 1&quot;</span>, <span class="st">&quot;Admin. 2&quot;</span>, <span class="st">&quot;Loss-to-fup &amp; admin. 2&quot;</span>),</span>
<span id="cb52-250"><a href="#cb52-250" tabindex="-1"></a>          <span class="fu">colnames</span>(olist<span class="sc">$</span>out)))</span>
<span id="cb52-251"><a href="#cb52-251" tabindex="-1"></a></span>
<span id="cb52-252"><a href="#cb52-252" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb52-253"><a href="#cb52-253" tabindex="-1"></a>        olist[[j]][, <span class="fu">c</span>(<span class="st">&quot;cox_c100&quot;</span>, <span class="st">&quot;wcox_c100&quot;</span>, <span class="st">&quot;wilcox100&quot;</span>, <span class="st">&quot;prt0st1&quot;</span>)] <span class="ot">&lt;-</span></span>
<span id="cb52-254"><a href="#cb52-254" tabindex="-1"></a>          olist[[j]][, <span class="fu">c</span>(<span class="st">&quot;cox_c100&quot;</span>, <span class="st">&quot;wcox_c100&quot;</span>, <span class="st">&quot;wilcox100&quot;</span>, <span class="st">&quot;prt0st1&quot;</span>)] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb52-255"><a href="#cb52-255" tabindex="-1"></a></span>
<span id="cb52-256"><a href="#cb52-256" tabindex="-1"></a>        r1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">apply</span>(olist[[j]], <span class="dv">2</span>, mean), <span class="dv">3</span>)</span>
<span id="cb52-257"><a href="#cb52-257" tabindex="-1"></a>        r2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">apply</span>(olist[[j]], <span class="dv">2</span>, sd) <span class="sc">/</span> <span class="fu">sqrt</span>(sim), <span class="dv">3</span>)</span>
<span id="cb52-258"><a href="#cb52-258" tabindex="-1"></a></span>
<span id="cb52-259"><a href="#cb52-259" tabindex="-1"></a>        results[j, ] <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">paste</span>(r1, <span class="st">&quot; (&quot;</span>, r2, <span class="st">&quot;)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb52-260"><a href="#cb52-260" tabindex="-1"></a>      }</span>
<span id="cb52-261"><a href="#cb52-261" tabindex="-1"></a></span>
<span id="cb52-262"><a href="#cb52-262" tabindex="-1"></a>      output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">results =</span> results, <span class="at">olist =</span> olist, <span class="at">popc100 =</span> popc100)</span>
<span id="cb52-263"><a href="#cb52-263" tabindex="-1"></a>    }</span>
<span id="cb52-264"><a href="#cb52-264" tabindex="-1"></a></span>
<span id="cb52-265"><a href="#cb52-265" tabindex="-1"></a>    <span class="fu">invisible</span>(output)</span>
<span id="cb52-266"><a href="#cb52-266" tabindex="-1"></a>  }</span>
<span id="cb52-267"><a href="#cb52-267" tabindex="-1"></a></span>
<span id="cb52-268"><a href="#cb52-268" tabindex="-1"></a><span class="do">## Section 5. Simulation</span></span>
<span id="cb52-269"><a href="#cb52-269" tabindex="-1"></a><span class="cf">if</span> (runSimulation) {</span>
<span id="cb52-270"><a href="#cb52-270" tabindex="-1"></a><span class="do">## Figure 3 and Table 1</span></span>
<span id="cb52-271"><a href="#cb52-271" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">pdf</span>(<span class="st">&quot;simph.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb52-272"><a href="#cb52-272" tabindex="-1"></a>sim1 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="at">n1 =</span> <span class="dv">1000</span>, <span class="at">n2 =</span> <span class="dv">1000</span>, <span class="at">sim =</span> <span class="dv">2000</span>, <span class="at">seed =</span> <span class="dv">3460</span>, <span class="at">type =</span> <span class="st">&quot;ph&quot;</span>,</span>
<span id="cb52-273"><a href="#cb52-273" tabindex="-1"></a>                   <span class="at">scalewei =</span> <span class="fl">0.11</span>, <span class="at">shapewei =</span> <span class="fl">1.22</span>, <span class="at">scaleexpC =</span><span class="fl">0.06029</span>,</span>
<span id="cb52-274"><a href="#cb52-274" tabindex="-1"></a>                   <span class="at">beta =</span> <span class="fu">log</span>(<span class="fl">0.55</span><span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.55</span>)), <span class="at">admincens =</span> <span class="fu">c</span>(<span class="fl">11.21083</span>, <span class="fl">9.549136</span>),</span>
<span id="cb52-275"><a href="#cb52-275" tabindex="-1"></a>                   <span class="at">npop =</span> <span class="dv">10000</span>, <span class="at">xmaxplot =</span> <span class="dv">23</span>, <span class="at">addconstant =</span> <span class="fl">1e-4</span>)</span>
<span id="cb52-276"><a href="#cb52-276" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">dev.off</span>() }</span>
<span id="cb52-277"><a href="#cb52-277" tabindex="-1"></a><span class="fu">print</span>(sim1<span class="sc">$</span>results[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb52-278"><a href="#cb52-278" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(sim1<span class="sc">$</span>popc100[<span class="dv">1</span>], <span class="dv">2</span>))        <span class="co"># true population-c * 100</span></span>
<span id="cb52-279"><a href="#cb52-279" tabindex="-1"></a></span>
<span id="cb52-280"><a href="#cb52-280" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">pdf</span>(<span class="st">&quot;simnph.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb52-281"><a href="#cb52-281" tabindex="-1"></a>sim2 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="at">n1 =</span> <span class="dv">1000</span>, <span class="at">n2 =</span> <span class="dv">1000</span>, <span class="at">sim =</span> <span class="dv">2000</span>, <span class="at">seed =</span> <span class="dv">3458</span>, <span class="at">type =</span><span class="st">&quot;nph3&quot;</span>,</span>
<span id="cb52-282"><a href="#cb52-282" tabindex="-1"></a>                   <span class="at">scaleexp =</span> <span class="fl">0.35653</span>, <span class="at">shapegom =</span> <span class="fl">1.6</span>, <span class="at">scalegom =</span> <span class="fl">0.0228</span>,</span>
<span id="cb52-283"><a href="#cb52-283" tabindex="-1"></a>                   <span class="at">scaleexpC =</span> <span class="fl">0.122</span>, <span class="at">admincens =</span> <span class="fu">c</span>(<span class="fl">4.506223</span>, <span class="fl">3.535000</span>),</span>
<span id="cb52-284"><a href="#cb52-284" tabindex="-1"></a>                   <span class="at">npop =</span> <span class="dv">10000</span>,  <span class="at">xmaxplot =</span> <span class="dv">6</span>)</span>
<span id="cb52-285"><a href="#cb52-285" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">dev.off</span>() }</span>
<span id="cb52-286"><a href="#cb52-286" tabindex="-1"></a><span class="fu">print</span>(sim2<span class="sc">$</span>results[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb52-287"><a href="#cb52-287" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(sim2<span class="sc">$</span>popc[<span class="dv">1</span>], <span class="dv">2</span>))          <span class="co"># true population-c * 100</span></span>
<span id="cb52-288"><a href="#cb52-288" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-6.1-gastric-cancer-study" class="section level2">
<h2>Section 6.1: Gastric cancer study</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="do">## prepare Table 2</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ignoring non-proportional hazards *&quot;</span>, <span class="st">&quot;HR Cox regression&quot;</span>,</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>            <span class="st">&quot;Estimating piecewise constant HRs *&quot;</span>, <span class="st">&quot;HR 1st year&quot;</span>, <span class="st">&quot;HR &gt;1st year&quot;</span>,</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>            <span class="st">&quot;Including a time-by-covariate interaction&quot;</span>, <span class="st">&quot;HR at 0.5 years&quot;</span>, <span class="st">&quot;HR at 1 year&quot;</span>,</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>            <span class="st">&quot;HR at 2 years&quot;</span>, <span class="st">&quot;Weighted Cox regression&quot;</span>, <span class="st">&quot;average HR&quot;</span>, <span class="st">&quot;c&#39;%&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>Table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(models), <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(models,</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">&quot;HR&quot;</span>, <span class="st">&quot;HRlower&quot;</span>, <span class="st">&quot;HRupper&quot;</span>, <span class="st">&quot;p&quot;</span>))))</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a><span class="do">## ignore non-proportional hazards and apply a Cox proportional hazards model</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>gfit2 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation, <span class="at">data =</span> gastric, <span class="at">template =</span> <span class="st">&quot;PH&quot;</span>,</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>                <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> gastric, <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation, data = gastric, 
##     x = TRUE, method = &quot;breslow&quot;, cluster = id)
## 
##             coef exp(coef) se(coef) robust se     z     p
## radiation 0.1415    1.1520   0.2263    0.2292 0.617 0.537
## 
## Likelihood ratio test=0.39  on 1 df, p=0.5325
## n= 90, number of events= 79</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="do">## extract estimates for Table 1: HR, 95% CI, p-value</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>Table2[<span class="st">&quot;HR Cox regression&quot;</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">exp</span>(gfit2<span class="sc">$</span>coeff),</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>                                   <span class="fu">exp</span>(<span class="fu">confint</span>(gfit2)),</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>                                   <span class="fu">summary</span>(gfit2)<span class="sc">$</span>prob)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastric, 
##     template = &quot;PH&quot;, robust = TRUE)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##               coef  se(coef) exp(coef) lower 0.95 upper 0.95         z
## radiation 0.141495 0.2292141  1.151995  0.7350944   1.805335 0.6173052
##                   p
## radiation 0.5370334
## 
## Wald Chi-square = 0.3810657 on 1  df  p = 0.5370334  n = 90
## 
## Covariance-Matrix:
##            radiation
## radiation 0.05253909
## 
## Generalized concordance probability:   Estimates may be biased!
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.5353     0.4237     0.6435</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="do">## estimating piecewise constant hazard ratios (by two separate Cox models)</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="do">## (two time periods with equal number of events)</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="fu">table</span>(gastric<span class="sc">$</span>status)</span></code></pre></div>
<pre><code>## 
##  0  1 
## 11 79</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="do">## 79/2</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">subset</span>(gastric, status <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> yrs <span class="sc">&lt;</span> <span class="dv">1</span>))          <span class="co"># breakpoint = 1 year</span></span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="do">## first time period</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>gastricp1 <span class="ot">&lt;-</span> gastric</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>gastricp1<span class="sc">$</span>status[gastricp1<span class="sc">$</span>yrs <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>gastricp1<span class="sc">$</span>yrs[gastricp1<span class="sc">$</span>yrs <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a><span class="fu">nrow</span>(gastricp1)</span></code></pre></div>
<pre><code>## [1] 90</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>gtable0 <span class="ot">&lt;-</span> <span class="fu">table</span>(gastricp1<span class="sc">$</span>status, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>gtable0</span></code></pre></div>
<pre><code>## gastricp1$status
##  0  1 
## 51 39</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(gtable0) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## gastricp1$status
##     0     1 
## 56.67 43.33</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>gtable1 <span class="ot">&lt;-</span> <span class="fu">table</span>(gastricp1<span class="sc">$</span>radiation, gastricp1<span class="sc">$</span>status, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="fu">addmargins</span>(gtable1)</span></code></pre></div>
<pre><code>##                    gastricp1$status
## gastricp1$radiation  0  1 Sum
##                 0   31 14  45
##                 1   20 25  45
##                 Sum 51 39  90</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(gtable1, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                    gastricp1$status
## gastricp1$radiation     0     1
##                   0 68.89 31.11
##                   1 44.44 55.56</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>gfit3 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> gastricp1,</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>               <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>gfit3.ph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(<span class="at">fit =</span> gfit3, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>gfit3.ph<span class="sc">$</span>table</span></code></pre></div>
<pre><code>##              chisq df          p
## radiation 2.836058  1 0.09217006
## GLOBAL    2.836058  1 0.09217006</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="do">## plot of scaled Schoenfeld residuals in the first time period</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="fu">plotcoxzph</span>(<span class="at">x =</span> gfit3.ph, <span class="at">wd =</span> <span class="dv">2</span>)</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;time (years, KM-transformation)&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(beta, <span class="st">&quot;(t) for radiation&quot;</span>)), <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(gfit3.ph<span class="sc">$</span>y <span class="sc">~</span> gfit3.ph<span class="sc">$</span>x)<span class="sc">$</span>coefficients, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="do">## plot of cumulative survival probabilities</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="do">## gsurv2 &lt;- survfit(Surv(yrs, status) ~ radiation, data = gastricp1)</span></span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a><span class="do">## par(oma = c(2, 2, 0.5, 0.5), mar = c(2, 2, 0, 0))</span></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="do">## plot(gsurv2, lty = 1:2, las = 1, lwd = 2)</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a><span class="do">## mtext(side = 1, line = 2.5, text = &quot;time (years)&quot;)</span></span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a><span class="do">## mtext(side = 2, line = 3, text = &quot;survival distribution function&quot;)</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a><span class="do">## legend(&quot;bottomleft&quot;, title = &quot;radiation&quot;, legend = c(&quot;yes&quot;, &quot;no&quot;),</span></span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a><span class="do">##        lty = 2:1, inset = 0.02, bty = &quot;n&quot;, cex = 1.2)</span></span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a><span class="do">## Cox proportional hazards model for the first time period</span></span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>gfit4 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation, <span class="at">data =</span> gastricp1, <span class="at">template =</span> <span class="st">&quot;PH&quot;</span>)</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a><span class="fu">summary</span>(gfit4)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastricp1, 
##     template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                coef se(coef) exp(coef) lower 0.95 upper 0.95        z
## radiation 0.8774141 0.325826  2.404673   1.269733    4.55407 2.692892
##                     p
## radiation 0.007083531
## 
## Wald Chi-square = 7.251665 on 1  df  p = 0.007083531  n = 90
## 
## Covariance-Matrix:
##           radiation
## radiation 0.1061626
## 
## Generalized concordance probability:   Estimates may be biased!
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.7063     0.5594       0.82</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>Table2[<span class="st">&quot;HR 1st year&quot;</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">exp</span>(gfit4<span class="sc">$</span>coeff),</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>                             <span class="fu">exp</span>(<span class="fu">confint</span>(gfit4)),</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>                             <span class="fu">summary</span>(gfit4, <span class="at">print =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>prob)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a><span class="do">## coxph(Surv(yrs, status) ~ radiation + cluster(id), data = gastricp1, method = &quot;breslow&quot;)</span></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a><span class="do">## second time period</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>gastricp2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(gastric, yrs <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a><span class="fu">nrow</span>(gastricp2)</span></code></pre></div>
<pre><code>## [1] 51</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>gtable0 <span class="ot">&lt;-</span> <span class="fu">table</span>(gastricp2<span class="sc">$</span>status, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>gtable0</span></code></pre></div>
<pre><code>## gastricp2$status
##  0  1 
## 11 40</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(gtable0) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## gastricp2$status
##     0     1 
## 21.57 78.43</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>gtable1 <span class="ot">&lt;-</span> <span class="fu">table</span>(gastricp2<span class="sc">$</span>radiation, gastricp2<span class="sc">$</span>status, <span class="at">deparse.level =</span> <span class="dv">2</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">addmargins</span>(gtable1)</span></code></pre></div>
<pre><code>##                    gastricp2$status
## gastricp2$radiation  0  1 Sum
##                 0    3 28  31
##                 1    8 12  20
##                 Sum 11 40  51</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(gtable1, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                    gastricp2$status
## gastricp2$radiation     0     1
##                   0  9.68 90.32
##                   1 40.00 60.00</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>gfit5 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> gastricp2, <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>gfit5.ph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(<span class="at">fit =</span> gfit5, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>gfit5.ph<span class="sc">$</span>table</span></code></pre></div>
<pre><code>##               chisq df         p
## radiation 0.5706304  1 0.4500085
## GLOBAL    0.5706304  1 0.4500085</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="do">## plot of scaled Schoenfeld residuals for the second time period</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a><span class="fu">plotcoxzph</span>(<span class="at">x =</span> gfit5.ph, <span class="at">wd =</span> <span class="dv">2</span>)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;time (years, KM-transformation)&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(beta, <span class="st">&quot;(t) for radiation&quot;</span>)), <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(gfit5.ph<span class="sc">$</span>y <span class="sc">~</span> gfit5.ph<span class="sc">$</span>x)<span class="sc">$</span>coefficients, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="do">## plot of cumulative survival probabilities</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a><span class="do">## gsurv3 &lt;- survfit(Surv(yrs, status) ~ radiation, data = gastricp2)</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="do">## par(oma = c(2, 2, 0.5, 0.5), mar = c(2, 2, 0, 0))</span></span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a><span class="do">## plot(gsurv3, lty = 1:2, las = 1, lwd = 2, xlim=c(1,5))</span></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a><span class="do">## mtext(side = 1, line = 2.5, text = &quot;time (years)&quot;)</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a><span class="do">## mtext(side = 2, line = 3, text = &quot;survival distribution function&quot;)</span></span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a><span class="do">## legend(&quot;bottomleft&quot;, title = &quot;radiation&quot;, legend = c(&quot;yes&quot;, &quot;no&quot;),</span></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a><span class="do">##        lty = 2:1, inset = 0.02, bty = &quot;n&quot;, cex = 1.2)</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a><span class="do">## Cox proportional hazards model for the second time period</span></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>gfit6 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation, <span class="at">data =</span> gastricp2, <span class="at">template =</span> <span class="st">&quot;PH&quot;</span>)</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a><span class="fu">summary</span>(gfit6)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastricp2, 
##     template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                 coef  se(coef) exp(coef) lower 0.95 upper 0.95         z
## radiation -0.6051688 0.3471071 0.5459823  0.2765161   1.078044 -1.743464
##                    p
## radiation 0.08125255
## 
## Wald Chi-square = 3.039668 on 1  df  p = 0.08125255  n = 51
## 
## Covariance-Matrix:
##           radiation
## radiation 0.1204833
## 
## Generalized concordance probability:   Estimates may be biased!
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.3532     0.2166     0.5188</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>Table2[<span class="st">&quot;HR &gt;1st year&quot;</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">exp</span>(gfit6<span class="sc">$</span>coeff),</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>                              <span class="fu">exp</span>(<span class="fu">confint</span>(gfit6)),</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>                              <span class="fu">summary</span>(gfit6, <span class="at">print =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>prob)</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a><span class="do">## coxph(Surv(yrs, status) ~ radiation + cluster(id), data = gastricp2, method = &quot;breslow&quot;)</span></span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a><span class="do">## including a time-by-covariate interaction</span></span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t) <span class="fu">as.numeric</span>(t <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a>gfit7 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">fun</span>(yrs)<span class="sc">:</span>radiation, <span class="at">data =</span> gastric, <span class="at">template =</span> <span class="st">&quot;PH&quot;</span>)</span>
<span id="cb91-12"><a href="#cb91-12" tabindex="-1"></a><span class="fu">summary</span>(gfit7)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation + fun(yrs):radiation, 
##     data = gastric, template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                          coef  se(coef) exp(coef) lower 0.95 upper 0.95
## radiation           0.8774141 0.3258260 2.4046734 1.26973327  4.5540699
## fun(yrs):radiation -1.4825829 0.4758515 0.2270505 0.08934636  0.5769896
##                            z           p
## radiation           2.692892 0.007083531
## fun(yrs):radiation -3.115642 0.001835452
## 
## Wald Chi-square = 10.30011 on 2  df  p = 0.005799087  n = 90
## 
## Covariance-Matrix:
##                     radiation fun(yrs):radiation
## radiation           0.1061626         -0.1060570
## fun(yrs):radiation -0.1060570          0.2264347
## 
## Generalized concordance probability:   Estimates may be biased!
##                    concordance prob. lower 0.95 upper 0.95
## radiation                     0.7063     0.5594     0.8200
## fun(yrs):radiation            0.1850     0.0820     0.3659</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="do">## 2.4046734 * 0.2270505</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="do">## exp(0.8774141 - 1.4825829)</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">tt</span>(radiation) <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> gastric,</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>              <span class="at">tt =</span> <span class="cf">function</span>(x, t, ...) x <span class="sc">*</span> (t <span class="sc">&gt;</span> <span class="dv">1</span>), <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>))</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + tt(radiation), 
##     data = gastric, tt = function(x, t, ...) x * (t &gt; 1), method = &quot;breslow&quot;, 
##     cluster = id)
## 
##   n= 90, number of events= 79 
## 
##                  coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)   
## radiation      0.8774    2.4047   0.3351    0.3258  2.693  0.00708 **
## tt(radiation) -1.4826    0.2271   0.4816    0.4759 -3.116  0.00184 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##               exp(coef) exp(-coef) lower .95 upper .95
## radiation        2.4047     0.4159   1.26973     4.554
## tt(radiation)    0.2271     4.4043   0.08935     0.577
## 
## Concordance= 0.6  (se = 0.029 )
## Likelihood ratio test= 10.49  on 2 df,   p=0.005
## Wald test            = 10.3  on 2 df,   p=0.006
## Score (logrank) test = 10.45  on 2 df,   p=0.005,   Robust = 10.73  p=0.005
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="do">## extended Cox model - assume a linear time-dependent effect</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> yrs<span class="sc">:</span>radiation, <span class="at">data =</span> gastric, <span class="at">template =</span> <span class="st">&quot;PH&quot;</span>)</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation + yrs:radiation, 
##     data = gastric, template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                     coef  se(coef) exp(coef) lower 0.95 upper 0.95         z
## radiation      1.2699606 0.4334889 3.5607124  1.5224762  8.3276657  2.929627
## yrs:radiation -0.9652886 0.3409321 0.3808733  0.1952444  0.7429892 -2.831322
##                         p
## radiation     0.003393692
## yrs:radiation 0.004635608
## 
## Wald Chi-square = 9.047941 on 2  df  p = 0.01084588  n = 90
## 
## Covariance-Matrix:
##                radiation yrs:radiation
## radiation      0.1879126    -0.1241715
## yrs:radiation -0.1241715     0.1162347
## 
## Generalized concordance probability:   Estimates may be biased!
##               concordance prob. lower 0.95 upper 0.95
## radiation                0.7807     0.6036     0.8928
## yrs:radiation            0.2758     0.1634     0.4263</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">tt</span>(radiation) <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) x <span class="sc">*</span> t,</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>     <span class="at">data =</span> gastric, <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + tt(radiation), 
##     data = gastric, tt = function(x, t, ...) x * t, method = &quot;breslow&quot;, 
##     cluster = id)
## 
##                  coef exp(coef) se(coef) robust se      z       p
## radiation      1.2700    3.5607   0.4186    0.4335  2.930 0.00339
## tt(radiation) -0.9653    0.3809   0.3177    0.3409 -2.831 0.00464
## 
## Likelihood ratio test=13.47  on 2 df, p=0.001188
## n= 90, number of events= 79</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="do">## extract HR at 0.5, 1 and 2 years</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>fit1est <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit1, <span class="at">type =</span> <span class="st">&quot;slice.time&quot;</span>, <span class="at">x =</span> <span class="st">&quot;yrs&quot;</span>, <span class="at">z =</span> <span class="st">&quot;radiation&quot;</span>, <span class="at">newx =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>                   <span class="at">exp =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">pval =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   yrs     HR HR lower 0.95 HR upper 0.95      p
## 1 0.5 2.1975        1.2096        3.9924 0.0098
## 2 1.0 1.3562        0.8536        2.1547 0.1971
## 3 2.0 0.5165        0.2381        1.1207 0.0946</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>Table2[<span class="fu">c</span>(<span class="st">&quot;HR at 0.5 years&quot;</span>, <span class="st">&quot;HR at 1 year&quot;</span>,</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>         <span class="st">&quot;HR at 2 years&quot;</span>), ] <span class="ot">&lt;-</span> <span class="fu">cbind</span>(fit1est<span class="sc">$</span>estimates[, <span class="st">&quot;HR&quot;</span>],</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>                                      fit1est<span class="sc">$</span>estimates[, <span class="st">&quot;HR lower 0.95&quot;</span>],</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>                                      fit1est<span class="sc">$</span>estimates[, <span class="st">&quot;HR upper 0.95&quot;</span>],</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>                                      fit1est<span class="sc">$</span>estimates[, <span class="st">&quot;p&quot;</span>])</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a><span class="do">## visualize the estimated linear time-dependent effect</span></span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a>fit1est2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit1, <span class="at">type =</span> <span class="st">&quot;slice.time&quot;</span>, <span class="at">x =</span> <span class="st">&quot;yrs&quot;</span>, <span class="at">z =</span> <span class="st">&quot;radiation&quot;</span>,</span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a>                    <span class="at">newx =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb101-10"><a href="#cb101-10" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">pdf</span>(<span class="st">&quot;figure3.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb101-12"><a href="#cb101-12" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb101-13"><a href="#cb101-13" tabindex="-1"></a>  <span class="fu">plot</span>(fit1est2, <span class="at">addci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-14"><a href="#cb101-14" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;time (yrs)&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)</span>
<span id="cb101-15"><a href="#cb101-15" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.3</span>, <span class="at">text =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">hat</span>(beta), <span class="st">&quot;(t) for radiation&quot;</span>)),</span>
<span id="cb101-16"><a href="#cb101-16" tabindex="-1"></a>        <span class="at">cex =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">dev.off</span>() }</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a><span class="do">## extended Cox model - assume a log-linear time-dependent effect</span></span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>gfit8 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">log</span>(yrs)<span class="sc">:</span>radiation, <span class="at">data =</span> gastric,</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>                <span class="at">template =</span> <span class="st">&quot;PH&quot;</span>)</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a><span class="fu">summary</span>(gfit8)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation + log(yrs):radiation, 
##     data = gastric, template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                           coef  se(coef) exp(coef) lower 0.95 upper 0.95
## radiation           0.03766302 0.2367992 1.0383813  0.6528193   1.651660
## log(yrs):radiation -0.66924556 0.4821178 0.5120948  0.1990540   1.317437
##                             z         p
## radiation           0.1590504 0.8736291
## log(yrs):radiation -1.3881370 0.1650953
## 
## Wald Chi-square = 1.97312 on 2  df  p = 0.372857  n = 90
## 
## Covariance-Matrix:
##                      radiation log(yrs):radiation
## radiation          0.056073853        0.004581723
## log(yrs):radiation 0.004581723        0.232437577
## 
## Generalized concordance probability:   Estimates may be biased!
##                    concordance prob. lower 0.95 upper 0.95
## radiation                     0.5094      0.395     0.6229
## log(yrs):radiation            0.3387      0.166     0.5685</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation <span class="sc">+</span> <span class="fu">tt</span>(radiation) <span class="sc">+</span> <span class="fu">cluster</span>(id),</span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>     <span class="at">tt =</span> <span class="cf">function</span>(x, t, ...) x <span class="sc">*</span> <span class="fu">log</span>(t), <span class="at">data =</span> gastric, <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(yrs, status) ~ radiation + tt(radiation), 
##     data = gastric, tt = function(x, t, ...) x * log(t), method = &quot;breslow&quot;, 
##     cluster = id)
## 
##                   coef exp(coef) se(coef) robust se      z     p
## radiation      0.03766   1.03838  0.23962   0.23680  0.159 0.874
## tt(radiation) -0.66925   0.51209  0.27299   0.48212 -1.388 0.165
## 
## Likelihood ratio test=8.02  on 2 df, p=0.01809
## n= 90, number of events= 79</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="do">## weighted Cox regression </span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation, <span class="at">data =</span> gastric, <span class="at">template =</span> <span class="st">&quot;AHR&quot;</span>)</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastric, 
##     template = &quot;AHR&quot;)
## 
## Model fitted by weighted estimation (AHR template) 
## 
##                coef  se(coef) exp(coef) lower 0.95 upper 0.95        z
## radiation 0.4625051 0.2387432  1.588047  0.9945916   2.535608 1.937249
##                    p
## radiation 0.05271492
## 
## Wald Chi-square = 3.752934 on 1  df  p = 0.05271492  n = 90
## 
## Covariance-Matrix:
##            radiation
## radiation 0.05699834
## 
## Generalized concordance probability:
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.6136     0.4986     0.7172</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="do">## weighted Cox regression with truncation of weights</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>gfit9 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(yrs, status) <span class="sc">~</span> radiation, <span class="at">data =</span> gastric, <span class="at">template =</span> <span class="st">&quot;AHR&quot;</span>,</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>                  <span class="at">trunc.weights =</span> <span class="fl">0.95</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a><span class="fu">summary</span>(gfit9)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(yrs, status) ~ radiation, data = gastric, 
##     template = &quot;AHR&quot;, trunc.weights = 0.95)
## 
## Model fitted by weighted estimation (AHR template) 
## 
##                coef  se(coef) exp(coef) lower 0.95 upper 0.95        z
## radiation 0.4622282 0.2384041  1.587608  0.9949774   2.533221 1.938843
##                    p
## radiation 0.05252042
## 
## Wald Chi-square = 3.759113 on 1  df  p = 0.05252042  n = 90
## 
## Covariance-Matrix:
##            radiation
## radiation 0.05683651
## 
## Generalized concordance probability:
##           concordance prob. lower 0.95 upper 0.95
## radiation            0.6135     0.4987      0.717</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure4.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> gfit9, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;time (years)&quot;</span>)</span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;weight&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAeFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kLY6kNtmAABmADpmZgBmZmZmkJBmtrZmtv+QOgCQZgCQkGaQtpCQ27aQ2/+2ZgC2kDq2tma225C2/7a2///bkDrb/7bb////tmb/25D//7b//9v////KcmwgAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAUJklEQVR4nO2di3aruBVASZrkzrR2OjPOTBu30zDBDv//h0UIMDhYBvTgSOy91vU7kg376oWOlJUAgsnW/gIAJhAURIOgIBoEBdEgKIgGQUE0CAqiQVAQjVNBMwA3eBLUZWKwYRAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIILshjIICiJAUBANgkKUICiIBkFBNDaCnvcqsP7ZnCyADTaCnn68308WwAYbQYvHj/vJAkzgVifeStB8tHZfmBhsGi+CHn+umqC7YTbflnwCuM9tYSwEPe+fPitLd2PvISi4wXqYabwhiqDgBmtBTy8HY7IANtgLOjrWhKDgBgtBddlJFQ8+serFq2EmOklgjWHUx6qKP2ZZNtYCRVCYhS9BDTm6TAxSB0EhVhAURIOgIBoEBdGkKeh5fxh5UoyPOIBk0hR0QCvowFoQhGnyG4LC6iQt6Nfbc1V5q+sFx6fPMtczVLWLxyx7+OPh/bz/9SXLDqfq5ulT3d64uAArYZw9HL2gZV57+VyZuivzh/fy9LLTgh4fPypzlaDVq7m6P+j5AwWGxkP8ghaVfsdfqrLxR6WgmhhQPH50LpbHB/1q9Uy9aAijApHEL2jl3fn1Xz99VO4pV69cLHTJWX+quj/vMTQu4he0PO5Of//r9f34XNXdmtrFfEzQqiFAGzQqEhA0f/rPc3n8x9uh1CVoqTtJoyVozfHhZjw/SCMBQU8//bPqHv3tx/tlIOnSBs1HBGW8SRTmEOAEBK176UWmQkxVL173iwa9+FbQnS5jC0pQSSQvaG2iGlyqUOOg1bNuHPTxv7pLX79yrCRWzVT8FEX6gppgXCly0hW0boPqkVGIl3QF1YNOdIciJ2FBIQUQFESDoLAud1ZCRFBYFwQFydxbShZBQTQICqJBUBANgoJoEBREk4CgY9M7mfIZCXf3g0lA0DEQNBIQFESTjKDNggvd7PjXP5qpSsXDv/eHZrl8FYCsX0bQVIhE0HbBhUv4xtNnvaZIeXz6a39oH36qZfNV3AeCpsKKgrZbJt6679NOjO/HF9WBxdWDNsZYPXx91zIjaCpEUoK2Cy4MIjTr4GIdFNc8VB8puqYAJEAkgrYLLgxDiKsKvarWdQjnc7t42OOflKAJEYugiuN1jHvx+L+m9Gwe1k1Vqvh4uL8tdkyCtm3PZvEl9cIvbYyxflg3VQuq+GhIRtB2wYWvN9V7z9pVQo7Z82Ux0Oe28Mx2CBoH9/2MRdCyXXCh0i/7rVvGpriMeepFP3P1qbYpAAkQi6CwURAURIOgIBoEBdEgKKzGhE48gsJ6ICiIZruCMgyaDGkKCsmAoCCaaARVq88/N/f1bpy/7evgjm7zzaJ54/WPrJnk1Hyi3bPT+VeCAMQiqI7j6O/GqTfg7Dbf1HOYnksVDFLqOcz6E91uH66/EoRg1ZAP878+7Vrzvd049by7NhZEbSXbbNvV7HbcfqLbs9Pl7wMHTOnEx1KCasvaLY7aCaH1BFFtqP5A741u8n2345zjrwS2JCXoD+3XYDfO2sEmFkQL2o9Wah/kCCqUpAQdlKDlJXqufnJs2qKUoOkRiaCXNmh/v8322VlFxndt0CtBuz07HX8lCIKtoCqU0pisI5RganmGwW6cqnxsN9+89OKvBKUXHzWWguo9XE3JuqI/DnqJlDt0sSDdOOg3Qds9O51/JQiAnaDnfTBBLWHPzkixEzR/+l28oOzZKZNJfXhLQU8/3kO1QS1gz06RBBBU9ZyHgmYdsxODjRFA0LySM4ISFGLGQtD66g6CglcsBM3by47GZAFsiGWgHjZKEoK2V+pNsUjdxfivt1k9+m6txxuJ1os6gzfSEtRAJ2j+PCttY/xdfY11/AiAmakDPZFMFjEzR9C5AZ93BZ1ZIoMmBkEzE9cfbq/FN5fcTy8q4minIpLUZNBfX7oL8ZdYpCZ8SS/K2AYlFfWF/PYj/UCmP/tJlr0NbepdGuovtRtLNKcIXUAEghr9vE6gjUlqJy2dXlTEkZo2kj9+1E90pFIvFqkNXxpOZzrWS942bw8CmQZJlr0NbdpCVL08kihTTX0SSRXfXkvvpn3WkjQ3h/pe+dOPRerClwZBSU3Ikv7IMJBpkGR/Q5tGUP3se6JTGhiwlEgEbSXoJs532yVc4uJ6O9J0M0UvcXVFK+jhcjOchj9IUn223dBGC6pWHy/HEmUiik9iEbSJSepCj4aC1u9WtwNB2+sIg6CkZm5TX9BWwaGgvQ1ttKD1VOmxRBHUJ7EIurQELdupoDNL0P6GNs27u7LX3qQEDUQkgo60QQc21W1QvafXcCulspU6H7RBDyOBTIMk+xva6ODRuq8+liht0PlMn+4WiaBdTNKlFz8QtOuR90I92vClpr8+6MV38SK9QKZvJWi7oU2XWPM9rhKlFz+f9AT9Pg46sOnXl24X7ksl3oQvjY2Dth/pBzJ9a4O2G9rUZW07MeZ7ooyDzidBQV3hfOlQ1iL1yuYEnXst/i5ci/fK9gR1fO2c2Ux+2Z6gEBUICqJBUAjPjKhfBIXwICiIBkEhFRAURIOgIBoEBdEgKIgGQSE0s9Y+RFAIDYKCaBAU0gFBQTQICqJBUBANgoJoEBQCM28LGASFwCAoiAZBISEQFESDoCAaBAXRICiIBkEhLDN3wkZQCAuCgmRm+omgIBsEBdEgKIgGQUE0CAqiQVAIydxOPIJCUBAURIOgkBYICqJBUBANgoJoEBREg6AQkNmdeASFkCAoSGa+nwgKskFQEI2VoHmWPYzvlo6g4AYbQfPHj7IYNxRBwQ0Wgp73u7L8ens2Jwtgg20bFEFhMgs68daC5lTxMJXwghZZtht+g5YFiUHquBX0/KrLxqLqCt3m6+3p05gsgA33Bc2Ngt7oxiMouOGWoMdLbb27/psBp5eDMVkAG+6XoDfRao63ABAU3GDTSTpWzc+vt9ECFkHBDQZBv950FX+7DaraAWMVPILCCIvGdgyCHs29o4nJAjQ4FrS+krn4uyz/U0iUZYPjJkHHa++ZyQLYcFvQG1fZ5yYLYIOhDTo+wjk3WQAbbgh63l8G6pf0lRAU3EDIB4gGQSEMC2e4mXrxXSU/vy2KoHCFc0HLop4mUmSHBSOiCApXOBe0HWbKnz7z0Tmf05IFsOH+QH3x+GGes2xOFsAGUwmqK3ZVgiIorMSUNuiCa0oICm4wDTPV/fiq8FwwrQlBwQ2Mg0IQlgb6IigEAUFBMotXSrg5WWTXXUlisgisByUoiAZBQTR3hpmePo+LIpMQFNxgGqh/eM+fPpfFziEouMF8qVPNEpl/nXMkMdg2y5c7NE8WUYLOnykykhhsGx+CtiXocfZcu5HEYNv4ELRpg+YL5tMjKLji7mSRG/vMTE4WwAbGQUE0CAqiMUZ1Ll/7BkHBDYYStJktsqgRiqDQw2LXl7tV/HnPOChY4k1QVYhSgoIlNttmGVe3WzYXdDQxgEWYOkksAQ6rY6riqyJ0aT8eQcENdzpJ+ZKVw24lBjAbevEgGoOgR4LmwAVWe18bryQtmygylhhsGE+CWoGg0IGgkC4ICqJBUBANgoJoEBREg6DgGatOPIKCbxAUJGPnJ4KCbBAURIOgIBoEBdEgKIgGQcErlp14BAW/ICiIBkEhaRAURGMj6NdblmXje4AgKLjBQtCvt4f3Mh9f2wFBwQ0Wgp5e1JoO47vUICi4wboNWozGJiMo1Nh24u0FPfZL0KzD8mtBIqwuaDHeS0JQUNiXVJaCFjfWv0NQcIOdoDfKTwQFV1gJmt/yE0HBETaCGnZJRFBwg9U46O2d5BEU3GAhaJ7d3kcJQaF00Ylnsgh4BEFBNAgKqYOgIBoEBdEgKIgGQUE0CArecDHrEkHBGwgKknEybR1BQTQICqJBUBANgoJoEBR84CywF0HBB5EKmg1xmSOkSVBBsxFc5grpsWYVj6Fwl7XboBgKRtYWtKQQTQzHp3N1QSlD08L16Vxf0JL+Ukq4Po0CBMVQuI0EQdu/QVH4hiBBaY3CdyQJiqFR4+fkiRKUWj5iPJ06WYJycSlePJ02YYI2ijr8JhA34gQtcRR6SBS0ZFgUWkQKWg5m5rn4PuARr6dIqqAlF5hiwe8ZEixomxSKysbv6ZEvKH2mTROBoFxh2jJRCOq5FgHBxCEohookxFmJRlAUFUeQcxKJoBgqkCBnJBZBqeU3SjyCYugmiUpQqvntEZGgzCERQ8CTEJOgJY7KIOQZiEzQEkcFEPLoxydoyZiTM9rDOPc+IFEKiqKWNAcvW3gfkkgFJbrOhpiOXKyCMuq0gBgPWLyCljg6mRWraFuiFrQXuRQmv0iJ+fjELWg5iK6L+DT4IYUjEr2gTX4Y2ifiKv2aRARtco3/fDghBTFbkhJ064amJGZLaoKmeI7uk1CVfk1agpbb7DGl/GMtBT399HEn2eBsSNEN/ERLQc/7R3GCdl8hYUVTrNJv/BYrQYsskytowjNKUvxdt36TjaBFtiskC5pcrz5FMRtu/jTLNuhMQZfOP1x+r394+Hy93Kcr6O1f5lbQO/2T6/5LgPvQ+Xm9TxbDDwxagq7Svd5Ghz5qTOcnbBW/FhgqGePZWVPQgEUbgsrFLMHqggaSFEOlcuf8r13FhxMURUVy77ysLWgwMFQkd8+KpaD3k53xN54VwlB53D8nwgT1bSiKimLCCREkqP8hy2yIv4xgElPOgShBg1TzKCqFSSdAmKCu0zCmj6OrMu3gyxU0QDGHoSsy8dDLFbQMUg/j6EpMPeyCBQ0DzdFVmHzEoxHUo0IYGpzpxzsWQYN0731mAD1mHOtYBPV+IYiqPhxzDnM8goa50oSk/pl1hCMSdFDN+5IIQb0z7wDHJGg/fb+jo/4Sh5mHN1pBPRZ1GOqRuQc3UkH9Dg1RzXtj9pGNVdCr7ByXqLREPTH/sCYhqIfuN915Hyw4pEkI6gXGnJyz5GgiqAEMdcqiY5mioE5rfAx1xbIjiaATUnOSztZZeBxTFNQxGOqCpUdxC4LaGoah9iw+hhsQ1L62z65x9M22w/JjtgFBS3tHvxmKsLOwOETbENTxxUsEnYfNEdqIoF6hYDVjdSS2J6gHe6j+TVi2rkYeOUDuaQkoDpYqLH/95gS9wrs7W1fU9qcjaAiBtmuo9Q/fuqChSriNKmr/qzcv6BXeZN2koQ5+M4IO8Viabq+P7+L3Ieg3vHljHI0KL6zPvNz9HAT9TkBPfAsb/j+E69QR1EjoSniBRHcdvI+H7+4myRJBzfgpZOZ+AY/uufHVj5pN2iOPnCYbOysbWgaYSmWRvk81mxxGHjlNNnr6h97rqZDCNFH9q9nkM/LIabLxczkB307IFoT1XHzfzX7kkdNkUybcaRJAcDWbbEceOU12Q2zK11AgqDuuBUVYByCoPxDUAQgaDHxdAoIG4+4YwNjz0F9SHAi6GvearJS4CgQVzawSN0kQNBpml7hJCI2gyTBX4LtCiwBBN0scwiIo3EBGkwFBYSLWbd5FQiMoOMJPmxdBYSW+CTv+qZFHLjJ3mRhsGAQF0SAoiMZK0CLLHt7vJAtgg42gRWVnMW4ogoIbLAT9ettVt8dnc7IANlgIeno5VLf544cxWQAbbAT9oWr3oi9oNm1sC2AqFoLq5ud4IxRBwQ0ICqJxW8UvTwxgFDpJIBqGmUA0DNSDaKwudea3L3UCuMFG0LmsUq6SaSKZIiiZis4UQclUdKYISqaiM0VQMhWdKYKSqehMEZRMRWeKoGQqOlMEJVPRmXJ1EkSDoCAaBAXRICiIBkFBNAgKokFQEA2CgmgQFESDoCAaBAXRICiIBkFBNL4Fvb0cs1dOP42tfOKTr7csy3aBMzWEgPvl+PQZKCfPghpWefDJeT+6NI9Hvt6qX5lnowuu+EOtQLTC4a2KnUQENa2T45Gq2A4tqGnJKm+c9zt1jEMf3irfVARd5bRVfu7GV9/zn/MKpdkKguZPv6ciqGGtRq+sJOhxhWzz4P8pqrOaShvUtNqt34xXEbQI30sqwvfMVLsNQW0zXkPQInQfqebrLZgsmrzKLxVBN1XFr1B+6nzD/v+vz2kygq7SSSpXETRfyc/mIAcjbxZIDJRpksNMawiahzpjPbSaa9QWqZSgaw3Uhz9pp5c1yk/liS4EVsg4DL4vda50LS64oE3FF/q3HsPVtcN8kxEUwAoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEdUVxKM978+z2r7eJs9/Pr2usCCYSBHXEPTkV+eTowSJwrLtcENQREwSd4nDD5LI2eRDUDaeXLHv6qzLw9PLbPst26nm9JkBv1VAVyVeHYKuStHujiXs7v/6RPX6oP9N/RxGqQVBHqOLxXAtaLxRauajWq1Are3URyUpOJakqHrs31IvqyXlfKVkHuhfK0DVitUWCoI64CLor25tDvYBnGwNdP6k/8uO9e6PuDikv61cu0dKBlwuRC4I64iLooexudDnYyKaboFWJWVXfgzcKVavX715WhtYGA4K6YlzQ/jpG3UI1x115eaNqiz7++dIOUdUr3R9KBO1AUEcYStDeJ1Rn6N+vveWAuo9fuvhH9R6CNiCoI0YFHQwsaee+3n6uekPdG3Wrs8j6gtaPaIM2IKgjlH7fBNXrcx+b4lKv8qeXaWzf0IVnpv9WF6yXG0BQdxzbcdC+oPVwZ9vx0X10vahv90a9ulplqi5Bi3YBMsZBGxA0HNrB098nqDfjolPiIGhA6mvx+ZTeD9fiWxA0IF9vh9PLFPWYzdSBoCAaBAXRICiIBkFBNAgKokFQEA2CgmgQFESDoCAaBAXR/B+VeDO6OzxcCgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">dev.off</span>() }</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a><span class="do">## range of normalized totatl weights</span></span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a><span class="fu">range</span>(gfit9<span class="sc">$</span>w.matrix[, <span class="st">&quot;w&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 0.3134808 1.6534706</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>Table2[<span class="st">&quot;average HR&quot;</span>, ] <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">exp</span>(gfit9<span class="sc">$</span>coeff),</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>                                <span class="fu">exp</span>(<span class="fu">confint</span>(gfit9)),</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>                                <span class="fu">summary</span>(gfit9, <span class="at">print =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>prob)</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>Table2[<span class="st">&quot;c&#39;%&quot;</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(<span class="fu">concord</span>(gfit9)), <span class="fu">summary</span>(gfit9, <span class="at">print =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>prob)</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a><span class="do">## finish Table 1</span></span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>Table2[<span class="st">&quot;c&#39;%&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> Table2[<span class="st">&quot;c&#39;%&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>Table2 <span class="ot">&lt;-</span> <span class="fu">round</span>(Table2, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a></span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>Table2[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(Table2[, <span class="dv">1</span>], <span class="st">&quot; (&quot;</span>, Table2[, <span class="dv">2</span>], <span class="st">&quot;-&quot;</span>, Table2[, <span class="dv">3</span>], <span class="st">&quot;)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>Table2[, <span class="dv">2</span>] <span class="ot">&lt;-</span> Table2[, <span class="dv">4</span>]</span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a>Table2 <span class="ot">&lt;-</span> Table2[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a><span class="fu">dimnames</span>(Table2)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Estimate (95% CI)&quot;</span>, <span class="st">&quot;p&quot;</span>)</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>Table2</span></code></pre></div>
<pre><code>##                                             Estimate (95% CI)     p
## Ignoring non-proportional hazards *                NA (NA-NA)    NA
## HR Cox regression                         1.152 (0.735-1.805) 0.537
## Estimating piecewise constant HRs *                NA (NA-NA)    NA
## HR 1st year                                2.405 (1.27-4.554) 0.007
## HR &gt;1st year                              0.546 (0.277-1.078) 0.081
## Including a time-by-covariate interaction          NA (NA-NA)    NA
## HR at 0.5 years                            2.197 (1.21-3.992) 0.010
## HR at 1 year                              1.356 (0.854-2.155) 0.197
## HR at 2 years                             0.517 (0.238-1.121) 0.095
## Weighted Cox regression                            NA (NA-NA)    NA
## average HR                                1.588 (0.995-2.533) 0.053
## c&#39;%                                        61.35 (49.87-71.7) 0.053</code></pre>
</div>
<div id="section-6.2-biofeedback-therapy-study" class="section level2">
<h2>Section 6.2: Biofeedback therapy study</h2>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="do">## ignore non-proportional hazards and apply a Cox model</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a><span class="do">## (use breslow weights to make it directly comparable to coxphw)</span></span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>bfit2 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> bfb <span class="sc">+</span> log2heal, <span class="at">data =</span> biofeedback, <span class="at">template =</span> <span class="st">&quot;PH&quot;</span>)</span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a><span class="fu">summary</span>(bfit2)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(thdur, success) ~ bfb + log2heal, data = biofeedback, 
##     template = &quot;PH&quot;)
## 
## Model fitted by unweighted estimation (PH template) 
## 
##                coef  se(coef) exp(coef) lower 0.95 upper 0.95          z
## bfb       0.2699762 0.3453073 1.3099332  0.6657683   2.577361  0.7818433
## log2heal -0.5266649 0.3636448 0.5905713  0.2895592   1.204502 -1.4482949
##                  p
## bfb      0.4343067
## log2heal 0.1475346
## 
## Wald Chi-square = 2.657646 on 2  df  p = 0.2647887  n = 33
## 
## Covariance-Matrix:
##                   bfb     log2heal
## bfb       0.119237110 -0.002917929
## log2heal -0.002917929  0.132237551
## 
## Generalized concordance probability:   Estimates may be biased!
##          concordance prob. lower 0.95 upper 0.95
## bfb                 0.5671     0.3997     0.7205
## log2heal            0.3713     0.2245     0.5464</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="do">## or equivalently</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> bfb <span class="sc">+</span> log2heal <span class="sc">+</span> <span class="fu">cluster</span>(id), <span class="at">data =</span> biofeedback,</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ bfb + log2heal, data = biofeedback, 
##     x = TRUE, method = &quot;breslow&quot;, cluster = id)
## 
##             coef exp(coef) se(coef) robust se      z     p
## bfb       0.2700    1.3099   0.4273    0.3453  0.782 0.434
## log2heal -0.5267    0.5906   0.2543    0.3636 -1.448 0.148
## 
## Likelihood ratio test=7.19  on 2 df, p=0.02753
## n= 33, number of events= 23</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="do">## two stage estimation</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>stage1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> <span class="fu">strata</span>(bfb) <span class="sc">+</span> log2heal <span class="sc">+</span> <span class="fu">tt</span>(log2heal) <span class="sc">+</span> <span class="fu">cluster</span>(id),</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>                <span class="at">tt =</span> <span class="cf">function</span>(x, t, ...) x <span class="sc">*</span> <span class="fu">log</span>(t), <span class="at">data =</span> biofeedback, <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a><span class="fu">summary</span>(stage1)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ strata(bfb) + log2heal + 
##     tt(log2heal), data = biofeedback, tt = function(x, t, ...) x * 
##     log(t), method = &quot;breslow&quot;, cluster = id)
## 
##   n= 33, number of events= 23 
## 
##                 coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)   
## log2heal      0.7368    2.0892   0.9008    0.3797  1.940  0.05233 . 
## tt(log2heal) -0.4153    0.6602   0.3257    0.1490 -2.786  0.00533 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##              exp(coef) exp(-coef) lower .95 upper .95
## log2heal        2.0892     0.4787    0.9926    4.3971
## tt(log2heal)    0.6602     1.5148    0.4929    0.8841
## 
## Concordance= 0.664  (se = 0.063 )
## Likelihood ratio test= 8.53  on 2 df,   p=0.01
## Wald test            = 7.84  on 2 df,   p=0.02
## Score (logrank) test = 6.59  on 2 df,   p=0.04,   Robust = 7.71  p=0.02
## 
##   (Note: the likelihood ratio and score tests assume independence of
##      observations within a cluster, the Wald and robust score tests do not).</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="do">## for comparison linear time-dependent effect</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> <span class="fu">strata</span>(bfb) <span class="sc">+</span> log2heal <span class="sc">+</span> <span class="fu">tt</span>(log2heal) <span class="sc">+</span> <span class="fu">cluster</span>(id),</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>      <span class="at">tt =</span> <span class="cf">function</span>(x, t, ...) x <span class="sc">*</span> t, <span class="at">data =</span> biofeedback, <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(thdur, success) ~ strata(bfb) + log2heal + 
##     tt(log2heal), data = biofeedback, tt = function(x, t, ...) x * 
##     t, method = &quot;breslow&quot;, cluster = id)
## 
##                  coef exp(coef) se(coef) robust se      z     p
## log2heal     -0.02130   0.97892  0.45270   0.43296 -0.049 0.961
## tt(log2heal) -0.01957   0.98062  0.02218   0.01549 -1.263 0.206
## 
## Likelihood ratio test=8.64  on 2 df, p=0.01331
## n= 33, number of events= 23</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>stage2 <span class="ot">&lt;-</span> <span class="fu">coxphw</span>(<span class="fu">Surv</span>(thdur, success) <span class="sc">~</span> bfb <span class="sc">+</span> log2heal <span class="sc">+</span> <span class="fu">log</span>(thdur)<span class="sc">:</span>log2heal, <span class="at">data =</span> biofeedback,</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>                <span class="at">template =</span> <span class="st">&quot;AHR&quot;</span>, <span class="at">betafix =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">coef</span>(stage1)))</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="fu">summary</span>(stage2)</span></code></pre></div>
<pre><code>## coxphw(formula = Surv(thdur, success) ~ bfb + log2heal + log(thdur):log2heal, 
##     data = biofeedback, template = &quot;AHR&quot;, betafix = c(NA, coef(stage1)))
## 
## Model fitted by weighted estimation (AHR template) 
## 
##                           coef  se(coef) exp(coef) lower 0.95 upper 0.95
## bfb                  0.5967993 0.3732872 1.8162961  0.8738643   3.775107
## log2heal             0.7367590        NA 2.0891536         NA         NA
## log(thdur):log2heal -0.4152653        NA 0.6601651         NA         NA
##                            z         p
## bfb                 1.598767 0.1098724
## log2heal                  NA        NA
## log(thdur):log2heal       NA        NA
## 
## Wald Chi-square = 2.556056 on 1  df  p = 0.1098724  n = 33  (based on: bfb )
## 
## Covariance-Matrix:
## [1] 0.1393434
## 
## Generalized concordance probability:
##                     concordance prob. lower 0.95 upper 0.95
## bfb                            0.6449     0.4663     0.7906
## log2heal                       0.6763         NA         NA
## log(thdur):log2heal            0.3977         NA         NA</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;figure5.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">5</span>) }</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> stage2, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">legendxy =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="fl">1.15</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;treatment duration (days)&quot;</span>)</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;weight&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="cf">if</span> (pdfind) { <span class="fu">dev.off</span>() }</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
